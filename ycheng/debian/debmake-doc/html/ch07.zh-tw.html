<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>章 7. 提示</title>
    <link rel="stylesheet" type="text/css" href="debian.css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="home" href="index.zh-tw.html" title="Debian 維護者指南"/>
    <link rel="up" href="index.zh-tw.html" title="Debian 維護者指南"/>
    <link rel="prev" href="ch06.zh-tw.html" title="章 6. debmake 選項"/>
    <link rel="next" href="ch08.zh-tw.html" title="章 8. 更多範例"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">章 7. 提示</th>
        </tr>
        <tr>
          <td align="left"><a accesskey="p" href="ch06.zh-tw.html"><img src="images/prev.png" alt="前一頁"/></a> </td>
          <th width="60%" align="center"> </th>
          <td align="right"> <a accesskey="n" href="ch08.zh-tw.html"><img src="images/next.png" alt="下一頁"/></a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="chapter">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="tips"/>章 7. 提示</h1>
          </div>
        </div>
      </div>
      <div class="toc">
        <p>
          <strong>內容目錄</strong>
        </p>
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#debdiff">7.1. debdiff</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#dget">7.2. dget</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#debc">7.3. debc</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#piuparts">7.4. piuparts</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#debsign">7.5. debsign</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#dput">7.6. dput</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#bts">7.7. bts</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#gbp">7.8. git-buildpackage</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch07.zh-tw.html#debsnap">7.8.1. gbp import-dscs --debsnap</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#upstream-git">7.9. 上游 git 倉庫</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#chroot">7.10. chroot</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#newrevision">7.11. 新的 Debian 版本</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#newversion">7.12. 新上游版本</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch07.zh-tw.html#uupdate">7.12.1. uupdate + tarball</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch07.zh-tw.html#uscan">7.12.2. uscan</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch07.zh-tw.html#gbp-orig">7.12.3. gbp</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch07.zh-tw.html#gbp-uscan">7.12.4. gbp + uscan</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#deb3">7.13. 3.0 原始碼格式</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#cdbs">7.14. CDBS</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#utf-8-build">7.15. 在 UTF-8 環境下構建</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#utf-8-conv">7.16. UTF-8 轉換</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#origtar">7.17. 上傳 <span class="strong"><strong>orig.tar.gz</strong></span></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#skipedupload">7.18. 跳過的上傳</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#adv-pkg">7.19. 高階打包</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#other-distro">7.20. 其他發行版</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch07.zh-tw.html#debug">7.21. 除錯</a>
            </span>
          </dt>
        </dl>
      </div>
      <p>這裡有一些關於 Debian 打包的值得注意的提示。</p>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debdiff"/>7.1. debdiff</h2>
            </div>
          </div>
        </div>
        <p>您可以使用 <span class="strong"><strong>debdiff</strong></span> 命令來對比兩個 Debian 套件組成的差別。</p>
        <pre class="screen">$ debdiff old-package.dsc new-package.dsc</pre>
        <p>您也可以使用 <span class="strong"><strong>debdiff</strong></span> 命令來對比兩組二進制 Debian 套件中的檔案列表。</p>
        <pre class="screen">$ debdiff old-package.changes new-package.changes</pre>
        <p>當檢查原始碼包中哪些檔案被修改時，這個命令非常有用。它還可以用來檢測二進位制包中是否有檔案在更新過程中發生變動，比如被意外替換或刪除。</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="dget"/>7.2. dget</h2>
            </div>
          </div>
        </div>
        <p>您可以使用 <span class="strong"><strong>dget</strong></span> 命令來下載 Debian 套件原始碼的檔案集。</p>
        <pre class="screen">$ dget https://www.example.org/path/to/package_version-rev.dsc</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debc"/>7.3. debc</h2>
            </div>
          </div>
        </div>
        <p>您應該使用 <span class="strong"><strong>debc</strong></span> 命令安裝生成的套件以在本地測試它。</p>
        <pre class="screen">$ debc package_version-rev_arch.changes</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="piuparts"/>7.4. piuparts</h2>
            </div>
          </div>
        </div>
        <p>您應該使用 <span class="strong"><strong>piuparts</strong></span> 命令安裝生成的套件以自動進行測試。</p>
        <pre class="screen">$ sudo piuparts package_version-rev_arch.changes</pre>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[注意]" src="images/note.png"/>
              </td>
              <th align="left">注意</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>這是一個非常慢的過程，因為它需要查詢遠端 APT 套件倉庫。</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debsign"/>7.5. debsign</h2>
            </div>
          </div>
        </div>
        <p>完成套件的測試後，您可以使用 <span class="strong"><strong>debsign</strong></span> 命令對其進行簽名。</p>
        <pre class="screen">$ debsign package_version-rev_arch.changes</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="dput"/>7.6. dput</h2>
            </div>
          </div>
        </div>
        <p>使用 <span class="strong"><strong>debsign</strong></span> 命令對包進行簽名後，您可以使用 <span class="strong"><strong>dput</strong></span> 命令上傳 Debian 源和二進位制包的檔案集。</p>
        <pre class="screen">$ dput package_version-rev_arch.changes</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="bts"/>7.7. bts</h2>
            </div>
          </div>
        </div>
        <p>上傳套件後，您將收到錯誤報告。 如《Debian 開發者參考》<a class="ulink" href="https://www.debian.org/doc/manuals/developers-reference/pkgs.html#bug-handling">5.8. 處理缺陷</a> 中所述，正確地管理這些錯誤是套件維護者的一項重要職責。</p>
        <p><span class="strong"><strong>bts</strong></span> 命令是一個用以處理 <a class="ulink" href="https://www.debian.org/Bugs/">Debian 缺陷追蹤系統</a> 上的錯誤的便捷工具。</p>
        <pre class="screen">$ bts severity 123123 wishlist , tags -1 pending</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="gbp"/>7.8. git-buildpackage</h2>
            </div>
          </div>
        </div>
        <p><span class="strong"><strong>git-buildpackage</strong></span> 套件提供了許多命令來使用 git 倉庫自動打包。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem"><span class="strong"><strong>gbp import-dsc</strong></span>：向 git 倉庫中匯入先前的 Debian 原始碼包。</li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>gbp import-orig</strong></span>：向 git 倉庫中匯入新的上遊原始碼。</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem"><span class="strong"><strong>git import-orig</strong></span> 命令的 <span class="strong"><strong>--pristine-tar</strong></span> 選項允許將上游原始碼包儲存在同一個 git 倉庫中。</li>
                  <li class="listitem">將 <span class="strong"><strong>--uscan</strong></span> 選項作為 <span class="strong"><strong>gbp import-orig</strong></span> 命令的最後一個引數會允許下載上游原始碼並提交到 git 倉庫中。</li>
                </ul>
              </div>
            </li>
            <li class="listitem"><span class="strong"><strong>gbp dch</strong></span>：從 git 提交資訊中生成 Debian 變更資訊（changelog）。</li>
            <li class="listitem"><span class="strong"><strong>gbp buildpackage</strong></span>：從 git 倉庫中構建 Debian 二進位制包。</li>
            <li class="listitem"><span class="strong"><strong>gbp pull</strong></span>：從遠端倉庫中安全更新 <span class="strong"><strong>debian</strong></span>, <span class="strong"><strong>upstream</strong></span> and <span class="strong"><strong>pristine-tar</strong></span> 分支。</li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>git-pbuilder</strong></span>：使用 <span class="strong"><strong>pbuilder</strong></span> 套件從 git 倉庫構建 Debian 二進位制套件。</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">使用 <span class="strong"><strong>cowbuilder</strong></span> 套件作為後端。</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>gbp pq</strong></span>、<span class="strong"><strong>git-dpm</strong></span> 或 <span class="strong"><strong>quilt</strong></span>（或者其別名 <span class="strong"><strong>dquilt</strong></span>）命令用於管理相容 quilt 的補丁。</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem"><span class="strong"><strong>dquilt</strong></span> 命令是學起來最簡單的，它只要求您使用 <span class="strong"><strong>git</strong></span> 命令手動提交最後的檔案至 <span class="strong"><strong>master</strong></span> 分支。</li>
                  <li class="listitem">“<span class="strong"><strong>gbp pq</strong></span>” 命令提供了等效的補丁集管理功能，而不需要使用 <span class="strong"><strong>dquilt</strong></span> 並且使用 git 的揀選（cherry-pick）功能簡化了包含上游 git 倉庫修改的操作流程。</li>
                  <li class="listitem">“<span class="strong"><strong>git dpm</strong></span>” 命令提供了比 “<span class="strong"><strong>gbp pq</strong></span>” 更強大的功能。</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>使用<span class="strong"><strong>git-buildpackage</strong></span>套件來管理套件歷史正成為絕大多數 Debian 維護者的實踐標準。</p>
        <p>參見：</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<a class="ulink" href="https://honk.sigxcpu.org/projects/git-buildpackage/manual-html/gbp.html">使用 git-buildpackage 構建 Debian 套件</a>
</li>
            <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/GitPackagingWorkflow">https://wiki.debian.org/GitPackagingWorkflow</a>
</li>
            <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/GitPackagingWorkflow/DebConf11BOF">https://wiki.debian.org/GitPackagingWorkflow/DebConf11BOF</a>
</li>
            <li class="listitem">
<a class="ulink" href="https://raphaelhertzog.com/2010/11/18/4-tips-to-maintain-a-3-0-quilt-debian-source-package-in-a-vcs/">https://raphaelhertzog.com/2010/11/18/4-tips-to-maintain-a-3-0-quilt-debian-source-package-in-a-vcs/</a>
</li>
            <li class="listitem"><span class="strong"><strong>systemd</strong></span> 打包實踐文件在 <a class="ulink" href="https://salsa.debian.org/systemd-team/systemd/blob/master/debian/README.source">從原始碼構建</a>。</li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>放鬆。您並不需要使用全部的打包工具，您只需要使用您所需要的那個就行。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="debsnap"/>7.8.1. gbp import-dscs --debsnap</h3>
              </div>
            </div>
          </div>
          <p>對於記錄在 <a class="ulink" href="http://snapshot.debian.org/">snapshot.debian.org</a> 歸檔中的名為 <span class="emphasis"><em>&lt;source-package&gt;</em></span> 的 Debian 原始碼包，可以生成包含所有 Debian 版本歷史的初始 git 儲存庫，如下所示。</p>
          <pre class="screen">$ gbp import-dscs --debsnap --pristine-tar '&lt;source-package&gt;'</pre>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="upstream-git"/>7.9. 上游 git 倉庫</h2>
            </div>
          </div>
        </div>
        <p>對於使用 <span class="strong"><strong>git-buildpackage</strong></span> 打包的 Debian 套件，遠端儲存庫 <span class="strong"><strong>origin</strong></span> 上的 <span class="strong"><strong>upstream</strong></span> 分支通常用於追蹤已釋出的上游原始碼的內容。</p>
        <p>也可以通過將其遠端儲存庫命名為 <span class="strong"><strong>upstream</strong></span> 而不是預設的 <span class="strong"><strong>origin</strong></span> 來追蹤上游 git 倉庫。 然後，您可以通過使用 <span class="strong"><strong>gitk</strong></span> 命令和 <span class="strong"><strong>gbp-pq</strong></span> 命令進行挑選，輕鬆地將最近的上游更改新增到 Debian 修訂版中。</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>“<span class="strong"><strong>gbp import-orig --upstream-vcs-tag</strong></span>” 命令可以通過使用上游 git 倉庫中的指定標籤在 <span class="strong"><strong>upstream</strong></span> 分支上建立一個合併提交的方式來生成乾淨的打包歷史資訊。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Caution">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[注意]" src="images/caution.png"/>
              </td>
              <th align="left">注意</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>已釋出的上游原始碼的內容可能與上游 git 儲存庫的相應內容並不完全匹配。 它可能包含一些自動生成的檔案或遺漏一些檔案。（Autotools、distutils......）</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="chroot"/>7.10. chroot</h2>
            </div>
          </div>
        </div>
        <p>可以使用 <a class="xref" href="ch03.zh-tw.html" title="章 3. 工具的配置">章 3, <em>工具的配置</em></a> 中描述的工具建立和管理乾淨包構建環境的 <a class="ulink" href="https://en.wikipedia.org/wiki/Chroot">chroot</a>。<a href="#ftn.idm4751" class="footnote" id="idm4751"><sup class="footnote">[18]</sup></a></p>
        <p>以下是可用的套件構建命令的快速總結。 有很多方法可以做同樣的事情。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem"><span class="strong"><strong>dpkg-buildpackage</strong></span> = 套件打包工具的核心</li>
            <li class="listitem"><span class="strong"><strong>debuild</strong></span> = <span class="strong"><strong>dpkg-buildpackage</strong></span> + <span class="strong"><strong>lintian</strong></span> （在清理後的環境變數下構建）</li>
            <li class="listitem"><span class="strong"><strong>pbuilder</strong></span> = Debian chroot 環境工具的核心</li>
            <li class="listitem"><span class="strong"><strong>pdebuild</strong></span> = <span class="strong"><strong>pbuilder</strong></span> + <span class="strong"><strong>dpkg-buildpackage</strong></span> （在 chroot 環境下構建）</li>
            <li class="listitem"><span class="strong"><strong>cowbuilder</strong></span> = 提升 <span class="strong"><strong>pbuilder</strong></span> 執行的速度</li>
            <li class="listitem"><span class="strong"><strong>git-pbuilder</strong></span> = <span class="strong"><strong>pdebuild</strong></span> 的易於使用的命令列語法（由 <span class="strong"><strong>gbp buildpackge</strong></span> 使用）</li>
            <li class="listitem"><span class="strong"><strong>gbp</strong></span> = 在 git 下管理 Debian 原始碼</li>
            <li class="listitem"><span class="strong"><strong>gbp buildpackge</strong></span> = <span class="strong"><strong>pbuilder</strong></span> + <span class="strong"><strong>dpkg-buildpackage</strong></span> + <span class="strong"><strong>gbp</strong></span></li>
          </ul>
        </div>
        <p>可以根據如下方式使用乾淨的 <span class="strong"><strong>sid</strong></span> 版本的 chroot 環境。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">用於 <span class="strong"><strong>sid</strong></span> 發行版的 chroot 檔案系統建立命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pbuilder create</strong>
                    </span>
                  </li>
                  <li class="listitem">
                    <span class="strong">
                      <strong>git-pbuilder create</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>sid</strong></span> 版本的 chroot 檔案系統的檔案路徑</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>/var/cache/pbuilder/base.cow</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>sid</strong></span> 發行版 chroot 的套件構建命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pdebuild</strong>
                    </span>
                  </li>
                  <li class="listitem">
                    <span class="strong">
                      <strong>git-pbuilder</strong>
                    </span>
                  </li>
                  <li class="listitem">
                    <span class="strong">
                      <strong>gbp buildpackage</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">更新 <span class="strong"><strong>sid</strong></span> chroot 的命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pbuilder --update</strong>
                    </span>
                  </li>
                  <li class="listitem">
                    <span class="strong">
                      <strong>git-pbuilder update</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">要登入到 <span class="strong"><strong>sid</strong></span> 修改 chroot 檔案系統的命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>git-pbuilder login --save-after-login</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>可以根據如下方式使用任意的 <span class="emphasis"><em>dist</em></span> 版本環境。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">用於 <span class="strong"><strong>dist</strong></span> 版本的 chroot 檔案系統建立命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem"><span class="strong"><strong>pbuilder create --distribution</strong></span> <span class="emphasis"><em>dist</em></span></li>
                  <li class="listitem"><span class="strong"><strong>DIST=</strong></span><span class="emphasis"><em>dist</em></span> <span class="strong"><strong>git-pbuilder create</strong></span></li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>dist</strong></span> 版本的 chroot 檔案系統的檔案路徑</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">path: <span class="strong"><strong>/var/cache/pbuilder/base-</strong></span><span class="emphasis"><em>dist</em></span><span class="strong"><strong>.cow</strong></span></li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>dist</strong></span> 版本 chroot 的包構建命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pdebuild -- --basepath=/var/cache/pbuilder/base-</strong>
                    </span>
                    <span class="emphasis">
                      <em>dist</em>
                    </span>
                    <span class="strong">
                      <strong>.cow</strong>
                    </span>
                  </li>
                  <li class="listitem"><span class="strong"><strong>DIST=</strong></span><span class="emphasis"><em>dist</em></span> <span class="strong"><strong>git-pbuilder</strong></span></li>
                  <li class="listitem">
                    <span class="strong">
                      <strong>gbp buildpackage --git-dist=</strong>
                    </span>
                    <span class="emphasis">
                      <em>dist</em>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">更新 <span class="strong"><strong>dist</strong></span> chroot 的命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pbuilder update --basepath=/var/cache/pbuilder/base-</strong>
                    </span>
                    <span class="emphasis">
                      <em>dist</em>
                    </span>
                    <span class="strong">
                      <strong>.cow</strong>
                    </span>
                  </li>
                  <li class="listitem"><span class="strong"><strong>DIST=</strong></span><span class="emphasis"><em>dist</em></span> <span class="strong"><strong>git-pbuilder update</strong></span></li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">登入 <span class="strong"><strong>dist</strong></span> chroot 環境以進行修改的命令</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>pbuilder --login --basepath=/var/cache/pbuilder/base-</strong>
                    </span>
                    <span class="emphasis">
                      <em>dist</em>
                    </span>
                    <span class="strong">
                      <strong>.cow --save-after-login</strong>
                    </span>
                  </li>
                  <li class="listitem"><span class="strong"><strong>DIST=</strong></span><span class="emphasis"><em>dist</em></span> <span class="strong"><strong>git-pbuilder login --save-after-login</strong></span></li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>使用這個“git-pbuilder login --save-after-login”命令可以非常方便地建立一個包含一些新實驗套件所需的預載入包的設定環境。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>如果您的舊 chroot 檔案系統缺少例如 <span class="strong"><strong>libeatmydata1</strong></span>、<span class="strong"><strong>ccache</strong></span> 和 <span class="strong"><strong>lintian</strong></span> 等套件，您可能需要使用“<span class="strong"><strong>git-pbuilder login --save-after-login</strong></span>” 命令來安裝這些套件。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>只需使用 “<span class="strong"><strong>cp -a base-</strong></span><span class="emphasis"><em>dist</em></span><span class="strong"><strong>.cow base-</strong></span><span class="emphasis"><em>customdist</em></span><span class="strong"><strong>.cow</strong></span>” 命令即可複製 chroot 檔案系統。 新的 chroot 可以以 “<span class="strong"><strong>gbp buildpackage --git-dist=</strong></span><span class="emphasis"><em>customdist”</em></span> 和 “<span class="strong"><strong>DIST=</strong></span><span class="emphasis"><em>customdist</em></span> <span class="strong"><strong>git-pbuilder …</strong></span>” 查詢。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>當需要為除 <span class="strong"><strong>0</strong></span> 和 <span class="strong"><strong>1</strong></span> 之外的 Debian 修訂版上傳 <span class="strong"><strong>orig.tar.gz</strong></span> 檔案時（例如，對於安全性上傳），將 <span class="strong"><strong>-sa</strong></span> 選項新增到 <span class="strong"><strong>dpkg-buildpackage</strong></span>，<span class="strong"><strong>debuild</strong></span>，<span class="strong"><strong>pdebuild</strong></span> 和 <span class="strong"><strong>git-pbuilder</strong></span> 命令末尾。 對於 “<span class="strong"><strong>gbp buildpackage</strong></span>” 命令，臨時修改 <span class="strong"><strong>~/.gbp.conf</strong></span> 中的 <span class="strong"><strong>builder</strong></span> 設定。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[注意]" src="images/note.png"/>
              </td>
              <th align="left">注意</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>本節中的描述過於簡潔，對大多數潛在的維護者都沒用。 這是作者的有意為之。 我們強烈建議您搜尋並閱讀與所用命令相關的所有文件。</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="newrevision"/>7.11. 新的 Debian 版本</h2>
            </div>
          </div>
        </div>
        <p>讓我們假設有一個錯誤報告 <span class="strong"><strong>#</strong></span><span class="emphasis"><em>bug_number</em></span> 是針對您的套件的。它描述了一個問題，您可以通過編輯上游原始碼中的錯誤檔案來解決。以下是使用 <span class="strong"><strong>bugname.patch</strong></span> 檔案建立套件的新 Debian 套件修訂版所需的操作。</p>
        <p><strong>使用 <span class="strong"><strong>dquilt</strong></span> 命令準備新的 Debian 套件修訂版本. </strong>
</p>
        <pre class="screen"> $ dquilt push -a
 $ dquilt new bugname.patch
 $ dquilt add buggy
 $ vim buggy
   ...
 $ dquilt refresh
 $ dquilt header -e
 $ dquilt pop -a
 $ dch -i</pre>
        <p>
</p>
        <p>此外，如果套件是用 <span class="strong"><strong>git-buildpackage</strong></span> 命令以其預設配置管理的 git 倉庫：</p>
        <p><strong>使用 <span class="strong"><strong>gbp-pq</strong></span> 命令進行新的 Debian 修訂. </strong>
</p>
        <pre class="screen"> $ git checkout master
 $ gbp pq import
 $ vim buggy
 $ git add buggy
 $ git commit
 $ git tag pq/&lt;newrev&gt;
 $ gbp pq export
 $ gbp drop
 $ git add debian/patches/*
 $ dch -i
 $ git commit -a -m "Closes: #&lt;bug_number&gt;"</pre>
        <p>
</p>
        <p>請確保簡明扼要地描述修復報告錯誤的更改並通過在 <span class="strong"><strong>debian/changelog</strong></span> 檔案中新增 “<span class="strong"><strong>Closes: #</strong></span><span class="emphasis"><em>&lt;bug_number&gt;”</em></span> 來關閉這些錯誤。</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>在實驗時使用帶有版本字串的 <span class="strong"><strong>debian/changelog</strong></span> 條目，例如 <span class="strong"><strong>1.0.1-1~rc1</strong></span> 。然後，將這些更改日誌條目整理到官方套件的條目中。</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="newversion"/>7.12. 新上游版本</h2>
            </div>
          </div>
        </div>
        <p>如果 <span class="strong"><strong>foo</strong></span> 包是以現代“<span class="strong"><strong>3.0 (native)</strong></span>”或“<span class="strong"><strong>3.0 (quilt)</strong></span>”格式正確打包的，則打包新的上游版本時需要將舊的 <span class="strong"><strong>debian/</strong></span> 目錄移動到新的原始碼路徑中。 這可以通過在新提取的原始碼路徑中執行“<span class="strong"><strong>tar -xvzf</strong></span> <span class="emphasis"><em>/path/to/foo_oldversion</em></span><span class="strong"><strong>.debian.tar.gz</strong></span>”命令來完成。<a href="#ftn.idm4983" class="footnote" id="idm4983"><sup class="footnote">[19]</sup></a> 當然，你還需要做一些修改。</p>
        <p>有很多的工具可以用以處理這些情況。在使用這些軟體來更新上游版本後，請在 <span class="strong"><strong>debian/changelog</strong></span> 檔案中簡要描述修復錯誤的上游修改，並新增 “<span class="strong"><strong>Closes: #</strong></span><span class="emphasis"><em>bug_number”</em></span> 來關閉錯誤。</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="uupdate"/>7.12.1. uupdate + tarball</h3>
              </div>
            </div>
          </div>
          <p>您可以使用來自 <span class="strong"><strong>uupdate</strong></span> 套件中的 <span class="strong"><strong>uupdate</strong></span> 命令來自動更新到新的上游原始碼。該命令需要舊的 Debian 原始碼包和新的上游原始碼包。</p>
          <pre class="screen"> $ wget https://example.org/foo/foo-newversion.tar.gz
 $ cd foo-oldversion
 $ uupdate -v newversion ../foo-newversion.tar.gz
 ...
 $ cd ../foo-newversion
 $ while dquilt push; do dquilt refresh; done
 $ dch</pre>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="uscan"/>7.12.2. uscan</h3>
              </div>
            </div>
          </div>
          <p>您可以使用來自 <span class="strong"><strong>uupdate</strong></span> 套件中的 <span class="strong"><strong>uscan</strong></span> 命令來自動更新到新的上游原始碼。該命令需要包含 <span class="strong"><strong>debian/watch</strong></span> 檔案的舊的 Debian 原始碼包。</p>
          <pre class="screen"> $ cd foo-oldversion
 $ uscan
 ...
 $ while dquilt push; do dquilt refresh; done
 $ dch</pre>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="gbp-orig"/>7.12.3. gbp</h3>
              </div>
            </div>
          </div>
          <p>您可以使用來自 <span class="strong"><strong>git-buildpackage</strong></span> 套件中的 “<span class="strong"><strong>gbp import-orig --pristine-tar</strong></span>” 命令來自動更新到新的上游原始碼。該命令需要在 git 倉庫中的 Debian 原始碼和新的上游原始碼包。</p>
          <pre class="screen"> $ ln -sf foo-newversion.tar.gz foo_newversion.orig.tar.gz
 $ cd foo-vcs
 $ git checkout master
 $ gbp pq import
 $ git checkout master
 $ gbp import-orig --pristine-tar  ../foo_newversion.orig.tar.gz
 ...
 $ gbp pq rebase
 $ git checkout master
 $ gbp pq export
 $ gbp pq drop
 $ git add debian/patches
 $ dch -v &lt;newversion&gt;
 $ git commit -a -m "Refresh patches"</pre>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[提示]" src="images/tip.png"/>
                </td>
                <th align="left">提示</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>如果上游也使用 git 倉庫，請為 <span class="strong"><strong>gbp import-orig</strong></span> 命令加上 <span class="strong"><strong>--upstream-vcs-tag</strong></span> 選項。</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="gbp-uscan"/>7.12.4. gbp + uscan</h3>
              </div>
            </div>
          </div>
          <p>您可以使用來自 <span class="strong"><strong>git-buildpackage</strong></span> 套件中的“<span class="strong"><strong>gbp import-orig --pristine-tar --uscan</strong></span>”命令來自動更新到新的上游原始碼。該命令需要在 git 倉庫中的包含 <span class="strong"><strong>debian/watch</strong></span> 檔案的 Debian 原始碼。</p>
          <pre class="screen"> $ cd foo-vcs
 $ git checkout master
 $ gbp pq import
 $ git checkout master
 $ gbp import-orig --pristine-tar --uscan
 ...
 $ gbp pq rebase
 $ git checkout master
 $ gbp pq export
 $ gbp pq drop
 $ git add debian/patches
 $ dch -v &lt;newversion&gt;
 $ git commit -a -m "Refresh patches"</pre>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[提示]" src="images/tip.png"/>
                </td>
                <th align="left">提示</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>如果上游也使用 git 倉庫，請為 <span class="strong"><strong>gbp import-orig</strong></span> 命令加上 <span class="strong"><strong>--upstream-vcs-tag</strong></span> 選項。</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="deb3"/>7.13. 3.0 原始碼格式</h2>
            </div>
          </div>
        </div>
        <p>更新套件的風格並不是更新套件所必須的步驟。但是，這麼做可以讓您充分利用現代 <span class="strong"><strong>debhelper</strong></span> 和 <span class="strong"><strong>3.0</strong></span> 原始碼格式的所有能力。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">如果您因任何原因需要重新建立已刪除的模板檔案，您可以在同一個 Debian 套件源碼樹中再次執行 <span class="strong"><strong>debmake</strong></span>。然後適當地編輯它們。</li>
            <li class="listitem">如果套件還未更新到可為 <span class="strong"><strong>debian/rules</strong></span> 文件使用 <span class="strong"><strong>dh</strong></span> 命令，請升級它以便使用該命令（參見 <a class="xref" href="ch05.zh-tw.html#simplerules" title="5.4.2. 簡單的 debian/rules">節 5.4.2, “簡單的 debian/rules”</a>）。請根據具體情況更新 <span class="strong"><strong>debian/control</strong></span> 檔案。</li>
            <li class="listitem">如果你有一個帶有 <span class="strong"><strong>foo.diff.gz</strong></span> 檔案的 <span class="strong"><strong>1.0</strong></span> 格式的原始碼包，你可以通過建立帶有“<span class="strong"><strong>3.0 (quilt)</strong></span>”的 <span class="strong"><strong>debian/source/format</strong></span> 檔案來升級至新的 “<span class="strong"><strong>3.0 (quilt)</strong></span>”格式。剩下的 <span class="strong"><strong>debian/</strong></span>* 檔案可以直接複製。如果需要的話，可以將“<span class="strong"><strong>filterdiff -z -x <span class="emphasis"><em><span class="strong"><strong>/debian/</strong></span></em></span> foo.diff.gz &gt; big.diff</strong></span>”命令生成的 <span class="strong"><strong>big.diff</strong></span> 檔案匯入到你的 quilt 系統中。<a href="#ftn.idm5055" class="footnote" id="idm5055"><sup class="footnote">[20]</sup></a></li>
            <li class="listitem">如果它使用了其他的補丁系統，例如 <span class="strong"><strong>dpatch</strong></span>、<span class="strong"><strong>dbs</strong></span> 或者是帶有 <span class="strong"><strong>-p0</strong></span>、<span class="strong"><strong>-p1</strong></span>、<span class="strong"><strong>-p2</strong></span> 引數的 <span class="strong"><strong>cdbs</strong></span>。請使用 <span class="strong"><strong>quilt</strong></span> 包中的 <span class="strong"><strong>deb3</strong></span> 指令碼來轉換它。</li>
            <li class="listitem">如果它使用了帶有 “<span class="strong"><strong>--with quilt</strong></span>” 選項的 <span class="strong"><strong>dh</strong></span> 命令或者使用了 <span class="strong"><strong>dh_quilt_patch</strong></span> 和 <span class="strong"><strong>dh_quilt_unpatch</strong></span> 命令，請移除這些並且使其使用新的 “<span class="strong"><strong>3.0 (quilt)</strong></span>” 格式。</li>
            <li class="listitem">如果您有一個不帶 <span class="strong"><strong>foo.diff.gz</strong></span> 檔案的 <span class="strong"><strong>1.0</strong></span> 格式的原始碼包，您可以通過建立包含“<span class="strong"><strong>3.0 (native)</strong></span>”的 <span class="strong"><strong>debian/source/format</strong></span> 檔案，然後將其餘的 <span class="strong"><strong>debian/</strong></span>* 檔案直接複製的方式來更新至新的“<span class="strong"><strong>3.0 (native)</strong></span>”的原始碼格式。</li>
          </ul>
        </div>
        <p>您應該核對一下 <a class="ulink" href="http://dep.debian.net/">DEP——Debian 增強提議</a> 並且採用已接受的提議。</p>
        <p>參見 <a class="ulink" href="https://wiki.debian.org/Projects/DebSrc3.0">ProjectsDebSrc3.0</a> 以核對 Debian 工具鏈對新 Debian 原始碼格式的支援情況。</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="cdbs"/>7.14. CDBS</h2>
            </div>
          </div>
        </div>
        <p>Common Debian Build System （<span class="strong"><strong>CDBS</strong></span>）是 <span class="strong"><strong>debhelper</strong></span> 套件的包裝系統。<span class="strong"><strong>CDBS</strong></span> 基於 Makefile 包含機制並且由 <span class="strong"><strong>debian/rules</strong></span> 檔案中設定的 <span class="strong"><strong>DEB_</strong></span>* 變數配置。</p>
        <p>在將 <span class="strong"><strong>dh</strong></span> 命令引入第七版的 <span class="strong"><strong>debhelper</strong></span> 套件之前，<span class="strong"><strong>CDBS</strong></span> 是建立簡單乾淨的 <span class="strong"><strong>debian/rules</strong></span> 檔案的唯一方法。</p>
        <p>對於很多簡單的套件，現在 <span class="strong"><strong>dh</strong></span> 命令使 <span class="strong"><strong>debian/rules</strong></span> 檔案很簡潔，建議保持構建系統簡潔，而非使用冗長的 <span class="strong"><strong>CDBS</strong></span>。</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[注意]" src="images/note.png"/>
              </td>
              <th align="left">注意</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>“<span class="strong"><strong>CDBS</strong></span> 神奇地讓我用更少的命令來完成工作”和“我不懂新的 <span class="strong"><strong>dh</strong></span> 的語法”都不是您繼續使用舊的 <span class="strong"><strong>CDBS</strong></span> 系統的藉口。</p>
              </td>
            </tr>
          </table>
        </div>
        <p>對於一些複雜的套件，比如與 GNOME 相關的，當前的維護者有理由利用 <span class="strong"><strong>CDBS</strong></span> 自動化完成他們的統一包裝。如果是這種情況，請不要費心從 <span class="strong"><strong>CDBS</strong></span> 轉換為 <span class="strong"><strong>dh</strong></span> 語法。</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[注意]" src="images/note.png"/>
              </td>
              <th align="left">注意</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>如果您正在與維護 <a class="ulink" href="https://wiki.debian.org/Teams">團隊</a> 合作，請遵循團隊的既定慣例。</p>
              </td>
            </tr>
          </table>
        </div>
        <p>將套件從 <span class="strong"><strong>CDBS</strong></span> 轉換為 <span class="strong"><strong>dh</strong></span> 語法時，請使用以下內容作為參考：</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<a class="ulink" href="http://cdbs-doc.duckcorp.org/en/cdbs-doc.xhtml">CDBS 文件</a>
</li>
            <li class="listitem">
<a class="ulink" href="https://meetings-archive.debian.net/pub/debian-meetings/2009/fosdem/slides/The_Common_Debian_Build_System_CDBS/">The Common Debian Build System (CDBS), FOSDEM 2009</a>
</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="utf-8-build"/>7.15. 在 UTF-8 環境下構建</h2>
            </div>
          </div>
        </div>
        <p>構建環境的預設語言環境是 <span class="strong"><strong>C</strong></span>。</p>
        <p>某些程式（如 Python3 的 <span class="strong"><strong>read</strong></span> 函式）會根據區域設定改變行為。</p>
        <p>新增以下程式碼到 <span class="strong"><strong>debian/rules</strong></span> 檔案可以確保程式使用 <span class="strong"><strong>C.UTF-8</strong></span> 的區域語言設定（locale）進行構建。</p>
        <pre class="screen">LC_ALL := C.UTF-8
export LC_ALL</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="utf-8-conv"/>7.16. UTF-8 轉換</h2>
            </div>
          </div>
        </div>
        <p>如果上游文件是用舊編碼方案編碼的，那麼將它們轉換為 <a class="ulink" href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> 是個好主意。</p>
        <p>請使用 <span class="strong"><strong>libc-bin</strong></span> 包中的 <span class="strong"><strong>iconv</strong></span> 命令來轉換純文字檔案的編碼。</p>
        <pre class="screen"> $ iconv -f latin1 -t utf8 foo_in.txt &gt; foo_out.txt</pre>
        <p>使用 <span class="strong"><strong>w3m</strong></span>(1) 將 HTML 檔案轉換為 UTF-8 純文字檔案。 執行此操作時，請確保在 UTF-8 語言環境下執行它。</p>
        <pre class="screen"> $ LC_ALL=C.UTF-8 w3m -o display_charset=UTF-8 \
        -cols 70 -dump -no-graph -T text/html \
        &lt; foo_in.html &gt; foo_out.txt</pre>
        <p>在 <span class="strong"><strong>debian/rules</strong></span> 檔案的 <span class="strong"><strong>override_dh_</strong></span>* 目標中執行這些指令碼。</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="origtar"/>7.17. 上傳 <span class="strong"><strong>orig.tar.gz</strong></span></h2>
            </div>
          </div>
        </div>
        <p>當您第一次向歸檔上傳套件時，您還需要包含原始的 <span class="strong"><strong>orig.tar.gz</strong></span> 原始碼。</p>
        <p>如果 Debian 修訂碼是 <span class="strong"><strong>1</strong></span> 或者 <span class="strong"><strong>0</strong></span>，這都是預設的。否則，您必須使用帶有 <span class="strong"><strong>-sa</strong></span> 選項的 <span class="strong"><strong>dpkg-buildpackage</strong></span> 命令。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <span class="strong">
                <strong>dpkg-buildpackage -sa</strong>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>debuild -sa</strong>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>pdebuild --debbuildopts -sa</strong>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>git-pbuilder -sa</strong>
              </span>
            </li>
            <li class="listitem">對於 <span class="strong"><strong>gbp buildpackage</strong></span>，請編輯 <span class="strong"><strong>~/.gbp.conf</strong></span> 檔案。</li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>另一方面，<span class="strong"><strong>-sd</strong></span> 選項將會強制排除原始的 <span class="strong"><strong>orig.tar.gz</strong></span> 原始碼。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>新增至 <span class="strong"><strong>~/.bashrc</strong></span> 檔案。</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="skipedupload"/>7.18. 跳過的上傳</h2>
            </div>
          </div>
        </div>
        <p>如果當跳過上傳時，你在 <span class="strong"><strong>debian/changelog</strong></span> 中建立了多個條目，你必須建立一個包含自上次上傳以來所有變更的 <span class="strong"><strong>debian/changelog</strong></span> 檔案。這可以通過指定 dpkg-buildpackage 選項 <span class="strong"><strong>-v</strong></span> 以及上次上傳的版本號，比如 <span class="emphasis"><em>1.2</em></span> 來完成。</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <span class="strong">
                <strong>dpkg-buildpackage -v</strong>
              </span>
              <span class="emphasis">
                <em>1.2</em>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>debuild -v</strong>
              </span>
              <span class="emphasis">
                <em>1.2</em>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>pdebuild --debbuildopts -v</strong>
              </span>
              <span class="emphasis">
                <em>1.2</em>
              </span>
            </li>
            <li class="listitem">
              <span class="strong">
                <strong>git-pbuilder -v</strong>
              </span>
              <span class="emphasis">
                <em>1.2</em>
              </span>
            </li>
            <li class="listitem">對於 <span class="strong"><strong>gbp buildpackage</strong></span>，請編輯 <span class="strong"><strong>~/.gbp.conf</strong></span> 檔案。</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="adv-pkg"/>7.19. 高階打包</h2>
            </div>
          </div>
        </div>
        <p>關於以下內容的提示可以在 <span class="strong"><strong>debhelper</strong></span>(7) 手冊頁中找到：</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem"> <span class="strong"><strong>debhelper</strong></span> 工具在 “<span class="strong"><strong>compat</strong></span> &lt;= 8” 選項下不同的行為</li>
            <li class="listitem">
              <p class="simpara">在數種不同構建條件下構建多種二進位制包</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">製作上游原始碼的多個副本</li>
                  <li class="listitem">在 <span class="strong"><strong>override_dh_auto_configure</strong></span> 目標中呼叫多個 “<span class="strong"><strong>dh_auto_configure -S …</strong></span>” 指令</li>
                  <li class="listitem">在 <span class="strong"><strong>override_dh_auto_build</strong></span> 目標中呼叫多個 “<span class="strong"><strong>dh_auto_build -S …</strong></span>” 指令</li>
                  <li class="listitem">在 <span class="strong"><strong>override_dh_auto_install</strong></span> 目標中呼叫多個 “<span class="strong"><strong>dh_auto_install -S …</strong></span>” 指令</li>
                </ul>
              </div>
            </li>
            <li class="listitem">在 <span class="strong"><strong>debian/control</strong></span> 中以 “<span class="strong"><strong>Package-Type: udeb</strong></span>” 選項來構建 <span class="strong"><strong>udeb</strong></span> 包（參見 <a class="ulink" href="https://www.debian.org/doc/debian-policy/#s-f-package-type">Package-Type</a>）</li>
            <li class="listitem">
              <p class="simpara">從引導程序中排除某些包（參見 <a class="ulink" href="https://wiki.debian.org/BuildProfileSpec">BuildProfileSpec</a>）</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">在 <span class="strong"><strong>debian/control</strong></span> 中的二進位制包節中新增 <span class="strong"><strong>Build-Profiles</strong></span> 欄位</li>
                  <li class="listitem">在 <span class="strong"><strong>DEB_BUILD_PROFILES</strong></span> 環境變數設定成相關配置檔名的條件下構建套件</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>關於以下內容的提示可以在 <span class="strong"><strong>dpkg-source</strong></span>(1) 手冊頁中找到：</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">多個上游原始碼包的命名約定</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="emphasis">
                      <em>套件名_版本</em>
                    </span>
                    <span class="strong">
                      <strong>.orig.tar.gz</strong>
                    </span>
                  </li>
                  <li class="listitem">
                    <span class="emphasis">
                      <em>套件名_版本</em>
                    </span>
                    <span class="strong">
                      <strong>.orig-</strong>
                    </span>
                    <span class="emphasis">
                      <em>部件名</em>
                    </span>
                    <span class="strong">
                      <strong>.tar.gz</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">將 Debian 更改記錄到上游原始碼包中</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <span class="strong">
                      <strong>dpkg-source --commit</strong>
                    </span>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="other-distro"/>7.20. 其他發行版</h2>
            </div>
          </div>
        </div>
        <p>儘管上游的原始碼有著所有構建 Debian 套件所需的資訊，找出使用何種選項的組合仍然不是一件簡單的事。</p>
        <p>此外，上游的包可能更專注於功能的增強，而並不那麼重視向後相容性等特性，這是 Debian 打包實踐中的一個重要方面。</p>
        <p>利用其他發行版的資訊是解決上述問題的一種選擇。</p>
        <p>如果其他發行版是由 Debian 派生的，重新使用它是沒有價值的。</p>
        <p>如果其他發行版是基於 <a class="ulink" href="https://en.wikipedia.org/wiki/RPM_Package_Manager">RPM</a> 的發行版，請參見 <a class="ulink" href="https://wiki.debian.org/Repackage_srcrpm">Repackage src.rpm</a>。</p>
        <p>通過 <span class="strong"><strong>rget</strong></span> 命令，可以下載並開啟 <span class="strong"><strong>src.rpm</strong></span>檔案。（請將 <span class="strong"><strong>rget</strong></span> 指令碼新增至 PATH 中）</p>
        <p><strong>rget 指令碼. </strong>
</p>
        <pre class="screen">#!/bin/sh
FCSRPM=$(basename $1)
mkdir ${FCSRPM}; cd ${FCSRPM}/
wget $1
rpm2cpio ${FCSRPM} | cpio -dium</pre>
        <p>
</p>
        <p>許多上游原始碼包包含 RPM 系統使用的、以 <span class="emphasis"><em>packagename</em></span>.<span class="strong"><strong>spec</strong></span> 或者 <span class="emphasis"><em>packagename</em></span>.<span class="strong"><strong>spec.in</strong></span> 命名的SPEC 檔案。這可以被用做 Debian 套件的基點。</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debug"/>7.21. 除錯</h2>
            </div>
          </div>
        </div>
        <p>當您遇到構建問題或者生成的二進位制程式核心轉儲時，您需要自行解決他們。這就是<span class="strong"><strong>除錯（debug）</strong></span>。</p>
        <p>This is too deep a topic to describe here. So, let me just list few pointers and hints for some typical debug tools.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<a class="ulink" href="https://en.wikipedia.org/wiki/Core_dump">核心轉儲</a>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">“<span class="strong"><strong>man core</strong></span>”</li>
                  <li class="listitem">
                    <p class="simpara">更新 “<span class="strong"><strong>/etc/security/limits.conf</strong></span>” 檔案來包含以下程式碼：</p>
                    <pre class="screen">* soft core unlimited</pre>
                  </li>
                  <li class="listitem">在 <span class="strong"><strong>~/.bashrc</strong></span> 中新增“<span class="strong"><strong>ulimit -c unlimited</strong></span>”</li>
                  <li class="listitem">使用 “<span class="strong"><strong>ulimit -a</strong></span>” 來檢查</li>
                  <li class="listitem">按下 <span class="strong"><strong>Ctrl-\</strong></span> 或者“<span class="strong"><strong>kill -ABRT</strong></span> <span class="emphasis"><em>PID”</em></span> 來建立一個核心轉儲檔案</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>gdb</strong></span> - The GNU Debugger</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">“<span class="strong"><strong>info gdb</strong></span>”</li>
                  <li class="listitem">參見 <span class="strong"><strong>/usr/share/doc/gdb-doc/html/gdb/index.html</strong></span> 中的 “Debugging with GDB”</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>strace</strong></span> - 追蹤系統呼叫和訊號</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">使用 <span class="strong"><strong>/usr/share/doc/strace/examples/</strong></span> 中的 <span class="strong"><strong>strace-graph</strong></span> 指令碼來建立一個好看的樹形圖</li>
                  <li class="listitem">“<span class="strong"><strong>man strace</strong></span>”</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>ltrace</strong></span> - 追蹤程式庫呼叫</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">“<span class="strong"><strong>man ltrace</strong></span>”</li>
                </ul>
              </div>
            </li>
            <li class="listitem">“<span class="strong"><strong>sh -n</strong></span> <span class="emphasis"><em>script.sh”</em></span> - Shell 指令碼的語法檢查</li>
            <li class="listitem">“<span class="strong"><strong>sh -x</strong></span> <span class="emphasis"><em>script.sh”</em></span> - 追蹤 Shell 指令碼</li>
            <li class="listitem">“<span class="strong"><strong>python -m py_compile</strong></span> <span class="emphasis"><em>script.py”</em></span> - Python 指令碼的語法檢查</li>
            <li class="listitem">“<span class="strong"><strong>python -mtrace --trace</strong></span> <span class="emphasis"><em>script.py”</em></span> - 追蹤 Python 指令碼</li>
            <li class="listitem">“<span class="strong"><strong>perl -I ../libpath -c</strong></span> <span class="emphasis"><em>script.pl”</em></span> - Perl 指令碼的語法檢查</li>
            <li class="listitem">
              <p class="simpara">“<span class="strong"><strong>perl -d:Trace</strong></span> <span class="emphasis"><em>script.pl”</em></span> - 追蹤 Perl 指令碼</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">安裝 <span class="strong"><strong>libterm-readline-gnu-perl</strong></span> 套件或者同類型軟體來新增輸入行編輯功能與歷史記錄支援。</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara"><span class="strong"><strong>lsof</strong></span> - 按程序列出開啟的檔案</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">“<span class="strong"><strong>man lsof</strong></span>”</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p><span class="strong"><strong>script</strong></span> 命令能幫助記錄控制檯輸出。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>在 <span class="strong"><strong>ssh</strong></span> 命令中搭配使用 <span class="strong"><strong>screen</strong></span> 和 <span class="strong"><strong>tmux</strong></span> 命令，能夠提供安全並且強健的遠端連線終端。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p><span class="strong"><strong>libreply-perl</strong></span>（新的）套件和來自 <span class="strong"><strong>libdevel-repl-perl</strong></span>（舊的）套件的 <span class="strong"><strong>re.pl</strong></span> 命令為 Perl 提供了一個類似 Python 和 Shell 的 REPL (=READ + EVAL + PRINT + LOOP) 環境。</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[提示]" src="images/tip.png"/>
              </td>
              <th align="left">提示</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p><span class="strong"><strong>rlwrap</strong></span> 和 <span class="strong"><strong>rlfe</strong></span> 命令為所有互動命令提供了輸入行編輯功能。例如 “<span class="strong"><strong>rlwrap dash -i</strong></span>”。</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="footnotes">
        <br/>
        <hr/>
        <div id="ftn.idm4751" class="footnote">
          <p><a href="#idm4751" class="simpara"><sup class="simpara">[18] </sup></a><a class="ulink" href="https://wiki.debian.org/git-pbuilder">https://wiki.debian.org/git-pbuilder</a> 採用了 <span class="strong"><strong>git-pbuilder</strong></span> 風格管理。請小心，因為許多 HOWTO 使用了不同的組織。</p>
        </div>
        <div id="ftn.idm4983" class="footnote">
          <p><a href="#idm4983" class="simpara"><sup class="simpara">[19] </sup></a>如果 <span class="strong"><strong>foo</strong></span> 包是以舊的 <span class="strong"><strong>1.0</strong></span> 格式打包的，則相對的，只要在新的原始碼路徑中執行“<span class="strong"><strong>zcat</strong></span> <span class="emphasis"><em>/path/to/foo_oldversion</em></span><span class="strong"><strong>.diff.gz|patch -p1</strong></span>”命令。</p>
        </div>
        <div id="ftn.idm5055" class="footnote">
          <p><a href="#idm5055" class="simpara"><sup class="simpara">[20] </sup></a>您可以使用 <span class="strong"><strong>splitdiff</strong></span> 命令來將 <span class="strong"><strong>big.diff</strong></span> 檔案分割成多個小的增量更新補丁檔案。</p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td align="left"><a accesskey="p" href="ch06.zh-tw.html"><img src="images/prev.png" alt="前一頁"/></a> </td>
          <td align="center"> </td>
          <td align="right"> <a accesskey="n" href="ch08.zh-tw.html"><img src="images/next.png" alt="下一頁"/></a></td>
        </tr>
        <tr>
          <td align="left" valign="top">章 6. debmake 選項 </td>
          <td align="center">
            <a accesskey="h" href="index.zh-tw.html">
              <img src="images/home.png" alt="起始頁"/>
            </a>
          </td>
          <td align="right" valign="top"> 章 8. 更多範例</td>
        </tr>
      </table>
    </div>
  </body>
</html>
