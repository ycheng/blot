<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Chapter 5. Basics</title>
    <link rel="stylesheet" type="text/css" href="debian.css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="home" href="index.en.html" title="Guide for Debian Maintainers"/>
    <link rel="up" href="index.en.html" title="Guide for Debian Maintainers"/>
    <link rel="prev" href="ch04.en.html" title="Chapter 4. Simple Example"/>
    <link rel="next" href="ch06.en.html" title="Chapter 6. debmake options"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Chapter 5. Basics</th>
        </tr>
        <tr>
          <td align="left"><a accesskey="p" href="ch04.en.html"><img src="images/prev.png" alt="Prev"/></a> </td>
          <th width="60%" align="center"> </th>
          <td align="right"> <a accesskey="n" href="ch06.en.html"><img src="images/next.png" alt="Next"/></a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="chapter">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="basics"/>Chapter 5. Basics</h1>
          </div>
        </div>
      </div>
      <div class="toc">
        <p>
          <strong>Table of Contents</strong>
        </p>
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="ch05.en.html#workflow">5.1. Packaging workflow</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#debhelper">5.1.1. The <span class="strong"><strong>debhelper</strong></span> package</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#name-version">5.2. Package name and version</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#native">5.3. Native Debian package</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#rules">5.4. debian/rules</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#dh">5.4.1. dh</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#simplerules">5.4.2. Simple debian/rules</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#customrules">5.4.3. Customized debian/rules</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#variablesrules">5.4.4. Variables for debian/rules</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#reproducible">5.4.5. Reproducible build</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#control">5.5. debian/control</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#split">5.5.1. Split of a Debian binary package</a>
                </span>
              </dt>
              <dd>
                <dl>
                  <dt>
                    <span class="section">
                      <a href="ch05.en.html#boption">5.5.1.1. debmake -b</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="ch05.en.html#package-split-example">5.5.1.2. Package split scenario and examples</a>
                    </span>
                  </dt>
                  <dt>
                    <span class="section">
                      <a href="ch05.en.html#libnames">5.5.1.3. The library package name</a>
                    </span>
                  </dt>
                </dl>
              </dd>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#substvar">5.5.2. Substvar</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#binnmu">5.5.3. binNMU safe</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#changelog">5.6. debian/changelog</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#copyright">5.7. debian/copyright</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#patches">5.8. debian/patches/*</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#dpkg-source-x">5.8.1. dpkg-source -x</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#quilt-dpkg">5.8.2. dquilt and dpkg-source</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#signing-key">5.9. debian/upstream/signing-key.asc</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#dfsg">5.10. debian/watch and DFSG</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#debianconf">5.11. Other debian/* Files</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#custom">5.12. Customization of the Debian packaging</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#vcs">5.13. Recording in VCS (standard)</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#alt-vcs">5.14. Recording in VCS (alternative)</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#build-noextra">5.15. Building package without extraneous contents</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#rules-clean">5.15.1. Fix by debian/rules clean</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#git-clean">5.15.2. Fix using VCS</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#extend-diff-ignore">5.15.3. Fix by extend-diff-ignore</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#tar-ignore">5.15.4. Fix by tar-ignore</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#build">5.16. Upstream build systems</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#autotools">5.16.1. Autotools</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#cmake">5.16.2. CMake</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#distutils">5.16.3. Python distutils</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#dbg">5.17. Debugging information</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#dbgsym">5.17.1. New -dbgsym package (Stretch 9.0 and after)</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#lib">5.18. Library package</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#symbols">5.18.1. Library symbols</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#lib-trans">5.18.2. Library transition</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#debconf">5.19. debconf</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#multiarch">5.20. Multiarch</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#_the_multiarch_library_path">5.20.1. The multiarch library path</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#_the_multiarch_header_file_path">5.20.2. The multiarch header file path</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="ch05.en.html#_the_multiarch_emphasis_role_strong_pc_emphasis_file_path">5.20.3. The multiarch <span class="strong"><strong>*.pc</strong></span> file path</a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="ch05.en.html#harden">5.21. Compiler hardening</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#ci">5.22. Continuous integration</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#bootstrap">5.23. Bootstrapping</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="ch05.en.html#bug">5.24. Bug reports</a>
            </span>
          </dt>
        </dl>
      </div>
      <p>A broad overview is presented here for the basic rules of Debian packaging focusing on the non-native Debian package in the “<span class="strong"><strong>3.0 (quilt)</strong></span>” format.</p>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top">
              <img alt="[Note]" src="images/note.png"/>
            </td>
            <th align="left">Note</th>
          </tr>
          <tr>
            <td align="left" valign="top">
              <p>Some details are intentionally skipped for clarity.  Please read the manpages of the <span class="strong"><strong>dpkg-source</strong></span>(1), <span class="strong"><strong>dpkg-buildpackage</strong></span>(1), <span class="strong"><strong>dpkg</strong></span>(1), <span class="strong"><strong>dpkg-deb</strong></span>(1), <span class="strong"><strong>deb</strong></span>(5), etc.</p>
            </td>
          </tr>
        </table>
      </div>
      <p>The Debian source package is a set of input files used to build the Debian binary package and is not a single file.</p>
      <p>The Debian binary package is a special archive file which holds a set of installable binary data with its associated information.</p>
      <p>A single Debian source package may generate multiple Debian binary packages defined in the <span class="strong"><strong>debian/control</strong></span> file.</p>
      <p>The non-native Debian package in the “<span class="strong"><strong>3.0 (quilt)</strong></span>” format is the most normal Debian source package format.</p>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top">
              <img alt="[Note]" src="images/note.png"/>
            </td>
            <th align="left">Note</th>
          </tr>
          <tr>
            <td align="left" valign="top">
              <p>There are many wrapper scripts.  Use them to streamline your workflow but make sure to understand the basics of their internals.</p>
            </td>
          </tr>
        </table>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="workflow"/>5.1. Packaging workflow</h2>
            </div>
          </div>
        </div>
        <p>The Debian packaging workflow to create a Debian binary package involves generating several specifically named files (see <a class="xref" href="ch05.en.html#name-version" title="5.2. Package name and version">Section 5.2, “Package name and version”</a>) as defined in the “Debian Policy Manual”.</p>
        <p>The oversimplified method for the Debian packaging workflow can be summarized in 5 steps as follows.</p>
        <div class="orderedlist">
          <ol class="orderedlist">
            <li class="listitem">
The upstream tarball is downloaded as the <span class="emphasis"><em>package-version</em></span><span class="strong"><strong>.tar.gz</strong></span> file.
</li>
            <li class="listitem">
The upstream tarball is untarred to create many files under the <span class="emphasis"><em>package-version</em></span><span class="strong"><strong>/</strong></span> directory.
</li>
            <li class="listitem">
              <p class="simpara">
The upstream tarball is copied (or symlinked) to the particular filename <span class="emphasis"><em>packagename_version</em></span><span class="strong"><strong>.orig.tar.gz</strong></span>.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
the character separating <span class="emphasis"><em>package</em></span> and <span class="emphasis"><em>version</em></span> is changed from <span class="strong"><strong>-</strong></span> (hyphen) to <span class="strong"><strong>_</strong></span> (underscore)
</li>
                  <li class="listitem">
<span class="strong"><strong>.orig</strong></span> is added in the file extension.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The Debian package specification files are added to the upstream source under the <span class="emphasis"><em>package-version</em></span><span class="strong"><strong>/debian/</strong></span> directory.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <p class="simpara">
Required specification files under the <span class="strong"><strong>debian/</strong></span> directory:
</p>
                    <div class="variablelist">
                      <dl class="variablelist">
                        <dt>
                          <span class="term">
<span class="strong"><strong>debian/rules</strong></span>
</span>
                        </dt>
                        <dd>
The executable script for building the Debian package (see <a class="xref" href="ch05.en.html#rules" title="5.4. debian/rules">Section 5.4, “debian/rules”</a>)
</dd>
                        <dt>
                          <span class="term">
<span class="strong"><strong>debian/control</strong></span>
</span>
                        </dt>
                        <dd>
The package configuration file containing the source package name, the source build dependencies, the binary package name, the binary dependencies, etc. (see <a class="xref" href="ch05.en.html#control" title="5.5. debian/control">Section 5.5, “debian/control”</a>)
</dd>
                        <dt>
                          <span class="term">
<span class="strong"><strong>debian/changelog</strong></span>
</span>
                        </dt>
                        <dd>
The Debian package history file defining the upstream package version and the Debian revision in its first line (see <a class="xref" href="ch05.en.html#changelog" title="5.6. debian/changelog">Section 5.6, “debian/changelog”</a>)
</dd>
                        <dt>
                          <span class="term">
<span class="strong"><strong>debian/copyright</strong></span>
</span>
                        </dt>
                        <dd>
The copyright and license summary (see <a class="xref" href="ch05.en.html#copyright" title="5.7. debian/copyright">Section 5.7, “debian/copyright”</a>)
</dd>
                      </dl>
                    </div>
                  </li>
                  <li class="listitem">
Optional specification files under the <span class="strong"><strong>debian/</strong></span>* (see <a class="xref" href="ch05.en.html#debianconf" title="5.11. Other debian/* Files">Section 5.11, “Other debian/* Files”</a>):
</li>
                  <li class="listitem">
                    <p class="simpara">
The <span class="strong"><strong>debmake</strong></span> command invoked in the <span class="emphasis"><em>package-version/</em></span> directory provides the initial set of these template configuration files.
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
Required specification files are generated even with the <span class="strong"><strong>-x0</strong></span> option.
</li>
                        <li class="listitem">
The <span class="strong"><strong>debmake</strong></span> command does not overwrite any existing configuration files.
</li>
                      </ul>
                    </div>
                  </li>
                  <li class="listitem">
These files must be manually edited to their perfection according to the “Debian Policy Manual” and “Debian Developer’s Reference”.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>dpkg-buildpackage</strong></span> command (usually from its wrapper <span class="strong"><strong>debuild</strong></span> or <span class="strong"><strong>pdebuild</strong></span>) is invoked in the <span class="emphasis"><em>package-version/</em></span> directory to make the Debian source and binary packages by invoking the <span class="strong"><strong>debian/rules</strong></span> script.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
The current directory is set as: <span class="strong"><strong>$(CURDIR)=</strong></span><span class="emphasis"><em>/path/to/package-version/</em></span>
</li>
                  <li class="listitem">
                    <p class="simpara">
Create the Debian source package in the “<span class="strong"><strong>3.0 (quilt)</strong></span>” format using <span class="strong"><strong>dpkg-source</strong></span>(1)
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
<span class="emphasis"><em>package_version</em></span>.<span class="strong"><strong>orig.tar.gz</strong></span> (copy or symlink of <span class="emphasis"><em>package-version</em></span>.<span class="strong"><strong>tar.gz</strong></span>)
</li>
                        <li class="listitem">
<span class="emphasis"><em>package_version-revision</em></span>.<span class="strong"><strong>debian.tar.xz</strong></span> (tarball of <span class="emphasis"><em>package-version</em></span>/<span class="strong"><strong>debian/</strong></span>*)
</li>
                        <li class="listitem">
<span class="emphasis"><em>package_version-revision</em></span>.<span class="strong"><strong>dsc</strong></span>
</li>
                      </ul>
                    </div>
                  </li>
                  <li class="listitem">
                    <p class="simpara">
Build the source using “<span class="strong"><strong>debian/rules build</strong></span>” into <span class="strong"><strong>$(DESTDIR)</strong></span>
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
<span class="strong"><strong>DESTDIR=debian</strong></span>/<span class="emphasis"><em>binarypackage/</em></span> (single binary package)
</li>
                        <li class="listitem">
<span class="strong"><strong>DESTDIR=debian/tmp/</strong></span> (multi binary package)
</li>
                      </ul>
                    </div>
                  </li>
                  <li class="listitem">
                    <p class="simpara">
Create the Debian binary package using <span class="strong"><strong>dpkg-deb</strong></span>(1), <span class="strong"><strong>dpkg-genbuildinfo</strong></span>(1), and <span class="strong"><strong>dpkg-genchanges</strong></span>(1).
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
<span class="emphasis"><em>binarypackage_version-revision_arch</em></span>.<span class="strong"><strong>deb</strong></span>
</li>
                        <li class="listitem">
… (There may be multiple Debian binary package files.)
</li>
                        <li class="listitem">
<span class="emphasis"><em>package_version-revision_arch</em></span>.<span class="strong"><strong>changes</strong></span>
</li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
Check the quality of the Debian package with the <span class="strong"><strong>lintian</strong></span> command. (recommended)
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <p class="simpara">
Follow the rejection guidelines from <a class="ulink" href="https://ftp-master.debian.org/">ftp-master</a>.
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
<a class="ulink" href="https://ftp-master.debian.org/REJECT-FAQ.html">REJECT-FAQ</a>
</li>
                        <li class="listitem">
<a class="ulink" href="https://ftp-master.debian.org/NEW-checklist.html">NEW checklist</a>
</li>
                        <li class="listitem">
<a class="ulink" href="https://ftp-master.debian.org/#lintianrejects">Lintian Autorejects</a> (<a class="ulink" href="https://ftp-master.debian.org/static/lintian.tags">lintian tag list</a>)
</li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
Sign the <span class="emphasis"><em>package_version-revision</em></span>.<span class="strong"><strong>dsc</strong></span> and <span class="emphasis"><em>package_version-revision_arch</em></span>.<span class="strong"><strong>changes</strong></span> files with the <span class="strong"><strong>debsign</strong></span> command using your private GPG key.
</li>
            <li class="listitem">
Upload the set of the Debian source and binary package files with the <span class="strong"><strong>dput</strong></span> command to the Debian archive.
</li>
          </ol>
        </div>
        <p>Here, please replace each part of the filename as:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
the <span class="emphasis"><em>package</em></span> part with the Debian source package name
</li>
            <li class="listitem">
the <span class="emphasis"><em>binarypackage</em></span> part with the Debian binary package name
</li>
            <li class="listitem">
the <span class="emphasis"><em>version</em></span> part with the upstream version
</li>
            <li class="listitem">
the <span class="emphasis"><em>revision</em></span> part with the Debian revision
</li>
            <li class="listitem">
the <span class="emphasis"><em>arch</em></span> part with the package architecture
</li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Many patch management and VCS usage strategies for the Debian packaging are practiced.  You don’t need to use all of them.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>There is very extensive documentation in <a class="ulink" href="https://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html">Chapter 6. Best Packaging Practices</a> in the “Debian Developer’s Reference”.  Please read it.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="debhelper"/>5.1.1. The <span class="strong"><strong>debhelper</strong></span> package</h3>
              </div>
            </div>
          </div>
          <p>Although a Debian package can be made by writing a <span class="strong"><strong>debian/rules</strong></span> script without using the <span class="strong"><strong>debhelper</strong></span> package, it is impractical to do so.  There are too many modern “Policy” required features to be addressed, such as application of the proper file permissions, use of the proper architecture dependent library installation path, insertion of the installation hook scripts, generation of the debug symbol package, generation of package dependency information, generation of the package information files, application of the proper timestamp for reproducible build, etc.</p>
          <p><span class="strong"><strong>Debhelper</strong></span> package provides a set of useful scripts in order to simplify Debian’s packaging workflow and reduce the burden of package maintainers. When properly used, they will help packagers handle and implement “Policy” required features automatically.</p>
          <p>The modern Debian packaging workflow can be organized into a simple modular workflow by:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
using the <span class="strong"><strong>dh</strong></span> command to invoke many utility scripts automatically from the <span class="strong"><strong>debhelper</strong></span> package, and
</li>
              <li class="listitem">
configuring their behavior with declarative configuration files in the <span class="strong"><strong>debian/</strong></span> directory.
</li>
            </ul>
          </div>
          <p>You should almost always use <span class="strong"><strong>debhelper</strong></span> as your package’s build dependency. This document also assumes that you are using a fairly contemporary version of <span class="strong"><strong>debhelper</strong></span> to handle packaging works in the following contents.</p>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="name-version"/>5.2. Package name and version</h2>
            </div>
          </div>
        </div>
        <p>If the upstream source comes as <span class="strong"><strong>hello-0.9.12.tar.gz</strong></span>, you can take <span class="strong"><strong>hello</strong></span> as the upstream source package name and <span class="strong"><strong>0.9.12</strong></span> as the upstream version.</p>
        <p><span class="strong"><strong>debmake</strong></span> is meant to provide template files for the package maintainer to work on.  Comment lines started by <span class="strong"><strong>#</strong></span> contain the tutorial text.  You must remove or edit such comment lines before uploading to the Debian archive.</p>
        <p>The license extraction and assignment process involves a lot of heuristics; it may fail in some cases.  It is highly recommended to use other tools such as <span class="strong"><strong>licensecheck</strong></span> from the <span class="strong"><strong>devscripts</strong></span> package in conjunction with <span class="strong"><strong>debmake</strong></span>.</p>
        <p>There  are some limitations for what characters may be used as a part of the Debian package.  The most notable limitation is the prohibition of uppercase letters in the package name.  Here is a summary as a set of regular expressions:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
Upstream package name (<span class="strong"><strong>-p</strong></span>): [-+.a-z0-9]{2,}
</li>
            <li class="listitem">
Binary package name (<span class="strong"><strong>-b</strong></span>): [-+.a-z0-9]{2,}
</li>
            <li class="listitem">
Upstream version (<span class="strong"><strong>-u</strong></span>): [0-9][-+.:~a-z0-9A-Z]*
</li>
            <li class="listitem">
Debian revision (<span class="strong"><strong>-r</strong></span>): [0-9][+.~a-z0-9A-Z]*
</li>
          </ul>
        </div>
        <p>See the exact definition in <a class="ulink" href="https://www.debian.org/doc/debian-policy/#document-ch-controlfields">Chapter 5 - Control files and their fields</a> in the “Debian Policy Manual”.</p>
        <p><span class="strong"><strong>debmake</strong></span> assumes relatively simple packaging cases.  So all programs related to the interpreter are assumed to be "<span class="strong"><strong>Architecture: all</strong></span>".  This is not always true.</p>
        <p>You must adjust the package name and upstream version accordingly for the Debian packaging.</p>
        <p>In order to manage the package name and version information effectively under popular tools such as the <span class="strong"><strong>aptitude</strong></span> command, it is a good idea to keep the length of package name to be equal or less than 30 characters; and the total length of version and revision to be equal or less than 14 characters. <a href="#ftn.idm1578" class="footnote" id="idm1578"><sup class="footnote">[10]</sup></a></p>
        <p>In order to avoid name collisions, the user visible binary package name should not be chosen from any generic words.</p>
        <p>If upstream does not use a normal versioning scheme such as <span class="strong"><strong>2.30.32</strong></span> but uses some kind of date such as <span class="strong"><strong>11Apr29</strong></span>, a random codename string, or a VCS hash value as part of the version, make sure to remove them from the upstream version. Such information can be recorded in the <span class="strong"><strong>debian/changelog</strong></span> file. If you need to invent a version string, use the <span class="strong"><strong>YYYYMMDD</strong></span> format such as <span class="strong"><strong>20110429</strong></span> as upstream version. This ensures that the <span class="strong"><strong>dpkg</strong></span> command interprets later versions correctly as upgrades. If you need to ensure a smooth transition to a normal version scheme such as <span class="strong"><strong>0.1</strong></span> in the future, use the <span class="strong"><strong>0~YYMMDD</strong></span> format such as <span class="strong"><strong>0~110429</strong></span> as upstream version, instead.</p>
        <p>Version strings can be compared using the <span class="strong"><strong>dpkg</strong></span> command as follows.</p>
        <pre class="screen">$ dpkg --compare-versions ver1 op ver2</pre>
        <p>The version comparison rule can be summarized as:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
Strings are compared from the head to the tail.
</li>
            <li class="listitem">
Letters are larger than digits.
</li>
            <li class="listitem">
Numbers are compared as integers.
</li>
            <li class="listitem">
Letters are compared in ASCII code order.
</li>
          </ul>
        </div>
        <p>There are special rules for period (<span class="strong"><strong>.</strong></span>), plus (<span class="strong"><strong>+</strong></span>), and tilde (<span class="strong"><strong>~</strong></span>) characters, as follows.</p>
        <pre class="screen">0.0 &lt; 0.5 &lt; 0.10 &lt; 0.99 &lt; 1 &lt; 1.0~rc1 &lt; 1.0 &lt; 1.0+b1 &lt; 1.0+nmu1 &lt; 1.1 &lt; 2.0</pre>
        <p>One tricky case occurs when the upstream releases <span class="strong"><strong>hello-0.9.12-ReleaseCandidate-99.tar.gz</strong></span> as the pre-release of <span class="strong"><strong>hello-0.9.12.tar.gz</strong></span>. You can ensure the Debian package upgrade to work properly by renaming the upstream source to <span class="strong"><strong>hello-0.9.12~rc99.tar.gz</strong></span>.</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="native"/>5.3. Native Debian package</h2>
            </div>
          </div>
        </div>
        <p>The non-native Debian package in the “<span class="strong"><strong>3.0 (quilt)</strong></span>” format is the most normal Debian source package format.  The <span class="strong"><strong>debian/source/format</strong></span> file should have “<span class="strong"><strong>3.0 (quilt)</strong></span>” in it as described in <span class="strong"><strong>dpkg-source</strong></span>(1).  The above workflow and the following packaging examples always use this format.</p>
        <p>A native Debian package is the rare Debian binary package format.  It may be used only when the package is useful and valuable only for Debian.  Thus, its use is generally discouraged.</p>
        <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Caution">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Caution]" src="images/caution.png"/>
              </td>
              <th align="left">Caution</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>A native Debian package is often accidentally built when its upstream tarball is not accessible from the <span class="strong"><strong>dpkg-buildpackage</strong></span> command with its correct name <span class="emphasis"><em>package_version</em></span>.<span class="strong"><strong>orig.tar.gz</strong></span> .  This is a typical newbie mistake caused by making a symlink name with “<span class="strong"><strong>-</strong></span>” instead of the correct one with “<span class="strong"><strong>_</strong></span>”.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>A native Debian package has no separation between the <span class="strong"><strong>upstream code</strong></span> and the <span class="strong"><strong>Debian changes</strong></span> and consists only of the following:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<span class="emphasis"><em>package_version</em></span>.<span class="strong"><strong>tar.gz</strong></span> (copy or symlink of <span class="emphasis"><em>package-version</em></span>.<span class="strong"><strong>tar.gz</strong></span> with <span class="strong"><strong>debian/</strong></span>* files.)
</li>
            <li class="listitem">
<span class="emphasis"><em>package_version</em></span>.<span class="strong"><strong>dsc</strong></span>
</li>
          </ul>
        </div>
        <p>If you need to create a native Debian package, create it in the “<span class="strong"><strong>3.0 (native)</strong></span>” format using <span class="strong"><strong>dpkg-source</strong></span>(1).</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Some people promote packaging even programs that have been written only for Debian in the non-native package format.  The required tarball without <span class="strong"><strong>debian/</strong></span>* files needs to be manually generated in advance before the standard workflow in <a class="xref" href="ch05.en.html#workflow" title="5.1. Packaging workflow">Section 5.1, “Packaging workflow”</a>. <a href="#ftn.idm1650" class="footnote" id="idm1650"><sup class="footnote">[11]</sup></a>  They claim that the use of non-native package format eases communication with the downstream distributions.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>There is no need to create the tarball in advance if the native package format is used.  The native Debian package can be created by setting the <span class="strong"><strong>debian/source/format</strong></span> file to “<span class="strong"><strong>3.0 (native)</strong></span>”, setting the <span class="strong"><strong>debian/changelog</strong></span> file to have the version without the Debian revision (<span class="strong"><strong>1.0</strong></span> instead of <span class="strong"><strong>1.0-1</strong></span>), and invoking the “<span class="strong"><strong>dpkg-source -b .</strong></span>” command within the source tree.  The tarball containing the source is generated by this.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="rules"/>5.4. debian/rules</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>debian/rules</strong></span> script is the executable script to build the Debian package.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>debian/rules</strong></span> script re-targets the upstream build system (see <a class="xref" href="ch05.en.html#build" title="5.16. Upstream build systems">Section 5.16, “Upstream build systems”</a>) to install files in the <span class="strong"><strong>$(DESTDIR)</strong></span> and creates the archive file of the generated files as the <span class="strong"><strong>deb</strong></span> file.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
The <span class="strong"><strong>deb</strong></span> file is used for the binary distribution and installed to the system using the <span class="strong"><strong>dpkg</strong></span> command.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
The <span class="strong"><strong>dh</strong></span> command is normally used as the front-end to the build system inside the <span class="strong"><strong>debian/rules</strong></span> script.
</li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>$(DESTDIR)</strong></span> path depends on the build type.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
<span class="strong"><strong>$(DESTDIR)=debian/</strong></span><span class="emphasis"><em>binarypackage</em></span>  (single binary package)
</li>
                  <li class="listitem">
<span class="strong"><strong>$(DESTDIR)=debian/tmp</strong></span>  (multiple binary package)
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="dh"/>5.4.1. dh</h3>
              </div>
            </div>
          </div>
          <p>The <span class="strong"><strong>dh</strong></span> command from the <span class="strong"><strong>debhelper</strong></span> package with help from its associated packages functions as the wrapper to the typical upstream build systems and offers us uniform access to them by supporting all the Debian policy stipulated targets of the <span class="strong"><strong>debian/rules</strong></span> file.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<span class="strong"><strong>dh clean</strong></span> : clean files in the source tree.
</li>
              <li class="listitem">
<span class="strong"><strong>dh build</strong></span> : build the source tree
</li>
              <li class="listitem">
<span class="strong"><strong>dh build-arch</strong></span> : build the source tree for architecture dependent packages
</li>
              <li class="listitem">
<span class="strong"><strong>dh build-indep</strong></span> : build the source tree for architecture independent packages
</li>
              <li class="listitem">
<span class="strong"><strong>dh install</strong></span> : install the binary files to <span class="strong"><strong>$(DESTDIR)</strong></span>
</li>
              <li class="listitem">
<span class="strong"><strong>dh install-arch</strong></span> : install the binary files to <span class="strong"><strong>$(DESTDIR)</strong></span> for architecture dependent packages
</li>
              <li class="listitem">
<span class="strong"><strong>dh install-indep</strong></span> : install the binary files to <span class="strong"><strong>$(DESTDIR)</strong></span> for architecture independent packages
</li>
              <li class="listitem">
<span class="strong"><strong>dh binary</strong></span> : generate the <span class="strong"><strong>deb</strong></span> file
</li>
              <li class="listitem">
<span class="strong"><strong>dh binary-arch</strong></span> : generate the <span class="strong"><strong>deb</strong></span> file for architecture dependent packages
</li>
              <li class="listitem">
<span class="strong"><strong>dh binary-indep</strong></span> : generate the <span class="strong"><strong>deb</strong></span> file for architecture independent packages
</li>
            </ul>
          </div>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>For <span class="strong"><strong>debhelper</strong></span> “compat &gt;= 9”, the <span class="strong"><strong>dh</strong></span> command exports compiler flags (<span class="strong"><strong>CFLAGS</strong></span>, <span class="strong"><strong>CXXFLAGS</strong></span>, <span class="strong"><strong>FFLAGS</strong></span>, <span class="strong"><strong>CPPFLAGS</strong></span> and <span class="strong"><strong>LDFLAGS</strong></span>) with values as returned by <span class="strong"><strong>dpkg-buildflags</strong></span> if they are not set previously.  (The <span class="strong"><strong>dh</strong></span> command calls <span class="strong"><strong>set_buildflags</strong></span> defined in the <span class="strong"><strong>Debian::Debhelper::Dh_Lib</strong></span> module.)</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="simplerules"/>5.4.2. Simple debian/rules</h3>
              </div>
            </div>
          </div>
          <p>Thanks to this abstraction of the <span class="strong"><strong>dh</strong></span> command <a href="#ftn.idm1753" class="footnote" id="idm1753"><sup class="footnote">[12]</sup></a>, the Debian policy compliant <span class="strong"><strong>debian/rules</strong></span> file supporting all the required targets can be written as simple as <a href="#ftn.idm1758" class="footnote" id="idm1758"><sup class="footnote">[13]</sup></a>:</p>
          <p><strong>Simple <span class="strong"><strong>debian/rules</strong></span>: </strong>
</p>
          <pre class="screen">#!/usr/bin/make -f
#export DH_VERBOSE = 1

%:
        dh $@</pre>
          <p>
</p>
          <p>Essentially, this <span class="strong"><strong>dh</strong></span> command functions as the sequencer to call all required <span class="strong"><strong>dh_</strong></span>* commands at the right moment.</p>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>The <span class="strong"><strong>debmake</strong></span> command sets the <span class="strong"><strong>debian/control</strong></span> file with “<span class="strong"><strong>Build-Depends: debhelper (&gt;=9)</strong></span>” and the <span class="strong"><strong>debian/compat</strong></span> file with “<span class="strong"><strong>9</strong></span>”.</p>
                </td>
              </tr>
            </table>
          </div>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>Setting “<span class="strong"><strong>export DH_VERBOSE = 1</strong></span>” outputs every command that modifies files on the build system.  Also it enables verbose build logs for some build systems.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="customrules"/>5.4.3. Customized debian/rules</h3>
              </div>
            </div>
          </div>
          <p>Flexible customization of the <span class="strong"><strong>debian/rules</strong></span> script is realized by adding appropriate <span class="strong"><strong>override_dh_</strong></span>* targets and their rules.</p>
          <p>Whenever some special operation is required for a certain <span class="strong"><strong>dh_</strong></span><span class="emphasis"><em>foo</em></span> command invoked by the <span class="strong"><strong>dh</strong></span> command, any automatic execution of it can be overridden by adding the makefile target <span class="strong"><strong>override_dh_</strong></span><span class="emphasis"><em>foo</em></span> in the <span class="strong"><strong>debian/rules</strong></span> file.</p>
          <p>The build process may be customized via the upstream provided interface such as arguments to the standard source build system commands, such as:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<span class="strong"><strong>configure</strong></span>,
</li>
              <li class="listitem">
<span class="strong"><strong>Makefile</strong></span>,
</li>
              <li class="listitem">
<span class="strong"><strong>setup.py</strong></span>, or
</li>
              <li class="listitem">
<span class="strong"><strong>Build.PL</strong></span>.
</li>
            </ul>
          </div>
          <p>If this is the case, you should add the <span class="strong"><strong>override_dh_auto_build</strong></span> target and executing the “<span class="strong"><strong>dh_auto_build --</strong></span> <span class="emphasis"><em>arguments”</em></span> command.  This ensures passing <span class="emphasis"><em>arguments</em></span> to the such build system after the default parameters that <span class="strong"><strong>dh_auto_build</strong></span> usually passes.</p>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>Please try not to execute the above build system commands directly if they are supported by the <span class="strong"><strong>dh_auto_build</strong></span> command.</p>
                </td>
              </tr>
            </table>
          </div>
          <p>The <span class="strong"><strong>debmake</strong></span> command creates the initial template file taking advantage of the above simple <span class="strong"><strong>debian/rules</strong></span> file example while adding some extra customizations for package hardening, etc. You need to know how underlying build systems work under the hood (see <a class="xref" href="ch05.en.html#build" title="5.16. Upstream build systems">Section 5.16, “Upstream build systems”</a>) to address their irregularities using package customization.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
See <a class="xref" href="ch04.en.html#step-maintainer" title="4.6. Step 3: Modification to the template files">Section 4.6, “Step 3: Modification to the template files”</a> for basic customization of the template <span class="strong"><strong>debian/rules</strong></span> file generated by the <span class="strong"><strong>debmake</strong></span> command.
</li>
              <li class="listitem">
See <a class="xref" href="ch05.en.html#multiarch" title="5.20. Multiarch">Section 5.20, “Multiarch”</a> for multiarch customization.
</li>
              <li class="listitem">
See <a class="xref" href="ch05.en.html#harden" title="5.21. Compiler hardening">Section 5.21, “Compiler hardening”</a> for hardening customization.
</li>
            </ul>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="variablesrules"/>5.4.4. Variables for debian/rules</h3>
              </div>
            </div>
          </div>
          <p>Some variable definitions useful for customizing <span class="strong"><strong>debian/rules</strong></span> can be found in files under <span class="strong"><strong>/usr/share/dpkg/</strong></span>.  Notably:</p>
          <div class="variablelist">
            <dl class="variablelist">
              <dt>
                <span class="term">
<span class="strong"><strong>pkg-info.mk</strong></span>
</span>
              </dt>
              <dd>
  <span class="strong"><strong>DEB_SOURCE</strong></span>, <span class="strong"><strong>DEB_VERSION</strong></span>, <span class="strong"><strong>DEB_VERSION_EPOCH_UPSTREAM</strong></span>, <span class="strong"><strong>DEB_VERSION_UPSTREAM_REVISION</strong></span>, <span class="strong"><strong>DEB_VERSION_UPSTREAM</strong></span>, and <span class="strong"><strong>DEB_DISTRIBUTION</strong></span> variables.
 
  These are useful for backport support etc..
</dd>
              <dt>
                <span class="term">
<span class="strong"><strong>vendor.mk</strong></span>
</span>
              </dt>
              <dd>
  <span class="strong"><strong>DEB_VENDOR</strong></span> and <span class="strong"><strong>DEB_PARENT_VENDOR</strong></span> variables; and <span class="strong"><strong>dpkg_vendor_derives_from</strong></span> macro.
 
  These are useful for vendor support (Debian, Ubuntu, …).
</dd>
              <dt>
                <span class="term">
<span class="strong"><strong>architecture.mk</strong></span>
</span>
              </dt>
              <dd>
  Set <span class="strong"><strong>DEB_HOST_</strong></span>* and  <span class="strong"><strong>DEB_BUILD_</strong></span>* variables.
 
  An alternative method of retrieving those variables is to invoke <span class="strong"><strong>dpkg-architecture</strong></span> directly and query the value of a single variable. With explicit invocation of <span class="strong"><strong>dpkg-architecture</strong></span> to retrieve necessary variables, there is no need to include <span class="strong"><strong>architecture.mk</strong></span> in <span class="strong"><strong>debian/rules</strong></span>, which would import all architecture-related variables.
</dd>
              <dt>
                <span class="term">
<span class="strong"><strong>buildflags.mk</strong></span>
</span>
              </dt>
              <dd>
  Set <span class="strong"><strong>CFLAGS</strong></span>, <span class="strong"><strong>CPPFLAGS</strong></span>, <span class="strong"><strong>CXXFLAGS</strong></span>, <span class="strong"><strong>OBJCFLAGS</strong></span>, <span class="strong"><strong>OBJCXXFLAGS</strong></span>, <span class="strong"><strong>GCJFLAGS</strong></span>, <span class="strong"><strong>FFLAGS</strong></span>, <span class="strong"><strong>FCFLAGS</strong></span>, and <span class="strong"><strong>LDFLAGS</strong></span> build flags.
</dd>
            </dl>
          </div>
          <p>If you wish to use some of these useful variables in <span class="strong"><strong>debian/rules</strong></span>, copy relevant code to <span class="strong"><strong>debian/rules</strong></span> or write a simpler alternative in it.  Please keep <span class="strong"><strong>debian/rules</strong></span> simple.</p>
          <p>For example, you can add an extra option to <span class="strong"><strong>CONFIGURE_FLAGS</strong></span> for <span class="strong"><strong>linux-any</strong></span> target architectures by adding the followings to <span class="strong"><strong>debian/rules</strong></span>:</p>
          <pre class="screen">DEB_HOST_ARCH_OS ?= $(shell dpkg-architecture -qDEB_HOST_ARCH_OS)
 ...
ifeq ($(DEB_HOST_ARCH_OS),linux)
CONFIGURE_FLAGS += --enable-wayland
endif</pre>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>It was useful to include <span class="strong"><strong>buildflags.mk</strong></span> in <span class="strong"><strong>debian/rules</strong></span> to set the build flags such as <span class="strong"><strong>CPPFLAGS</strong></span>, <span class="strong"><strong>CFLAGS</strong></span>, <span class="strong"><strong>LDFLAGS</strong></span>, etc. properly while honoring <span class="strong"><strong>DEB_CFLAGS_MAINT_APPEND</strong></span>, <span class="strong"><strong>DEB_BUILD_MAINT_OPTIONS</strong></span>, etc. for the <span class="strong"><strong>debhelper</strong></span> “compat &lt;= 8”.  Now you should use the <span class="strong"><strong>debhelper</strong></span> “compat &gt;= 9”, should not include <span class="strong"><strong>buildflags.mk</strong></span> without specific reasons, and should let the <span class="strong"><strong>dh</strong></span> command set these build flags.</p>
                </td>
              </tr>
            </table>
          </div>
          <p>See <a class="xref" href="ch05.en.html#multiarch" title="5.20. Multiarch">Section 5.20, “Multiarch”</a>, <span class="strong"><strong>dpkg-architecture</strong></span>(1) and <span class="strong"><strong>dpkg-buildflags</strong></span>(1).</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="reproducible"/>5.4.5. Reproducible build</h3>
              </div>
            </div>
          </div>
          <p>Here are some recommendations to attain a reproducible build result.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
Don’t embed the timestamp based on the system time.
</li>
              <li class="listitem">
Use “<span class="strong"><strong>dh $@</strong></span>” in the <span class="strong"><strong>debian/rules</strong></span> to access the latest <span class="strong"><strong>debhelper</strong></span> features.
</li>
              <li class="listitem">
Export the build environment as “<span class="strong"><strong>LC_ALL=C.UTF-8</strong></span>” (see <a class="xref" href="ch07.en.html#utf-8-build" title="7.15. Build under UTF-8">Section 7.15, “Build under UTF-8”</a>).
</li>
              <li class="listitem">
Set the timestamp used in the upstream source from the value of the debhelper-provided environment variable <span class="strong"><strong>$SOURCE_DATE_EPOCH</strong></span>.
</li>
              <li class="listitem">
                <p class="simpara">
Read more at <a class="ulink" href="https://wiki.debian.org/ReproducibleBuilds">ReproducibleBuilds</a>.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/ReproducibleBuilds/Howto">ReproducibleBuilds Howto</a>.
</li>
                    <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/ReproducibleBuilds/TimestampsProposal">ReproducibleBuilds TimestampsProposal</a>.
</li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
          <p>The control file <span class="emphasis"><em>source-name_source-version_arch</em></span><span class="strong"><strong>.buildinfo</strong></span> generated by <span class="strong"><strong>dpkg-genbuildinfo</strong></span>(1) records the build environment. See <span class="strong"><strong>deb-buildinfo</strong></span>(5)</p>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="control"/>5.5. debian/control</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>debian/control</strong></span> file consists of blocks of meta data separated by a blank line.  Each block of meta data defines the following in this order:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
meta data for the Debian source package
</li>
            <li class="listitem">
meta data for the Debian binary packages
</li>
          </ul>
        </div>
        <p>See <a class="ulink" href="https://www.debian.org/doc/debian-policy/#document-ch-controlfields">Chapter 5 - Control files and their fields</a> of the “Debian Policy Manual” for the definition of each meta data.</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="split"/>5.5.1. Split of a Debian binary package</h3>
              </div>
            </div>
          </div>
          <p>For well behaving build systems, the split of a Debian binary package into small ones can be realized as follows.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
Create binary package entries for all binary packages in the <span class="strong"><strong>debian/control</strong></span> file.
</li>
              <li class="listitem">
List all file paths (relative to <span class="strong"><strong>debian/tmp</strong></span>) in the corresponding <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.install</strong></span> files.
</li>
            </ul>
          </div>
          <p>Please check examples in this guide:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<a class="xref" href="ch08.en.html#autotools-multi" title="8.11. Autotools (multi-binary package)">Section 8.11, “Autotools (multi-binary package)”</a> (Autotools based)
</li>
              <li class="listitem">
<a class="xref" href="ch08.en.html#cmake-multi" title="8.12. CMake (multi-binary package)">Section 8.12, “CMake (multi-binary package)”</a> (CMake based)
</li>
            </ul>
          </div>
          <div class="section">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="boption"/>5.5.1.1. debmake -b</h4>
                </div>
              </div>
            </div>
            <p>The <span class="strong"><strong>debmake</strong></span> command with the <span class="strong"><strong>-b</strong></span> option provides an intuitive and flexible method to create the initial template <span class="strong"><strong>debian/control</strong></span> file defining the split of the Debian binary packages with following stanzas:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
<span class="strong"><strong>Package:</strong></span>
</li>
                <li class="listitem">
<span class="strong"><strong>Architecture:</strong></span>
</li>
                <li class="listitem">
<span class="strong"><strong>Multi-Arch:</strong></span>
</li>
                <li class="listitem">
<span class="strong"><strong>Depends:</strong></span>
</li>
                <li class="listitem">
<span class="strong"><strong>Pre-Depends:</strong></span>
</li>
              </ul>
            </div>
            <p>The <span class="strong"><strong>debmake</strong></span> command also sets an appropriate set of substvars used in each pertinent dependency stanza.</p>
            <p>Let’s quote the pertinent part from the <span class="strong"><strong>debmake</strong></span> manpage here.</p>
            <div class="variablelist">
              <dl class="variablelist">
                <dt>
                  <span class="term">
<span class="strong"><strong>-b</strong></span> "<span class="emphasis"><em>binarypackage[:type],…</em></span>", <span class="strong"><strong>--binaryspec</strong></span> "<span class="emphasis"><em>binarypackage[:type],…</em></span>"
</span>
                </dt>
                <dd>
                  <p class="simpara">
set the binary package specs by a comma separated list of <span class="emphasis"><em>binarypackage:type</em></span> pairs, e.g., in the full form “<span class="strong"><strong>foo:bin,foo-doc:doc,libfoo1:lib,libfoo-dev:dev</strong></span>” or in the short form, “<span class="strong"><strong>-doc,libfoo1,libfoo-dev</strong></span>”.
</p>
                  <p class="simpara">Here, <span class="emphasis"><em>binarypackage</em></span> is the binary package name, and the optional <span class="emphasis"><em>type</em></span> is chosen from the following <span class="emphasis"><em>type</em></span> values:</p>
                  <div class="itemizedlist">
                    <ul class="itemizedlist">
                      <li class="listitem">
<span class="strong"><strong>bin</strong></span>: C/C++ compiled ELF binary code package (any, foreign) (default, alias: <span class="strong"><strong>""</strong></span>, i.e., <span class="emphasis"><em>null-string</em></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>data</strong></span>: Data (fonts, graphics, …) package (all, foreign) (alias: <span class="strong"><strong>da</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>dev</strong></span>: Library development package (any, same) (alias: <span class="strong"><strong>de</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>doc</strong></span>: Documentation package (all, foreign) (alias: <span class="strong"><strong>do</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>lib</strong></span>: Library package (any, same) (alias: <span class="strong"><strong>l</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>perl</strong></span>: Perl script package (all, foreign) (alias: <span class="strong"><strong>pl</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>python</strong></span>: Python script package (all, foreign) (alias: <span class="strong"><strong>py</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>python3</strong></span>: Python3 script package (all, foreign) (alias: <span class="strong"><strong>py3</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>ruby</strong></span>: Ruby script package (all, foreign) (alias: <span class="strong"><strong>rb</strong></span>)
</li>
                      <li class="listitem">
<span class="strong"><strong>script</strong></span>: Shell script package (all, foreign) (alias: <span class="strong"><strong>sh</strong></span>)
</li>
                    </ul>
                  </div>
                  <p class="simpara">The pair values in the parentheses, such as (any, foreign), are the <span class="strong"><strong>Architecture</strong></span> and <span class="strong"><strong>Multi-Arch</strong></span> stanza values set in the <span class="strong"><strong>debian/control</strong></span> file.</p>
                  <p class="simpara">In many cases, the <span class="strong"><strong>debmake</strong></span> command makes good guesses for <span class="emphasis"><em>type</em></span> from <span class="emphasis"><em>binarypackage</em></span>.  If <span class="emphasis"><em>type</em></span> is not obvious, <span class="emphasis"><em>type</em></span> is set to <span class="strong"><strong>bin</strong></span>.  For example, <span class="strong"><strong>libfoo</strong></span> sets <span class="emphasis"><em>type</em></span> to <span class="strong"><strong>lib</strong></span>, and <span class="strong"><strong>font-bar</strong></span> sets <span class="emphasis"><em>type</em></span> to <span class="strong"><strong>data</strong></span>, …</p>
                  <p class="simpara">If the source tree contents do not match settings for <span class="emphasis"><em>type</em></span>, the <span class="strong"><strong>debmake</strong></span> command warns you.</p>
                </dd>
              </dl>
            </div>
          </div>
          <div class="section">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="package-split-example"/>5.5.1.2. Package split scenario and examples</h4>
                </div>
              </div>
            </div>
            <p>Here are some typical multiarch package split scenarios for the following upstream source examples using the <span class="strong"><strong>debmake</strong></span> command:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
a library source <span class="emphasis"><em>libfoo-1.0</em></span><span class="strong"><strong>.tar.gz</strong></span>
</li>
                <li class="listitem">
a tool source <span class="emphasis"><em>bar-1.0</em></span><span class="strong"><strong>.tar.gz</strong></span> written in a compiled language
</li>
                <li class="listitem">
a tool source <span class="emphasis"><em>baz-1.0</em></span><span class="strong"><strong>.tar.gz</strong></span> written in an interpreted language
</li>
              </ul>
            </div>
            <div class="informaltable">
              <table class="informaltable" border="1">
                <colgroup>
                  <col class="col_1"/>
                  <col class="col_2"/>
                  <col class="col_3"/>
                  <col class="col_4"/>
                  <col class="col_5"/>
                </colgroup>
                <thead>
                  <tr>
                    <th style="text-align: left" valign="top"><span class="emphasis"><em>binarypackage</em></span>   </th>
                    <th style="text-align: left" valign="top"><span class="emphasis"><em>type</em></span>   </th>
                    <th style="text-align: left" valign="top">
                      <span class="strong">
                        <strong>Architecture:</strong>
                      </span>
                    </th>
                    <th style="text-align: left" valign="top"><span class="strong"><strong>Multi-Arch:</strong></span>     </th>
                    <th style="text-align: left" valign="top">Package content</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>lib</strong>
                        </span>
                        <span class="emphasis">
                          <em>foo1</em>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>lib</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>any</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>same</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the shared library, co-installable</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>lib</strong>
                        </span>
                        <span class="emphasis">
                          <em>foo</em>
                        </span>
                        <span class="strong">
                          <strong>-dev</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>dev</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>any</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>same</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the shared library header files etc., co-installable</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>lib</strong>
                        </span>
                        <span class="emphasis">
                          <em>foo</em>
                        </span>
                        <span class="strong">
                          <strong>-tools</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>bin</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>any</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>foreign</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the run-time support programs, not co-installable</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>lib</strong>
                        </span>
                        <span class="emphasis">
                          <em>foo</em>
                        </span>
                        <span class="strong">
                          <strong>-doc</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>doc</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>all</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>foreign</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the shared library documentation files</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="emphasis">
                          <em>bar</em>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>bin</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>any</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>foreign</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the compiled program files, not co-installable</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="emphasis">
                          <em>bar</em>
                        </span>
                        <span class="strong">
                          <strong>-doc</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>doc</strong>
                        </span>
                        <sup>*</sup>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>all</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>foreign</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the documentation files for the program</p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="emphasis">
                          <em>baz</em>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>script</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>all</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>foreign</p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>the interpreted program files</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="section">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="libnames"/>5.5.1.3. The library package name</h4>
                </div>
              </div>
            </div>
            <p>Let’s consider that the upstream source tarball of the <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo</em></span> library is updated from <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo-7.0</em></span><span class="strong"><strong>.tar.gz</strong></span> to <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo-8.0</em></span><span class="strong"><strong>.tar.gz</strong></span> with a new SONAME major version which affects other packages.</p>
            <p>The binary library package must be renamed from <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7</em></span> to <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8</em></span> to keep the <span class="strong"><strong>unstable</strong></span> suite system working for all dependent packages after the upload of the package based on the <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo-8.0</em></span><span class="strong"><strong>.tar.gz</strong></span>.</p>
            <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
              <table border="0" summary="Warning">
                <tr>
                  <td rowspan="2" align="center" valign="top">
                    <img alt="[Warning]" src="images/warning.png"/>
                  </td>
                  <th align="left">Warning</th>
                </tr>
                <tr>
                  <td align="left" valign="top">
                    <p>If the binary library package isn’t renamed, many dependent packages in the <span class="strong"><strong>unstable</strong></span> suite become broken just after the library upload even if a binNMU upload is requested.  The binNMU may not happen immediately after the upload due to several reasons.</p>
                  </td>
                </tr>
              </table>
            </div>
            <p>The <span class="strong"><strong>-dev</strong></span> package must follow one of the following naming rules:</p>
            <div class="itemizedlist">
              <ul class="itemizedlist">
                <li class="listitem">
                  <p class="simpara">
Use the <span class="strong"><strong>unversioned -dev</strong></span> package name: <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo</em></span><span class="strong"><strong>-dev</strong></span>
</p>
                  <div class="itemizedlist">
                    <ul class="itemizedlist">
                      <li class="listitem">
This is the typical one for leaf library packages.
</li>
                      <li class="listitem">
                        <p class="simpara">
Only one version of the library source package is allowed in the archive.
</p>
                        <div class="itemizedlist">
                          <ul class="itemizedlist">
                            <li class="listitem">
The associated library package needs to be renamed from <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7</em></span> to <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8</em></span> to prevent dependency breakage in the <span class="strong"><strong>unstable</strong></span> archive during the library transition.
</li>
                          </ul>
                        </div>
                      </li>
                      <li class="listitem">
This approach should be used if the simple binNMU resolves the library dependency quickly for all affected packages. (<a class="ulink" href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a> change by dropping the deprecated <a class="ulink" href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> while keeping the active API unchanged.)
</li>
                      <li class="listitem">
This approach may still be a good idea if manual code updates, etc. can be coordinated and manageable within limited packages. (<a class="ulink" href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> change)
</li>
                    </ul>
                  </div>
                </li>
                <li class="listitem">
                  <p class="simpara">
Use the <span class="strong"><strong>versioned -dev</strong></span> package names: <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7</em></span><span class="strong"><strong>-dev</strong></span> and <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8</em></span><span class="strong"><strong>-dev</strong></span>
</p>
                  <div class="itemizedlist">
                    <ul class="itemizedlist">
                      <li class="listitem">
This is typical for many major library packages.
</li>
                      <li class="listitem">
                        <p class="simpara">
Two versions of the library source packages are allowed simultaneously in the archive.
</p>
                        <div class="itemizedlist">
                          <ul class="itemizedlist">
                            <li class="listitem">
Make all dependent packages depend on <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo</em></span><span class="strong"><strong>-dev</strong></span>.
</li>
                            <li class="listitem">
Make both <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7</em></span><span class="strong"><strong>-dev</strong></span> and <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8</em></span><span class="strong"><strong>-dev</strong></span> provide <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo</em></span><span class="strong"><strong>-dev</strong></span>.
</li>
                            <li class="listitem">
The source package needs to be renamed as <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7-7.0</em></span><span class="strong"><strong>.tar.gz</strong></span> and <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8-8.0</em></span><span class="strong"><strong>.tar.gz</strong></span> respectively from <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo-?.0</em></span><span class="strong"><strong>.tar.gz</strong></span>.
</li>
                            <li class="listitem">
The package specific install file path including <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo7</em></span> and <span class="strong"><strong>lib</strong></span><span class="emphasis"><em>foo8</em></span> respectively for header files etc. needs to be chosen to make them co-installable.
</li>
                          </ul>
                        </div>
                      </li>
                      <li class="listitem">
Do not use this heavy handed approach, if possible.
</li>
                      <li class="listitem">
This approach should be used if the update of multiple dependent packages require manual code updates, etc. (<a class="ulink" href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> change)  Otherwise, the affected packages become RC buggy with FTBFS.
</li>
                    </ul>
                  </div>
                </li>
              </ul>
            </div>
            <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
              <table border="0" summary="Tip">
                <tr>
                  <td rowspan="2" align="center" valign="top">
                    <img alt="[Tip]" src="images/tip.png"/>
                  </td>
                  <th align="left">Tip</th>
                </tr>
                <tr>
                  <td align="left" valign="top">
                    <p>If the data encoding scheme changes (e.g., latin1 to utf-8), the same care as the API change needs to be taken.</p>
                  </td>
                </tr>
              </table>
            </div>
            <p>See <a class="xref" href="ch05.en.html#lib" title="5.18. Library package">Section 5.18, “Library package”</a>.</p>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="substvar"/>5.5.2. Substvar</h3>
              </div>
            </div>
          </div>
          <p>The <span class="strong"><strong>debian/control</strong></span> file also defines the package dependency in which the <a class="ulink" href="https://www.debian.org/doc/debian-policy/ch-source.html#s-substvars">variable substitutions mechanism</a> (substvar) may be used to free package maintainers from chores of tracking most of the simple package dependency cases.  See <span class="strong"><strong>deb-substvars</strong></span>(5).</p>
          <p>The <span class="strong"><strong>debmake</strong></span> command supports the following substvars:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<span class="strong"><strong>${misc:Depends}</strong></span> for all binary packages
</li>
              <li class="listitem">
<span class="strong"><strong>${misc:Pre-Depends}</strong></span> for all multiarch packages
</li>
              <li class="listitem">
<span class="strong"><strong>${shlibs:Depends}</strong></span> for all binary executable and library packages
</li>
              <li class="listitem">
<span class="strong"><strong>${python:Depends}</strong></span> for all Python packages
</li>
              <li class="listitem">
<span class="strong"><strong>${python3:Depends}</strong></span> for all Python3 packages
</li>
              <li class="listitem">
<span class="strong"><strong>${perl:Depends}</strong></span> for all Perl packages
</li>
              <li class="listitem">
<span class="strong"><strong>${ruby:Depends}</strong></span> for all Ruby packages
</li>
            </ul>
          </div>
          <p>For the shared library, required libraries found simply by "<span class="strong"><strong>objdump -p</strong></span> <span class="emphasis"><em>/path/to/program</em></span> <span class="strong"><strong>| grep NEEDED</strong></span>" are covered by the <span class="strong"><strong>shlib</strong></span> substvar.</p>
          <p>For Python and other interpreters, required modules found simply looking for lines with “<span class="strong"><strong>import</strong></span>”, “<span class="strong"><strong>use</strong></span>”, “<span class="strong"><strong>require</strong></span>”, etc., are covered by the corresponding substvars.</p>
          <p>For other programs which do not deploy their own substvars, the <span class="strong"><strong>misc</strong></span> substvar covers their dependency.</p>
          <p>For POSIX shell programs, there is no easy way to identify the dependency and no substvar covers their dependency.</p>
          <p>For libraries and modules required via the dynamic loading mechanism including the <a class="ulink" href="https://wiki.gnome.org/Projects/GObjectIntrospection">GObject introspection</a> mechanism, there is no easy way to identify the dependency and no substvar covers their dependency.</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="binnmu"/>5.5.3. binNMU safe</h3>
              </div>
            </div>
          </div>
          <p>A <a class="ulink" href="https://wiki.debian.org/binNMU">binNMU</a> is a binary-only non-maintainer upload performed for library transitions etc.  In a binNMU upload, only the “<span class="strong"><strong>Architecture: any</strong></span>” packages are rebuilt with a suffixed version number (e.g. version 2.3.4-3 will become 2.3.4-3+b1).  The “<span class="strong"><strong>Architecture: all</strong></span>” packages are not built.</p>
          <p>The dependency defined in the <span class="strong"><strong>debian/control</strong></span> file among binary packages from the same source package should be safe for the binNMU.  This needs attention if there are both “<span class="strong"><strong>Architecture: any</strong></span>” and “<span class="strong"><strong>Architecture: all</strong></span>” packages involved in it.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p class="simpara">
“<span class="strong"><strong>Architecture: any</strong></span>” package: depends on “<span class="strong"><strong>Architecture: any</strong></span>” <span class="emphasis"><em>foo</em></span> package
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
<span class="strong"><strong>Depends:</strong></span> <span class="emphasis"><em>foo</em></span> <span class="strong"><strong>(= ${binary:Version})</strong></span>
</li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p class="simpara">
“<span class="strong"><strong>Architecture: any</strong></span>” package: depends on “<span class="strong"><strong>Architecture: all</strong></span>” <span class="emphasis"><em>bar</em></span> package
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
<span class="strong"><strong>Depends:</strong></span> <span class="emphasis"><em>bar</em></span> <span class="strong"><strong>(= ${source:Version}</strong></span>
</li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p class="simpara">
“<span class="strong"><strong>Architecture: all</strong></span>” package: depends on “<span class="strong"><strong>Architecture: any</strong></span>” <span class="emphasis"><em>baz</em></span> package
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
<span class="strong"><strong>Depends:</strong></span> <span class="emphasis"><em>baz</em></span> <span class="strong"><strong>(&gt;= ${source:Version})</strong></span>, <span class="emphasis"><em>baz</em></span> <span class="strong"><strong>(&lt;&lt; ${source:Upstream-Version}.0~)</strong></span>
</li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="changelog"/>5.6. debian/changelog</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>debian/changelog</strong></span> file records the Debian package history and defines the upstream package version and the Debian revision in its first line.  The changes need to be documented in the specific, formal, and concise style.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
Even if you are uploading your package by yourself, you must document all non-trivial user-visible changes such as:
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
the security related bug fixes.
</li>
                  <li class="listitem">
the user interface changes.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
If you are asking your sponsor to upload it, you should document changes more comprehensively, including all packaging related ones, to help reviewing your package.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
The sponsor shouldn’t second guess your thought behind your package.
</li>
                  <li class="listitem">
The sponsor’s time is more valuable than yours.
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>The <span class="strong"><strong>debmake</strong></span> command creates the initial template file with the upstream package version and the Debian revision.  The distribution is set to <span class="strong"><strong>UNRELEASED</strong></span> to prevent accidental upload to the Debian archive.</p>
        <p>The <span class="strong"><strong>debchange</strong></span> command (alias <span class="strong"><strong>dch</strong></span>) is commonly used to edit this.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>You can edit the <span class="strong"><strong>debian/changelog</strong></span> file manually with any text editor as long as you follow the formatting convention used by the <span class="strong"><strong>debchange</strong></span> command.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The date string used in the <span class="strong"><strong>debian/changelog</strong></span> file can be manually generated by the “<span class="strong"><strong>LC_ALL=C date -R</strong></span>” command.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>This is installed in the <span class="strong"><strong>/usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span> directory as <span class="strong"><strong>changelog.Debian.gz</strong></span> by the <span class="strong"><strong>dh_installchangelogs</strong></span> command.</p>
        <p>The upstream changelog is installed in the <span class="strong"><strong>/usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span> directory as <span class="strong"><strong>changelog.gz</strong></span>.</p>
        <p>The upstream changelog is automatically found by the <span class="strong"><strong>dh_installchangelogs</strong></span> using the case insensitive match of its file name to <span class="strong"><strong>changelog</strong></span>, <span class="strong"><strong>changes</strong></span>, <span class="strong"><strong>changelog.txt</strong></span>, <span class="strong"><strong>changes.txt</strong></span>, <span class="strong"><strong>history</strong></span>, <span class="strong"><strong>history.txt</strong></span>, or <span class="strong"><strong>changelog.md</strong></span> and searched in the <span class="strong"><strong>./</strong></span> <span class="strong"><strong>doc/</strong></span> or <span class="strong"><strong>docs/</strong></span> directories.</p>
        <p>After finishing your packaging and verifying its quality, please execute the “<span class="strong"><strong>dch -r</strong></span>” command and save the finalized <span class="strong"><strong>debian/changelog</strong></span> file with the distribution normally set to <span class="strong"><strong>unstable</strong></span>. <a href="#ftn.idm2474" class="footnote" id="idm2474"><sup class="footnote">[14]</sup></a>  If you are packaging for backports, security updates, LTS, etc., please use the appropriate distribution names instead.</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="copyright"/>5.7. debian/copyright</h2>
            </div>
          </div>
        </div>
        <p>Debian takes the copyright and license matters very seriously. The “Debian Policy Manual” enforces having a summary of them in the <span class="strong"><strong>debian/copyright</strong></span> file in the package.</p>
        <p>You should format it as a <a class="ulink" href="https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/">machine-readable debian/copyright file</a> (DEP-5).</p>
        <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Caution">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Caution]" src="images/caution.png"/>
              </td>
              <th align="left">Caution</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The <span class="strong"><strong>debian/copyright</strong></span> file should be sorted to keep the generic file patterns at the top of the list.  See <a class="xref" href="ch06.en.html#koption" title="6.4. debmake -k">Section 6.4, “debmake -k”</a>.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>The <span class="strong"><strong>debmake</strong></span> command creates the initial DEP-5 compatible template file by scanning the entire source tree.  It uses an internal license checker to classify each license text. <a href="#ftn.idm2490" class="footnote" id="idm2490"><sup class="footnote">[15]</sup></a></p>
        <p>Unless specifically requested to be pedantic with the <span class="strong"><strong>-P</strong></span> option, the <span class="strong"><strong>debmake</strong></span> command skips reporting for auto-generated files with permissive licenses to be practical.</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Note]" src="images/note.png"/>
              </td>
              <th align="left">Note</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>If you find issues with this license checker, please file a bug report to the <span class="strong"><strong>debmake</strong></span> package with the problematic part of text containing the copyright and license.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Note]" src="images/note.png"/>
              </td>
              <th align="left">Note</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The <span class="strong"><strong>debmake</strong></span> command focuses on bunching up same copyright and license claims in detail to create template for <span class="strong"><strong>debian/copyright</strong></span>.  In order to do this within reasonable time, it only picks the first section which looks like copyright and license claims.  So its license assignment may not be optimal.  Please also use other tools such as <span class="strong"><strong>licensecheck</strong></span>.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>You are highly encouraged to check the license status with the <span class="strong"><strong>licensecheck</strong></span>(1) command and, as needed, with your manual code review.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="patches"/>5.8. debian/patches/*</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>-p1</strong></span> patches in the <span class="strong"><strong>debian/patches/</strong></span> directory are applied in the sequence defined in the <span class="strong"><strong>debian/patches/series</strong></span> file to the upstream source tree before the <span class="strong"><strong>build</strong></span> process.</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Note]" src="images/note.png"/>
              </td>
              <th align="left">Note</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The native Debian package (see <a class="xref" href="ch05.en.html#native" title="5.3. Native Debian package">Section 5.3, “Native Debian package”</a>) doesn’t use these files.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>There are several methods to prepare a series of <span class="strong"><strong>-p1</strong></span> patches.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>diff</strong></span> command
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
See <a class="xref" href="ch04.en.html#diff-u" title="4.8.1. Patch by diff -u">Section 4.8.1, “Patch by diff -u”</a>
</li>
                  <li class="listitem">
                    <p class="simpara">
Primitive but versatile method
</p>
                    <div class="itemizedlist">
                      <ul class="itemizedlist">
                        <li class="listitem">
Patches may come from other distros, mailing list postings, or cherry-picked patches from the upstream <span class="strong"><strong>git</strong></span> repository with the “<span class="strong"><strong>git format-patches</strong></span>” command
</li>
                      </ul>
                    </div>
                  </li>
                  <li class="listitem">
Missing the <span class="strong"><strong>.pc/</strong></span> directory
</li>
                  <li class="listitem">
Unmodified upstream source tree
</li>
                  <li class="listitem">
Manually update the <span class="strong"><strong>debian/patches/series</strong></span> file
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>dquilt</strong></span> command
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
See <a class="xref" href="ch03.en.html#quilt-setup" title="3.4. quilt">Section 3.4, “quilt”</a>
</li>
                  <li class="listitem">
Basic convenient method
</li>
                  <li class="listitem">
Proper generation of the <span class="strong"><strong>.pc/</strong></span> directory data
</li>
                  <li class="listitem">
Modified upstream source tree
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The “<span class="strong"><strong>dpkg-source --commit</strong></span>” command
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
See <a class="xref" href="ch04.en.html#dpkg-source-commit" title="4.8.3. Patch by dpkg-source --commit">Section 4.8.3, “Patch by dpkg-source --commit”</a>
</li>
                  <li class="listitem">
Newer elegant method
</li>
                  <li class="listitem">
Proper generation of the <span class="strong"><strong>.pc/</strong></span> directory data
</li>
                  <li class="listitem">
Modified upstream source tree
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The automatic patch generation by the <span class="strong"><strong>dpkg-buildpackage</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
See <a class="xref" href="ch05.en.html#alt-vcs" title="5.14. Recording in VCS (alternative)">Section 5.14, “Recording in VCS (alternative)”</a>
</li>
                  <li class="listitem">
Add <span class="strong"><strong>single-debian-patch</strong></span> in the <span class="strong"><strong>debian/source/local-options</strong></span> file
</li>
                  <li class="listitem">
Set the <span class="strong"><strong>debian/source/local-patch-header</strong></span> file
</li>
                  <li class="listitem">
Missing the <span class="strong"><strong>.pc/</strong></span> directory
</li>
                  <li class="listitem">
Modified upstream source tree in the Debian branch (<span class="strong"><strong>master</strong></span>)
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>gbp-pq</strong></span> command
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
basic <span class="strong"><strong>git</strong></span> work flow with the <span class="strong"><strong>git-buildpackage</strong></span> package
</li>
                  <li class="listitem">
Missing the <span class="strong"><strong>.pc/</strong></span> directory
</li>
                  <li class="listitem">
Modified upstream source tree in the throw-away branch (<span class="strong"><strong>patch-queue/master</strong></span>)
</li>
                  <li class="listitem">
Unmodified upstream source tree in the Debian branch (<span class="strong"><strong>master</strong></span>)
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>gbp-dpm</strong></span> command
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
more elaborate <span class="strong"><strong>git</strong></span> work flow with the <span class="strong"><strong>git-dpm</strong></span> package
</li>
                  <li class="listitem">
Missing the <span class="strong"><strong>.pc/</strong></span> directory
</li>
                  <li class="listitem">
Modified upstream source tree in the patched branch (<span class="strong"><strong>patched/</strong></span><span class="emphasis"><em>whatever</em></span>)
</li>
                  <li class="listitem">
Unmodified upstream source tree in the Debian branch (<span class="strong"><strong>master/</strong></span><span class="emphasis"><em>whatever</em></span>)
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>Wherever these patches come from, it is a good idea to tag them with a <a class="ulink" href="http://dep.debian.net/deps/dep3/">DEP-3</a> compatible header.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The <span class="strong"><strong>dgit</strong></span> package offers an alternative git integration tool with the Debian package archive.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="dpkg-source-x"/>5.8.1. dpkg-source -x</h3>
              </div>
            </div>
          </div>
          <p>The “<span class="strong"><strong>dpkg-source -x</strong></span>” command unpacks the Debian source package.</p>
          <p>It normally applies the patches in the <span class="strong"><strong>debian/patches/</strong></span> directory to the source tree and records the patch state in the <span class="strong"><strong>.pc/</strong></span> directory.</p>
          <p>If you wish to keep the source tree unmodified (for example, for use in <a class="xref" href="ch05.en.html#vcs" title="5.13. Recording in VCS (standard)">Section 5.13, “Recording in VCS (standard)”</a>), please use the <span class="strong"><strong>--skip-patches</strong></span> option.</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="quilt-dpkg"/>5.8.2. dquilt and dpkg-source</h3>
              </div>
            </div>
          </div>
          <p>The <span class="strong"><strong>quilt</strong></span> command (or its wrapped <span class="strong"><strong>dquilt</strong></span> command) was needed to manage the <span class="strong"><strong>-p1</strong></span> patches in the <span class="strong"><strong>debian/patches/</strong></span> directory before the <span class="strong"><strong>--commit</strong></span> feature was added to the <span class="strong"><strong>dpkg-source</strong></span> command in 1.16.1.</p>
          <p>The patches should apply cleanly when using the <span class="strong"><strong>dpkg-source</strong></span> command.  Thus you can’t just copy the patches to the new packaging of the new upstream release if there are patch offsets, etc.</p>
          <p>The <span class="strong"><strong>dquilt</strong></span> command (see <a class="xref" href="ch03.en.html#quilt-setup" title="3.4. quilt">Section 3.4, “quilt”</a>) is more forgiving.  You can normalize the patches by the <span class="strong"><strong>dquilt</strong></span> command.</p>
          <pre class="screen"> $ while dquilt push; do dquilt refresh ; done
 $ dquilt pop -a</pre>
          <p>There is one advantage of using the <span class="strong"><strong>dpkg-source</strong></span> command over the <span class="strong"><strong>dquilt</strong></span> command.  While the <span class="strong"><strong>dquilt</strong></span> command cannot handle modified binary files automatically, the <span class="strong"><strong>dpkg-source</strong></span> command detects modified binary files and lists them in the <span class="strong"><strong>debian/source/include-binaries</strong></span> file to include them in the Debian tarball.</p>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="signing-key"/>5.9. debian/upstream/signing-key.asc</h2>
            </div>
          </div>
        </div>
        <p>Some packages are signed by a GPG key.</p>
        <p>For example, <a class="ulink" href="https://www.gnu.org/software/hello/">GNU hello</a> can be downloaded via HTTP from <a class="ulink" href="https://ftp.gnu.org/gnu/hello/">https://ftp.gnu.org/gnu/hello/</a> .  There are sets of files:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<span class="strong"><strong>hello-</strong></span><span class="emphasis"><em>version</em></span><span class="strong"><strong>.tar.gz</strong></span> (upstream source)
</li>
            <li class="listitem">
<span class="strong"><strong>hello-</strong></span><span class="emphasis"><em>version</em></span><span class="strong"><strong>.tar.gz.sig</strong></span> (detached signature)
</li>
          </ul>
        </div>
        <p>Let’s pick the latest version set.</p>
        <pre class="screen">$ wget https://ftp.gnu.org/gnu/hello/hello-2.9.tar.gz
 ...
$ wget https://ftp.gnu.org/gnu/hello/hello-2.9.tar.gz.sig
 ...
$ gpg --verify hello-2.9.tar.gz.sig
gpg: Signature made Thu 10 Oct 2013 08:49:23 AM JST using DSA key ID 80EE4A00
gpg: Can't check signature: public key not found</pre>
        <p>If you know the public GPG key of the upstream maintainer from the mailing list, use it as the <span class="strong"><strong>debian/upstream/signing-key.asc</strong></span> file.  Otherwise, use the hkp keyserver and check it via your <a class="ulink" href="https://en.wikipedia.org/wiki/Web_of_trust">web of trust</a>.</p>
        <pre class="screen">$ gpg --keyserver hkp://keys.gnupg.net --recv-key 80EE4A00
gpg: requesting key 80EE4A00 from hkp server keys.gnupg.net
gpg: key 80EE4A00: public key "Reuben Thomas &lt;rrt@sc3d.org&gt;" imported
gpg: no ultimately trusted keys found
gpg: Total number processed: 1
gpg:               imported: 1
$ gpg --verify hello-2.9.tar.gz.sig
gpg: Signature made Thu 10 Oct 2013 08:49:23 AM JST using DSA key ID 80EE4A00
gpg: Good signature from "Reuben Thomas &lt;rrt@sc3d.org&gt;"
  ...
Primary key fingerprint: 9297 8852 A62F A5E2 85B2  A174 6808 9F73 80EE 4A00</pre>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>If your network environment blocks access to the HKP port <span class="strong"><strong>11371</strong></span>, use “<span class="strong"><strong>hkp://keyserver.ubuntu.com:80</strong></span>” instead.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>After confirming the key ID <span class="strong"><strong>80EE4A00</strong></span> is a trustworthy one, download its public key into the <span class="strong"><strong>debian/upstream/signing-key.asc</strong></span> file.</p>
        <pre class="screen">$ gpg --armor --export 80EE4A00 &gt;debian/upstream/signing-key.asc</pre>
        <p>Then set the corresponding <span class="strong"><strong>debian/watch</strong></span> file as follows.</p>
        <pre class="screen">version=4
pgpsigurlmangle=s/$/.sig/  https://ftp.gnu.org/gnu/hello/ hello-(\d[\d.]*)\.tar\.(?:gz|bz2|xz)</pre>
        <p>Now the <span class="strong"><strong>uscan</strong></span> command will check the authenticity of the package using the GPG signature.</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="dfsg"/>5.10. debian/watch and DFSG</h2>
            </div>
          </div>
        </div>
        <p>Debian takes software freedom seriously and follows the <a class="ulink" href="https://www.debian.org/social_contract.html#guidelines">DFSG</a>.</p>
        <p>The non-<a class="ulink" href="https://www.debian.org/social_contract.html#guidelines">DFSG</a> components in the upstream source tarball can be easily removed when the <span class="strong"><strong>uscan</strong></span> command is used to update the Debian package.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
List the files to be removed in the <span class="strong"><strong>Files-Excluded</strong></span> stanza of the  <span class="strong"><strong>debian/copyright</strong></span> file.
</li>
            <li class="listitem">
List the URL to download the upstream tarball in the <span class="strong"><strong>debian/watch</strong></span> file.
</li>
            <li class="listitem">
              <p class="simpara">
Run the <span class="strong"><strong>uscan</strong></span> command to download the new upstream tarball.
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Alternatively, use the “<span class="strong"><strong>gbp import-orig --uscan --pristine-tar</strong></span>” command.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
The resulting tarball has the version number with an additional suffix <span class="strong"><strong>+dfsg</strong></span>.
</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debianconf"/>5.11. Other debian/* Files</h2>
            </div>
          </div>
        </div>
        <p>Optional configuration files may be added under the <span class="strong"><strong>debian/</strong></span> directory.  Most of them are to control <span class="strong"><strong>dh_</strong></span>* commands offered by the <span class="strong"><strong>debhelper</strong></span> package but there are some for <span class="strong"><strong>dpkg-source</strong></span>, <span class="strong"><strong>lintian</strong></span> and <span class="strong"><strong>gbp</strong></span> commands.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Check <span class="strong"><strong>debhelper</strong></span>(7) for the latest available set of the <span class="strong"><strong>dh_</strong></span>* commands.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>These <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.</strong></span>* files provide very powerful means to set the installation path of files.  Even an upstream source without its build system can be packaged just by using these files.  See <a class="xref" href="ch08.en.html#nomakefile" title="8.2. No Makefile (shell, CLI)">Section 8.2, “No Makefile (shell, CLI)”</a> as an example.</p>
        <p>The "<sup><span class="strong"><strong>-x[1234]</strong></span></sup>" superscript notation that appears in the following list indicates the minimum value for the <span class="strong"><strong>debmake</strong></span> <span class="strong"><strong>-x</strong></span> option that will generate the associated template file.  See <a class="xref" href="ch06.en.html#xoption" title="6.6. debmake -x">Section 6.6, “debmake -x”</a> or <span class="strong"><strong>debmake</strong></span>(1) for details.</p>
        <p>Here is the alphabetical list of notable optional configuration files.</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-control</strong></span>  <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
installed as <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/control</strong></span> in <span class="emphasis"><em>binarypackage</em></span>. See <a class="xref" href="ch05.en.html#bug" title="5.24. Bug reports">Section 5.24, “Bug reports”</a>.
</dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-presubj</strong></span>  <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
installed as <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/presubj</strong></span> in <span class="emphasis"><em>binarypackage</em></span>. See <a class="xref" href="ch05.en.html#bug" title="5.24. Bug reports">Section 5.24, “Bug reports”</a>.
</dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-script</strong></span>  <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
installed as <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span> or <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/script</strong></span> in <span class="emphasis"><em>binarypackage</em></span>. See <a class="xref" href="ch05.en.html#bug" title="5.24. Bug reports">Section 5.24, “Bug reports”</a>.
</dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bash-completion</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
List <code class="literal">bash</code> completion scripts to be installed.
</p>
              <p class="simpara">The <code class="literal">bash-completion</code> package is required for both build and user environments.</p>
              <p class="simpara">See <span class="strong"><strong>dh_bash-completion</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>clean</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List files that should be removed but are not cleaned by the <span class="strong"><strong>dh_auto_clean</strong></span> command.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_auto_clean</strong></span>(1) and <span class="strong"><strong>dh_clean</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>compat</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Set the <span class="strong"><strong>debhelper</strong></span> compatibility level (currently, “<span class="strong"><strong>9</strong></span>”).
</p>
              <p class="simpara">See “COMPATIBILITY LEVELS” in <span class="strong"><strong>debhelper</strong></span>(8).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.conffile</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
No need for this file under “compat &gt;= 3” since all files in the <span class="strong"><strong>etc/</strong></span> directory are conffiles.
</p>
              <p class="simpara">If the program you’re packaging requires every user to modify the configuration files in the <span class="strong"><strong>/etc</strong></span> directory, there are two popular ways to arrange for them not to be conffiles, keeping the <span class="strong"><strong>dpkg</strong></span> command happy and quiet.</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Create a symlink under the <span class="strong"><strong>/etc</strong></span> directory pointing to a file under the <span class="strong"><strong>/var</strong></span> directory generated by the maintainer scripts.
</li>
                  <li class="listitem">
Create a file generated by the maintainer scripts under the <span class="strong"><strong>/etc</strong></span> directory.
</li>
                </ul>
              </div>
              <p class="simpara">See <span class="strong"><strong>dh_installdeb</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.config</strong></span>
</span>
            </dt>
            <dd>
This is the <span class="strong"><strong>debconf</strong></span> <span class="strong"><strong>config</strong></span> script used for asking any questions necessary to configure the package.  See <a class="xref" href="ch05.en.html#debconf" title="5.19. debconf">Section 5.19, “debconf”</a>.
</dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.cron.hourly</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the <span class="strong"><strong>etc/cron/hourly/</strong></span><span class="emphasis"><em>binarypackage</em></span> file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installcron</strong></span>(1) and <span class="strong"><strong>cron</strong></span>(8).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.cron.daily</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the <span class="strong"><strong>etc/cron/daily/</strong></span><span class="emphasis"><em>binarypackage</em></span> file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installcron</strong></span>(1) and <span class="strong"><strong>cron</strong></span>(8).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.cron.weekly</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the <span class="strong"><strong>etc/cron/weekly/</strong></span><span class="emphasis"><em>binarypackage</em></span> file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installcron</strong></span>(1) and <span class="strong"><strong>cron</strong></span>(8).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.cron.monthly</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the <span class="strong"><strong>etc/cron/monthly/</strong></span><span class="emphasis"><em>binarypackage</em></span> file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installcron</strong></span>(1) and <span class="strong"><strong>cron</strong></span>(8).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.cron.d</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the <span class="strong"><strong>etc/cron.d/</strong></span><span class="emphasis"><em>binarypackage</em></span> file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installcron</strong></span>(1), <span class="strong"><strong>cron</strong></span>(8), and <span class="strong"><strong>crontab</strong></span>(5).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.default</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
If this exists, it is installed into <span class="strong"><strong>etc/default/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installinit</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.dirs</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List directories to be created in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdirs</strong></span>(1).</p>
              <p class="simpara">Usually, this is not needed since all <span class="strong"><strong>dh_install</strong></span>* commands create required directories automatically.  Use this only when you run into trouble.</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.doc-base</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed as the <span class="strong"><strong>doc-base</strong></span> control file in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdocs</strong></span>(1) and <a class="ulink" href="file:///usr/share/doc/doc-base/doc-base.html/index.html">Debian doc-base Manual</a> provided by the <span class="strong"><strong>doc-base</strong></span> package.</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.docs</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List documentation files to be installed in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdocs</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.emacsen-compat</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/lib/emacsen-common/packages/compat/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installemacsen</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.emacsen-install</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/lib/emacsen-common/packages/install/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installemacsen</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.emacsen-remove</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/lib/emacsen-common/packages/remove/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installemacsen</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.emacsen-startup</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/lib/emacsen-common/packages/startup/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installemacsen</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.examples</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List example files or directories to be installed into <span class="strong"><strong>usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/examples/</strong></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installexamples</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>gbp.conf</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
If this exists, it functions as the configuration file for the <span class="strong"><strong>gbp</strong></span> command.
</p>
              <p class="simpara">See <span class="strong"><strong>gbp.conf</strong></span>(5), <span class="strong"><strong>gbp</strong></span>(1), and <span class="strong"><strong>git-buildpackage</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.info</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List info files to be installed in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installinfo</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.init</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>etc/init.d/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installinit</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.install</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List files which should be installed but are not installed by the <span class="strong"><strong>dh_auto_install</strong></span> command.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_install</strong></span>(1) and <span class="strong"><strong>dh_auto_install</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>license-examples/</strong></span>* <sup><span class="strong"><strong>-x4</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
These are copyright file examples generated by the <span class="strong"><strong>debmake</strong></span> command.  Use these as the reference for making the <span class="strong"><strong>copyright</strong></span> file.
</p>
              <p class="simpara">Please make sure to erase these files.</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.links</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List pairs of source and destination files to be symlinked. Each pair should be put on its own line, with the source and destination separated by whitespace.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_link</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.lintian-overrides</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/share/lintian/overrides/</strong></span><span class="emphasis"><em>binarypackage</em></span> in the package build directory. This file is used to suppress erroneous <span class="strong"><strong>lintian</strong></span> diagnostics.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_lintian</strong></span>(1), <span class="strong"><strong>lintian</strong></span>(1) and <a class="ulink" href="https://lintian.debian.org/manual/index.html">Lintian User’s Manual</a>.</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>manpage.</strong></span>* <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
These are manpage template files generated by the <span class="strong"><strong>debmake</strong></span> command.  Please rename these to appropriate file names and update their contents.
</p>
              <p class="simpara">Debian Policy requires that each program, utility, and function should have an associated manual page included in the same package. Manual pages are written in <span class="strong"><strong>nroff</strong></span>(1).</p>
              <p class="simpara">If you are new to making a manpage, use <span class="strong"><strong>manpage.asciidoc</strong></span> or <span class="strong"><strong>manpage.1</strong></span> as the starting point.</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.manpages</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
List man pages to be installed.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installman</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.menu</strong></span> (deprecated, no more installed)
</span>
            </dt>
            <dd>
              <p class="simpara">
<a class="ulink" href="https://bugs.debian.org/741573">tech-ctte #741573</a> decided "Debian should use
<span class="strong"><strong>.desktop</strong></span> files as appropriate".
</p>
              <p class="simpara">Debian menu file installed into <span class="strong"><strong>usr/share/menu/</strong></span><span class="emphasis"><em>binarypackage</em></span> in <span class="emphasis"><em>binarypackage</em></span>.</p>
              <p class="simpara">See <span class="strong"><strong>menufile</strong></span>(5) for its format.  See <span class="strong"><strong>dh_installmenu</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>NEWS</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into <span class="strong"><strong>usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/NEWS.Debian</strong></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installchangelogs</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>patches/</strong></span>*
</span>
            </dt>
            <dd>
              <p class="simpara">
Collection of <span class="strong"><strong>-p1</strong></span> patch files which are applied to the upstream source before building the source.
</p>
              <p class="simpara">See <span class="strong"><strong>dpkg-source</strong></span>(1), <a class="xref" href="ch03.en.html#quilt-setup" title="3.4. quilt">Section 3.4, “quilt”</a> and <a class="xref" href="ch04.en.html#alt-patch" title="4.8. Step 3 (alternative): Modification to the upstream source">Section 4.8, “Step 3 (alternative): Modification to the upstream source”</a>.</p>
              <p class="simpara">No patch files are generated by the <span class="strong"><strong>debmake</strong></span> command.</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>patches/series</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
The application sequence of the <span class="strong"><strong>patches/</strong></span>* patch files.
</dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.preinst</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
, </span>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.postinst</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
, </span>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.prerm</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
, </span>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.postrm</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
These maintainer scripts are installed into the <span class="strong"><strong>DEBIAN</strong></span> directory.
</p>
              <p class="simpara">Inside the scripts, the token <span class="strong"><strong>#DEBHELPER#</strong></span> is replaced with shell script snippets generated by other <span class="strong"><strong>debhelper</strong></span> commands.</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdeb</strong></span>(1) and <a class="ulink" href="https://www.debian.org/doc/debian-policy/#document-ch-maintainerscripts">Chapter 6 - Package maintainer scripts and installation procedure</a> in the “Debian Policy Manual”.</p>
              <p class="simpara">See also <span class="strong"><strong>debconf-devel</strong></span>(7) and <a class="ulink" href="https://www.debian.org/doc/debian-policy/#prompting-in-maintainer-scripts">3.9.1 Prompting in maintainer scripts</a> in the “Debian Policy Manual”.</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>README.Debian</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the first binary package listed in the <span class="strong"><strong>debian/control</strong></span> file as <span class="strong"><strong>usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/README.Debian</strong></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdocs</strong></span>(1).</p>
              <p class="simpara">This file provides the information specific to the Debian package.</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.service</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
If this exists, it is installed into <span class="strong"><strong>lib/systemd/system/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.service</strong></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_systemd_enable</strong></span>(1), <span class="strong"><strong>dh_systemd_start</strong></span>(1), and <span class="strong"><strong>dh_installinit</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>source/format</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">The Debian package format.</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Use “<span class="strong"><strong>3.0 (quilt)</strong></span>” to make this non-native package (recommended)
</li>
                  <li class="listitem">
Use “<span class="strong"><strong>3.0 (native)</strong></span>” to make this native package
</li>
                </ul>
              </div>
              <p class="simpara">See “SOURCE PACKAGE FORMATS” in <span class="strong"><strong>dpkg-source</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>source/lintian-overrides</strong></span> or <span class="strong"><strong>source.lintian-overrides</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
These files are not installed, but will be scanned by the <span class="strong"><strong>lintian</strong></span> command to provide overrides for the source package.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_lintian</strong></span>(1) and <span class="strong"><strong>lintian</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>source/local-options</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">The <span class="strong"><strong>dpkg-source</strong></span> command uses this content as its options.  Notable options are:</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
<span class="strong"><strong>unapply-patches</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>abort-on-upstream-changes</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>auto-commit</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>single-debian-patch</strong></span>
</li>
                </ul>
              </div>
              <p class="simpara">This is not included in the generated source package and is meant to be committed to the VCS of the maintainer.</p>
              <p class="simpara">See “FILE FORMATS” in <span class="strong"><strong>dpkg-source</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>source/local-patch-header</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
Free form text that is put on top of the automatic patch generated.
</p>
              <p class="simpara">This is not included in the generated source package and is meant to be committed to the VCS of the maintainer.</p>
              <p class="simpara">+
See “FILE FORMATS” in <span class="strong"><strong>dpkg-source</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.symbols</strong></span> <sup><span class="strong"><strong>-x2</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
The symbols files, if present, are passed to the <span class="strong"><strong>dpkg-gensymbols</strong></span> command to be processed and installed.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_makeshlibs</strong></span>(1) and <a class="xref" href="ch05.en.html#symbols" title="5.18.1. Library symbols">Section 5.18.1, “Library symbols”</a>..</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.templates</strong></span>
</span>
            </dt>
            <dd>
This is the <span class="strong"><strong>debconf</strong></span> <span class="strong"><strong>templates</strong></span> file used for asking any questions necessary to configure the package.  See <a class="xref" href="ch05.en.html#debconf" title="5.19. debconf">Section 5.19, “debconf”</a>.
</dd>
            <dt>
              <span class="term">
<span class="strong"><strong>tests/control</strong></span>
</span>
            </dt>
            <dd>
This is the RFC822-style test meta data file defined in <a class="ulink" href="http://dep.debian.net/deps/dep8/">DEP-8</a>.  See <span class="strong"><strong>autopkgtest</strong></span>(1) and <a class="xref" href="ch05.en.html#ci" title="5.22. Continuous integration">Section 5.22, “Continuous integration”</a>.
</dd>
            <dt>
              <span class="term">
<span class="strong"><strong>TODO</strong></span>
</span>
            </dt>
            <dd>
              <p class="simpara">
Installed into the first binary package listed in the <span class="strong"><strong>debian/control</strong></span> file as <span class="strong"><strong>usr/share/doc/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/TODO.Debian</strong></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installdocs</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.tmpfile</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
If this exists, it is installed into <span class="strong"><strong>usr/lib/tmpfiles.d/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.conf</strong></span> in <span class="emphasis"><em>binarypackage</em></span>.
</p>
              <p class="simpara">See <span class="strong"><strong>dh_systemd_enable</strong></span>(1), <span class="strong"><strong>dh_systemd_start</strong></span>(1), and <span class="strong"><strong>dh_installinit</strong></span>(1).</p>
            </dd>
            <dt>
              <span class="term">
<span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.upstart</strong></span> <sup><span class="strong"><strong>-x3</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
If this exists, it is installed into etc/init/package.conf in the package build directory. (deprecated)
</p>
              <p class="simpara">See <span class="strong"><strong>dh_installinit</strong></span>(1) and <a class="xref" href="ch08.en.html#emptypkg" title="8.1. Cherry-pick templates">Section 8.1, “Cherry-pick templates”</a>.</p>
            </dd>
            <dt>
              <span class="term">
<span class="strong"><strong>watch</strong></span> <sup><span class="strong"><strong>-x1</strong></span></sup>
</span>
            </dt>
            <dd>
              <p class="simpara">
The control file for the <span class="strong"><strong>uscan</strong></span> command to download the latest upstream version.
</p>
              <p class="simpara">This control file may be configured to verify the authenticity of the tarball using its GPG signature (see <a class="xref" href="ch05.en.html#signing-key" title="5.9. debian/upstream/signing-key.asc">Section 5.9, “debian/upstream/signing-key.asc”</a>).</p>
              <p class="simpara">See <a class="xref" href="ch05.en.html#dfsg" title="5.10. debian/watch and DFSG">Section 5.10, “debian/watch and DFSG”</a> and <span class="strong"><strong>uscan</strong></span>(1).</p>
            </dd>
          </dl>
        </div>
        <p>Here are a few reminders for the above list.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
For a single binary package, the <span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.</strong></span> part of the filename in the list may be removed.
</li>
            <li class="listitem">
For a multi binary package, a configuration file missing the <span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.</strong></span> part of the filename is applied to the first binary package listed in the <span class="strong"><strong>debian/control</strong></span>.
</li>
            <li class="listitem">
When there are many binary packages, their configurations can be specified independently by prefixing their name to their configuration filenames such as <span class="emphasis"><em>package-1</em></span><span class="strong"><strong>.install</strong></span>, <span class="emphasis"><em>package-2</em></span><span class="strong"><strong>.install</strong></span>, etc.
</li>
            <li class="listitem">
Some template configuration files may not be created by the <span class="strong"><strong>debmake</strong></span> command. In such cases, you need to create them with an editor.
</li>
            <li class="listitem">
Unusual configuration template files generated by the <span class="strong"><strong>debmake</strong></span> command with an extra <span class="strong"><strong>.ex</strong></span> suffix need to be activated by removing that suffix.
</li>
            <li class="listitem">
Unused configuration template files generated by the <span class="strong"><strong>debmake</strong></span> command should be removed.
</li>
            <li class="listitem">
Copy configuration template files as needed to the filenames matching their pertinent binary package names.
</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="custom"/>5.12. Customization of the Debian packaging</h2>
            </div>
          </div>
        </div>
        <p>Let’s recap the customization of the Debian packaging.</p>
        <p>All customization data for the Debian package resides in the <span class="strong"><strong>debian/</strong></span> directory.  A simple example is given in <a class="xref" href="ch04.en.html#step-maintainer" title="4.6. Step 3: Modification to the template files">Section 4.6, “Step 3: Modification to the template files”</a>.  Normally, this customization involves a combination of the following:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
The Debian package build system can be customized through the <span class="strong"><strong>debian/rules</strong></span> file (see <a class="xref" href="ch05.en.html#customrules" title="5.4.3. Customized debian/rules">Section 5.4.3, “Customized debian/rules”</a>).
</li>
            <li class="listitem">
The Debian package installation path etc. can be customized through the addition of configuration files such as <span class="emphasis"><em>package</em></span><span class="strong"><strong>.install</strong></span> and <span class="emphasis"><em>package</em></span><span class="strong"><strong>.docs</strong></span> in the <span class="strong"><strong>debian/</strong></span> directory for the <span class="strong"><strong>dh_</strong></span>* commands from the <span class="strong"><strong>debhelper</strong></span> package (see <a class="xref" href="ch05.en.html#debianconf" title="5.11. Other debian/* Files">Section 5.11, “Other debian/* Files”</a>).
</li>
          </ul>
        </div>
        <p>When these are not sufficient to make a good Debian package, modifications to the upstream source recorded as the <span class="strong"><strong>-p1</strong></span> patches in the <span class="strong"><strong>debian/patches/</strong></span> directory is deployed.  These patches are applied in the sequence defined in the <span class="strong"><strong>debian/patches/series</strong></span> file before building the package (see <a class="xref" href="ch05.en.html#patches" title="5.8. debian/patches/*">Section 5.8, “debian/patches/*”</a>).  Simple examples are given in <a class="xref" href="ch04.en.html#alt-patch" title="4.8. Step 3 (alternative): Modification to the upstream source">Section 4.8, “Step 3 (alternative): Modification to the upstream source”</a>.</p>
        <p>You should address the root cause of the Debian packaging problem by the least invasive way.  The generated package shall be more robust for future upgrades in this way.</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Note]" src="images/note.png"/>
              </td>
              <th align="left">Note</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Send the patch addressing the root cause to the upstream maintainer if it is useful to the upstream.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="vcs"/>5.13. Recording in VCS (standard)</h2>
            </div>
          </div>
        </div>
        <p>Typically, <a class="ulink" href="https://en.wikipedia.org/wiki/Git">Git</a> is used as the <a class="ulink" href="https://en.wikipedia.org/wiki/Version_control">VCS</a> to record the Debian packaging activity with the following branches.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>master</strong></span> branch
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Record the source tree used for the Debian packaging.
</li>
                  <li class="listitem">
The upstream portion of the source tree is recorded unmodified.
</li>
                  <li class="listitem">
The upstream modifications for the Debian packaging are recorded in the <span class="strong"><strong>debian/patches/</strong></span> directory as the <span class="strong"><strong>-p1</strong></span> patches.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>upstream</strong></span> branch
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Record the upstream source tree untarred from the released upstream tarball.
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>It’s a good idea to add to the <span class="strong"><strong>.gitignore</strong></span> file the listing <span class="strong"><strong>.pc</strong></span>.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Add <span class="strong"><strong>unapply-patches</strong></span> and <span class="strong"><strong>abort-on-upstream-changes</strong></span> lines to the <span class="strong"><strong>debian/source/local-options</strong></span> file to keep the upstream portion unmodified.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>You may also track the upstream VCS data with a branch different from the <span class="strong"><strong>upstream</strong></span> branch to ease cherry-picking of patches.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="alt-vcs"/>5.14. Recording in VCS (alternative)</h2>
            </div>
          </div>
        </div>
        <p>You may not wish to keep up with creating the <span class="strong"><strong>-p1</strong></span> patch files for all upstream changes needed.  You can record the Debian packaging activity with the following branches.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>master</strong></span> branch
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Record the source tree used for the Debian packaging.
</li>
                  <li class="listitem">
The upstream portion of the source tree is recorded with modifications for the Debian packaging.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>upstream</strong></span> branch
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Record the upstream source tree untarred from the released upstream tarball.
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>Adding a few extra files in the <span class="strong"><strong>debian/</strong></span> directory enables you to do this.</p>
        <pre class="screen"> $ tar -xvzf &lt;package-version&gt;.tar.gz
 $ ln -sf &lt;package_version&gt;.orig.tar.gz
 $ cd &lt;package-version&gt;/
 ... hack...hack...
 $ echo "single-debian-patch" &gt;&gt; debian/source/local-options
 $ cat &gt;debian/source/local-patch-header &lt;&lt;END
 This patch contains all the Debian-specific changes mixed
 together. To review them separately, please inspect the VCS
 history at https://git.debian.org/?=collab-maint/foo.git.</pre>
        <p>Let the <span class="strong"><strong>dpkg-source</strong></span> command invoked by the Debian package build process (<span class="strong"><strong>dpkg-buildpackage</strong></span>, <span class="strong"><strong>debuild</strong></span>, …) generate the <span class="strong"><strong>-p1</strong></span> patch file <span class="strong"><strong>debian/patches/debian-changes</strong></span> automatically.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>This approach can be adopted for any VCS tools.  Since this approach merges all changes into a merged patch, it is desirable to keep the VCS data publicly accessible.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>The <span class="strong"><strong>debian/source/local-options</strong></span> and <span class="strong"><strong>debian/source/local-patch-header</strong></span> files are meant to be recorded in the VCS.  These aren’t included in the Debian source package.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="build-noextra"/>5.15. Building package without extraneous contents</h2>
            </div>
          </div>
        </div>
        <p>There are a few cases which cause the inclusion of undesirable contents in the generated Debian source package.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
The upstream source tree may be placed under the version control system.  When the package is rebuilt from this source tree, the generated Debian source package contains extraneous contents from the version control system files.
</li>
            <li class="listitem">
The upstream source tree may contain some auto-generated files.  When the package is rebuilt from this source tree, the generated Debian source package contains extraneous contents from the auto-generated files.
</li>
          </ul>
        </div>
        <p>Normally, the <span class="strong"><strong>-i</strong></span> and <span class="strong"><strong>-I</strong></span> options set in <a class="xref" href="ch03.en.html#devscripts-setup" title="3.5. devscripts">Section 3.5, “devscripts”</a> for the <span class="strong"><strong>dpkg-source</strong></span> command should avoid these.  Here, the <span class="strong"><strong>-i</strong></span> option is aimed at the non-native package while the <span class="strong"><strong>-I</strong></span> is aimed at the native package.  See <span class="strong"><strong>dpkg-source</strong></span>(1) and the “<span class="strong"><strong>dpkg-source --help</strong></span>” output.</p>
        <p>There are several methods to avoid inclusion of undesirable contents.</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="rules-clean"/>5.15.1. Fix by debian/rules clean</h3>
              </div>
            </div>
          </div>
          <p>The problem of extraneous contents can be fixed by removing such files in the “<span class="strong"><strong>debian/rules clean</strong></span>” target.  This is also useful for auto-generated files.</p>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>The “<span class="strong"><strong>debian/rules clean</strong></span>” target is called before the “<span class="strong"><strong>dpkg-source --build</strong></span>” command by the <span class="strong"><strong>dpkg-buildpackage</strong></span> command and the “<span class="strong"><strong>dpkg-source --build</strong></span>” command ignores removed files.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="git-clean"/>5.15.2. Fix using VCS</h3>
              </div>
            </div>
          </div>
          <p>The problem of extraneous contents can be fixed by restoring the source tree by committing the source tree to the VCS before the first build.</p>
          <p>You can restore the source tree before the second package build.  For example:</p>
          <pre class="screen"> $ git reset --hard
 $ git clean -dfx
 $ debuild</pre>
          <p>This works because the <span class="strong"><strong>dpkg-source</strong></span> command ignores the contents of the typical VCS files in the source tree with the <span class="strong"><strong>DEBUILD_DPKG_BUILDPACKAGE_OPTS</strong></span> setting in <a class="xref" href="ch03.en.html#devscripts-setup" title="3.5. devscripts">Section 3.5, “devscripts”</a>.</p>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>If the source tree is not managed by a VCS, you should run “<span class="strong"><strong>git init; git add -A .; git commit</strong></span>” before the first build.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="extend-diff-ignore"/>5.15.3. Fix by extend-diff-ignore</h3>
              </div>
            </div>
          </div>
          <p>This is for a non-native package.</p>
          <p>The problem of extraneous diffs can be fixed by ignoring changes made to parts of the source tree by adding the “<span class="strong"><strong>extend-diff-ignore=…</strong></span>” line in the <span class="strong"><strong>debian/source/options</strong></span> file.</p>
          <p>For excluding the <span class="strong"><strong>config.sub</strong></span>, <span class="strong"><strong>config.guess</strong></span> and <span class="strong"><strong>Makefile</strong></span> files:</p>
          <pre class="screen"># Don't store changes on autogenerated files
extend-diff-ignore = "(^|/)(config\.sub|config\.guess|Makefile)$"</pre>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>This approach always works, even when you can’t remove the file. So it saves you having to make a backup of the unmodified file just to be able to restore it before the next build.</p>
                </td>
              </tr>
            </table>
          </div>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>If the <span class="strong"><strong>debian/source/local-options</strong></span> file is used instead, you can hide this setting from the generated source package.  This may be useful when the local non-standard VCS files interfere with your packaging.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="tar-ignore"/>5.15.4. Fix by tar-ignore</h3>
              </div>
            </div>
          </div>
          <p>This is for a native package.</p>
          <p>You can exclude some files in the source tree from the generated tarball by tweaking the file glob by adding the “<span class="strong"><strong>tar-ignore=…</strong></span>” lines in the <span class="strong"><strong>debian/source/options</strong></span> or <span class="strong"><strong>debian/source/local-options</strong></span> files.</p>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>If, for example, the source package of a native package needs files with the file extension <span class="strong"><strong>.o</strong></span> as a part of the test data, the setting in <a class="xref" href="ch03.en.html#devscripts-setup" title="3.5. devscripts">Section 3.5, “devscripts”</a> is too aggressive.  You can work around this problem by dropping the <span class="strong"><strong>-I</strong></span> option for <span class="strong"><strong>DEBUILD_DPKG_BUILDPACKAGE_OPTS</strong></span> in <a class="xref" href="ch03.en.html#devscripts-setup" title="3.5. devscripts">Section 3.5, “devscripts”</a> while adding the “<span class="strong"><strong>tar-ignore=…</strong></span>” lines in the <span class="strong"><strong>debian/source/local-options</strong></span> file for each package.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="build"/>5.16. Upstream build systems</h2>
            </div>
          </div>
        </div>
        <p>Upstream build systems are designed to go through several steps to install generated binary files to the system from the source distribution.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>Before attempting to make a Debian package, you should become familiar with the upstream build system of the upstream source code and try to build it.</p>
              </td>
            </tr>
          </table>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="autotools"/>5.16.1. Autotools</h3>
              </div>
            </div>
          </div>
          <p>Autotools (<span class="strong"><strong>autoconf</strong></span> + <span class="strong"><strong>automake</strong></span>) has 4 steps.</p>
          <div class="orderedlist">
            <ol class="orderedlist">
              <li class="listitem">
set up the build system (“<span class="strong"><strong>vim configure.ac Makefile.am</strong></span>” and “<span class="strong"><strong>autoreconf -ivf</strong></span>”)
</li>
              <li class="listitem">
configure the build system (“<span class="strong"><strong>./configure</strong></span>”)
</li>
              <li class="listitem">
build the source tree (“<span class="strong"><strong>make</strong></span>”)
</li>
              <li class="listitem">
install the binary files (“<span class="strong"><strong>make install</strong></span>”)
</li>
            </ol>
          </div>
          <p>The upstream maintainer usually performs step 1 and builds the upstream tarball for distribution using the “<span class="strong"><strong>make dist</strong></span>” command.   (The generated tarball contains not only the pristine upstream VCS contents but also other generated files.)</p>
          <p>The package maintainer needs to take care of steps 2 to 4 at least.  This is realized by the “<span class="strong"><strong>dh $@ --with autotools-dev</strong></span>” command used in the <span class="strong"><strong>debian/rules</strong></span> file.</p>
          <p>The package maintainer may wish to take care all steps 1 to 4.  This is realized by the “<span class="strong"><strong>dh $@ --with autoreconf</strong></span>” command used in the <span class="strong"><strong>debian/rules</strong></span> file.  This rebuilds all auto-generated files to the latest version and provides better support for porting to the newer architectures.</p>
          <p>For <span class="strong"><strong>compat</strong></span> level <span class="strong"><strong>10</strong></span> or newer, the simple “<span class="strong"><strong>dh $@</strong></span>” command without “<span class="strong"><strong>--with autoreconf</strong></span>” option can take care all steps 1 to 4, too.</p>
          <p>If you wish to learn more on Autotools, please see:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<a class="ulink" href="https://www.gnu.org/software/automake/manual/index.html">GNU Automake documentation</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://www.gnu.org/software/autoconf/manual/index.html">GNU Autoconf documentation</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://www.lrde.epita.fr/~adl/autotools.html">Autotools Tutorial</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://www.dwheeler.com/autotools/introduction-autotools.pdf">Introduction to the autotools (autoconf, automake, and libtool)</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://autotools.io/index.html">Autotools Mythbuster</a>
</li>
            </ul>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="cmake"/>5.16.2. CMake</h3>
              </div>
            </div>
          </div>
          <p>CMake has 4 steps.</p>
          <div class="orderedlist">
            <ol class="orderedlist">
              <li class="listitem">
set up the build system (“<span class="strong"><strong>vim CMakeLists.txt config.h.in</strong></span>”)
</li>
              <li class="listitem">
configure the build system (“<span class="strong"><strong>cmake</strong></span>”)
</li>
              <li class="listitem">
build the source tree (“<span class="strong"><strong>make</strong></span>”)
</li>
              <li class="listitem">
install the binary files (“<span class="strong"><strong>make install</strong></span>”)
</li>
            </ol>
          </div>
          <p>The upstream tarball contains no auto-generated files and is generated by the <span class="strong"><strong>tar</strong></span> command after step 1.</p>
          <p>The package maintainer needs to take care of steps 2 to 4.</p>
          <p>If you wish to learn more on the CMake, please see:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<a class="ulink" href="https://cmake.org/">CMake</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://cmake.org/cmake-tutorial/">CMake tutorial</a>
</li>
            </ul>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="distutils"/>5.16.3. Python distutils</h3>
              </div>
            </div>
          </div>
          <p>Python distutils has 3 steps.</p>
          <div class="orderedlist">
            <ol class="orderedlist">
              <li class="listitem">
set up and configure the build system (“<span class="strong"><strong>vim setup.py</strong></span>”)
</li>
              <li class="listitem">
build the source tree (“<span class="strong"><strong>python setup.py build</strong></span>”)
</li>
              <li class="listitem">
install the binary files (“<span class="strong"><strong>python setup.py install</strong></span>”)
</li>
            </ol>
          </div>
          <p>The upstream maintainer usually performs step 1 and builds the upstream tarball for distribution using the “<span class="strong"><strong>python setup.py sdist</strong></span>” command.</p>
          <p>The package maintainer needs to take care of step 2.  This is realized simply by the “<span class="strong"><strong>dh $@</strong></span>” command used in the <span class="strong"><strong>debian/rules</strong></span> file, after <span class="strong"><strong>jessie</strong></span>.</p>
          <p>The situation of other build systems, such as CMake, are very similar to this Python one.</p>
          <p>If you wish to learn more on Python3 and <span class="strong"><strong>distutils</strong></span>, please see:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<a class="ulink" href="https://docs.python.org/3/">Python3</a>
</li>
              <li class="listitem">
<a class="ulink" href="https://docs.python.org/3.4/library/distutils.html#module-distutils">distutils</a>
</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="dbg"/>5.17. Debugging information</h2>
            </div>
          </div>
        </div>
        <p>The Debian package is built with the debugging information but packaged into the binary package after stripping the debugging information as required by <a class="ulink" href="https://www.debian.org/doc/debian-policy/#document-ch-files">Chapter 10 - Files</a> of the “Debian Policy Manual”.</p>
        <p>See</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<a class="ulink" href="https://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html#bpp-dbg">6.7.9. Best practices for debug packages</a> of the “Debian Developer’s Reference”.
</li>
            <li class="listitem">
<a class="ulink" href="https://sourceware.org/gdb/current/onlinedocs/gdb/Separate-Debug-Files.html#Separate-Debug-Files">18.2 Debugging Information in Separate Files</a> of the “Debugging with gdb”
</li>
            <li class="listitem">
<span class="strong"><strong>dh_strip</strong></span>(1)
</li>
            <li class="listitem">
<span class="strong"><strong>strip</strong></span>(1)
</li>
            <li class="listitem">
<span class="strong"><strong>readelf</strong></span>(1)
</li>
            <li class="listitem">
<span class="strong"><strong>objcopy</strong></span>(1)
</li>
            <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/DebugPackage">DebugPackage</a>
</li>
            <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/AutomaticDebugPackages">AutomaticDebugPackages</a>
</li>
            <li class="listitem">
Debian debian-devel post: <a class="ulink" href="https://lists.debian.org/debian-devel/2015/08/msg00443.html">Status on automatic debug packages</a> (2015-08-15)
</li>
          </ul>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="dbgsym"/>5.17.1. New -dbgsym package (Stretch 9.0 and after)</h3>
              </div>
            </div>
          </div>
          <p>The debugging information is automatically packaged separately as the debug package using the <span class="strong"><strong>dh_strip</strong></span> command with its default behavior.  The name of such a debug package normally has the <span class="strong"><strong>-dbgsym</strong></span> suffix.</p>
          <p>If there were no <span class="strong"><strong>-dbg</strong></span> packages defined in the <span class="strong"><strong>debian/control</strong></span> file, no special care is needed for updating the package after the Stretch 9.0 release.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
The <span class="strong"><strong>debian/rules</strong></span> file shouldn’t explicitly contain <span class="strong"><strong>dh_strip</strong></span>.
</li>
              <li class="listitem">
Set <span class="strong"><strong>debian/compat</strong></span> to <span class="strong"><strong>11</strong></span> or newer.
</li>
              <li class="listitem">
Bump the <span class="strong"><strong>Build-Depends</strong></span> to <span class="strong"><strong>debhelper (&gt;=11~)</strong></span> or newer.
</li>
            </ul>
          </div>
          <p>If there were <span class="strong"><strong>-dbg</strong></span> packages defined in the <span class="strong"><strong>debian/control</strong></span> file, following care is needed for updating the old package after the Stretch 9.0 release.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
Drop definition entries of such <span class="strong"><strong>-dbg</strong></span> packages in the <span class="strong"><strong>debian/control</strong></span> file.
</li>
              <li class="listitem">
Replace “<span class="strong"><strong>dh_strip --dbg-package=</strong></span><span class="emphasis"><em>package”</em></span> with “<span class="strong"><strong>dh_strip --dbgsym-migration=</strong></span><span class="emphasis"><em>package”</em></span> in the <span class="strong"><strong>debian/rules</strong></span> file to avoid file conflicts with the (now obsolete) <span class="strong"><strong>-dbg</strong></span> package.  See <span class="strong"><strong>dh_strip</strong></span>(1).
</li>
              <li class="listitem">
Set <span class="strong"><strong>debian/compat</strong></span> to <span class="strong"><strong>11</strong></span> or newer.
</li>
              <li class="listitem">
Bump the <span class="strong"><strong>Build-Depends</strong></span> to <span class="strong"><strong>debhelper (&gt;=11~)</strong></span> or newer.
</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="lib"/>5.18. Library package</h2>
            </div>
          </div>
        </div>
        <p>Packaging library software requires you to perform much more work than usual.  Here are some reminders for packaging library software:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
The library binary package must be named as in <a class="xref" href="ch05.en.html#libnames" title="5.5.1.3. The library package name">Section 5.5.1.3, “The library package name”</a>.
</li>
            <li class="listitem">
Debian ships shared libraries such as <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/lib</strong></span><span class="emphasis"><em>foo-0.1</em></span><span class="strong"><strong>.so.</strong></span><span class="emphasis"><em>1.0.0</em></span> (see <a class="xref" href="ch05.en.html#multiarch" title="5.20. Multiarch">Section 5.20, “Multiarch”</a>).
</li>
            <li class="listitem">
Debian encourages using versioned symbols in the shared library (see <a class="xref" href="ch05.en.html#symbols" title="5.18.1. Library symbols">Section 5.18.1, “Library symbols”</a>).
</li>
            <li class="listitem">
Debian doesn’t ship <span class="strong"><strong>*.la</strong></span>  libtool library archive files.
</li>
            <li class="listitem">
Debian discourages using and shipping <span class="strong"><strong>*.a</strong></span> static library files.
</li>
          </ul>
        </div>
        <p>Before packaging shared library software, see:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<a class="ulink" href="https://www.debian.org/doc/debian-policy/#document-ch-sharedlibs">Chapter 8 - Shared libraries</a> of the “Debian Policy Manual”
</li>
            <li class="listitem">
<a class="ulink" href="https://www.debian.org/doc/debian-policy/#libraries">10.2 Libraries</a> of the “Debian Policy Manual”
</li>
            <li class="listitem">
<a class="ulink" href="https://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html#bpp-libraries">6.7.2. Libraries</a> of the “Debian Developer’s Reference”
</li>
          </ul>
        </div>
        <p>For the historic background study, see:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<a class="ulink" href="https://debconf4.debconf.org/talks/dependency-hell/img1.html">Escaping the Dependency Hell</a> <a href="#ftn.idm3826" class="footnote" id="idm3826"><sup class="footnote">[16]</sup></a>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
This encourages having versioned symbols in the shared library.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<a class="ulink" href="https://www.netfort.gr.jp/~dancer/column/libpkg-guide/libpkg-guide.html">Debian Library Packaging guide</a> <a href="#ftn.idm3835" class="footnote" id="idm3835"><sup class="footnote">[17]</sup></a>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
Please read the discussion thread following <a class="ulink" href="https://lists.debian.org/debian-devel/2004/06/msg00069.html">its announcement</a>, too.
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="symbols"/>5.18.1. Library symbols</h3>
              </div>
            </div>
          </div>
          <p>The symbols support in <span class="strong"><strong>dpkg</strong></span> introduced in Debian <span class="strong"><strong>lenny</strong></span> (5.0, May 2009) helps us to manage the backward ABI compatibility of the library package with the same package name.  The <span class="strong"><strong>DEBIAN/symbols</strong></span> file in the binary package provides the minimal version associated with each symbol.</p>
          <p>An oversimplified method for the library packaging is as follows.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p class="simpara">
Extract the old <span class="strong"><strong>DEBIAN/symbols</strong></span> file of the immediate previous binary package with the “<span class="strong"><strong>dpkg-deb -e</strong></span>” command.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
Alternatively, the <span class="strong"><strong>mc</strong></span> command may be used to extract the <span class="strong"><strong>DEBIAN/symbols</strong></span> file.
</li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p class="simpara">
Copy it to the <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.symbols</strong></span> file.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
If this is the first package, use an empty content file instead.
</li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p class="simpara">
Build the binary package.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p class="simpara">
If the <span class="strong"><strong>dpkg-gensymbols</strong></span> command warns about some new symbols:
</p>
                      <div class="itemizedlist">
                        <ul class="itemizedlist">
                          <li class="listitem">
Extract the updated <span class="strong"><strong>DEBIAN/symbols</strong></span> file with the “<span class="strong"><strong>dpkg-deb -e</strong></span>” command.
</li>
                          <li class="listitem">
Trim the Debian revision such as <span class="strong"><strong>-1</strong></span> in it.
</li>
                          <li class="listitem">
Copy it to the <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.symbols</strong></span> file.
</li>
                          <li class="listitem">
Re-build the binary package.
</li>
                        </ul>
                      </div>
                    </li>
                    <li class="listitem">
                      <p class="simpara">
If the <span class="strong"><strong>dpkg-gensymbols</strong></span> command does not warn about new symbols:
</p>
                      <div class="itemizedlist">
                        <ul class="itemizedlist">
                          <li class="listitem">
You are done with the library packaging.
</li>
                        </ul>
                      </div>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
          <p>For the details, you should read the following primary references.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
<a class="ulink" href="https://www.debian.org/doc/debian-policy/#the-symbols-system">8.6.3 The symbols system</a> of the “Debian Policy Manual”
</li>
              <li class="listitem">
<span class="strong"><strong>dh_makeshlibs</strong></span>(1)
</li>
              <li class="listitem">
<span class="strong"><strong>dpkg-gensymbols</strong></span>(1)
</li>
              <li class="listitem">
<span class="strong"><strong>dpkg-shlibdeps</strong></span>(1)
</li>
              <li class="listitem">
<span class="strong"><strong>deb-symbols</strong></span>(5)
</li>
            </ul>
          </div>
          <p>Yous should also check:</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/UsingSymbolsFiles">UsingSymbolsFiles</a>
</li>
              <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/Projects/ImprovedDpkgShlibdeps">Projects/ImprovedDpkgShlibdeps</a>
</li>
              <li class="listitem">
Debian kde team <a class="ulink" href="https://pkg-kde.alioth.debian.org/symbolfiles.html">Working with symbols files</a>
</li>
              <li class="listitem">
<a class="xref" href="ch08.en.html#autotools-multi" title="8.11. Autotools (multi-binary package)">Section 8.11, “Autotools (multi-binary package)”</a>
</li>
              <li class="listitem">
<a class="xref" href="ch08.en.html#cmake-multi" title="8.12. CMake (multi-binary package)">Section 8.12, “CMake (multi-binary package)”</a>
</li>
            </ul>
          </div>
          <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Tip">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Tip]" src="images/tip.png"/>
                </td>
                <th align="left">Tip</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>For C++ libraries and other cases where the tracking of symbols is problematic, follow <a class="ulink" href="https://www.debian.org/doc/debian-policy/#the-shlibs-system">8.6.4 The shlibs system</a> of the “Debian Policy Manual”, instead.  Please make sure to erase the empty <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.symbols</strong></span> file generated by the <span class="strong"><strong>debmake</strong></span> command.  For this case, the <span class="strong"><strong>DEBIAN/shlibs</strong></span> file is used.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="lib-trans"/>5.18.2. Library transition</h3>
              </div>
            </div>
          </div>
          <p>When you package a new library package version which affects other packages, you must file a transition bug report against the <span class="strong"><strong>release.debian.org</strong></span> pseudo package using the <span class="strong"><strong>reportbug</strong></span> command with the <a class="ulink" href="https://ben.debian.net/#_query_language">ben file</a> and wait for the approval for its upload from the <a class="ulink" href="https://wiki.debian.org/Teams/ReleaseTeam">Release Team</a>.</p>
          <p>Release team has the <a class="ulink" href="https://release.debian.org/transitions/">transition tracker</a>.  See <a class="ulink" href="https://wiki.debian.org/Teams/ReleaseTeam/Transitions">Transitions</a>.</p>
          <div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Caution">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Caution]" src="images/caution.png"/>
                </td>
                <th align="left">Caution</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>Please make sure to rename binary packages as in <a class="xref" href="ch05.en.html#libnames" title="5.5.1.3. The library package name">Section 5.5.1.3, “The library package name”</a>.</p>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="debconf"/>5.19. debconf</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>debconf</strong></span> package enables us to configure packages during their installation in 2 main ways:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
non-interactively from the <span class="strong"><strong>debian-installer</strong></span> pre-seeding.
</li>
            <li class="listitem">
              <p class="simpara">
interactively from the menu interface (<span class="strong"><strong>dialog</strong></span>, <span class="strong"><strong>gnome</strong></span>, <span class="strong"><strong>kde</strong></span>, …)
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
the package installation: invoked by the <span class="strong"><strong>dpkg</strong></span> command
</li>
                  <li class="listitem">
the installed package: invoked by the <span class="strong"><strong>dpkg-reconfigure</strong></span> command
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>All user interactions for the package installation must be handled by this <span class="strong"><strong>debconf</strong></span> system using the following files.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.config</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
This is the <span class="strong"><strong>debconf</strong></span> <span class="strong"><strong>config</strong></span> script used for asking any questions necessary to configure the package.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.template</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
This is the <span class="strong"><strong>debconf</strong></span> <span class="strong"><strong>templates</strong></span> file used for asking any questions necessary to configure the package.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
package configuration scripts
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.preinst</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.prerm</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.postinst</strong></span>
</li>
                  <li class="listitem">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.postrm</strong></span>
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>See <span class="strong"><strong>dh_installdebconf</strong></span>(1), <span class="strong"><strong>debconf</strong></span>(7), <span class="strong"><strong>debconf-devel</strong></span>(7) and <a class="ulink" href="https://www.debian.org/doc/debian-policy/#prompting-in-maintainer-scripts">3.9.1 Prompting in maintainer scripts</a> in the “Debian Policy Manual”.</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="multiarch"/>5.20. Multiarch</h2>
            </div>
          </div>
        </div>
        <p>Multiarch support for cross-architecture installation of binary packages (particularly <span class="strong"><strong>i386</strong></span> and <span class="strong"><strong>amd64</strong></span>, but also other combinations) in the <span class="strong"><strong>dpkg</strong></span> and <span class="strong"><strong>apt</strong></span> packages introduced in Debian <span class="strong"><strong>wheezy</strong></span> (7.0, May 2013), demands that we pay extra attention to packaging.</p>
        <p>You should read the following references in detail.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
Ubuntu wiki (upstream)
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
<a class="ulink" href="https://wiki.ubuntu.com/MultiarchSpec">MultiarchSpec</a>
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
Debian wiki (Debian situation)
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/Multiarch">Debian multiarch support</a>
</li>
                  <li class="listitem">
<a class="ulink" href="https://wiki.debian.org/Multiarch/Implementation">Multiarch/Implementation</a>
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>The multiarch is enabled by using the <span class="strong"><strong>&lt;triplet&gt;</strong></span> value such as <span class="strong"><strong>i386-linux-gnu</strong></span> and <span class="strong"><strong>x86_64-linux-gnu</strong></span> in the install path of shared libraries as <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/</strong></span>, etc..</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
The <span class="strong"><strong>&lt;triplet&gt;</strong></span> value required internally by <span class="strong"><strong>debhelper</strong></span> scripts is implicitly set in themselves.  The maintainer doesn’t need to worry.
</li>
            <li class="listitem">
              <p class="simpara">
The <span class="strong"><strong>&lt;triplet&gt;</strong></span> value used in <span class="strong"><strong>override_dh_</strong></span>* target scripts must be explicitly set in the <span class="strong"><strong>debian/rules</strong></span> file by the maintainer.  The <span class="strong"><strong>&lt;triplet&gt;</strong></span> value is stored in the <span class="strong"><strong>$(DEB_HOST_MULTIARCH)</strong></span> variable in the following <span class="strong"><strong>debian/rules</strong></span> snippet example:
</p>
              <pre class="screen">DEB_HOST_MULTIARCH = $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)
...
override_dh_install:
        mkdir -p package1/lib/$(DEB_HOST_MULTIARCH)
        cp -dR tmp/lib/. package1/lib/$(DEB_HOST_MULTIARCH)</pre>
            </li>
          </ul>
        </div>
        <p>See:</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
<a class="xref" href="ch05.en.html#variablesrules" title="5.4.4. Variables for debian/rules">Section 5.4.4, “Variables for debian/rules”</a>
</li>
            <li class="listitem">
<span class="strong"><strong>dpkg-architecture</strong></span>(1)
</li>
            <li class="listitem">
<a class="xref" href="ch05.en.html#boption" title="5.5.1.1. debmake -b">Section 5.5.1.1, “debmake -b”</a>
</li>
            <li class="listitem">
<a class="xref" href="ch05.en.html#package-split-example" title="5.5.1.2. Package split scenario and examples">Section 5.5.1.2, “Package split scenario and examples”</a>
</li>
          </ul>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="_the_multiarch_library_path"/>5.20.1. The multiarch library path</h3>
              </div>
            </div>
          </div>
          <p>Debian policy requires following <a class="ulink" href="https://www.debian.org/doc/packaging-manuals/fhs/fhs-2.3.html">Filesystem Hierarchy Standard</a>.  Its <a class="ulink" href="https://www.debian.org/doc/packaging-manuals/fhs/fhs-2.3.html#USRLIBLIBRARIESFORPROGRAMMINGANDPA">/usr/lib : Libraries for programming and packages</a> states "<span class="strong"><strong>/usr/lib</strong></span> includes object files, libraries, and internal binaries that are not intended to be executed directly by users or shell scripts."</p>
          <p>Debian policy makes an exception to the <a class="ulink" href="https://www.debian.org/doc/packaging-manuals/fhs/fhs-2.3.html">Filesystem Hierarchy Standard</a> to use <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/</strong></span> instead of <span class="strong"><strong>/usr/lib&lt;qual&gt;/</strong></span> (e.g., <span class="strong"><strong>/lib32/</strong></span> and <span class="strong"><strong>/lib64/</strong></span>) to support a multiarch library.</p>
          <div class="table">
            <a id="idm4094"/>
            <p class="title">
              <strong>Table 5.1. The multiarch library path options</strong>
            </p>
            <div class="table-contents">
              <table class="table" summary="The multiarch library path options" border="1">
                <colgroup>
                  <col class="col_1"/>
                  <col class="col_2"/>
                  <col class="col_3"/>
                </colgroup>
                <thead>
                  <tr>
                    <th style="text-align: left" valign="top">Classic path   </th>
                    <th style="text-align: left" valign="top">i386 multiarch path            </th>
                    <th style="text-align: left" valign="top">amd64 multiarch path</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/lib/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/lib/i386-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/lib/x86_64-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/i386-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/x86_64-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <br class="table-break"/>
          <p>For Autotools based packages under the <span class="strong"><strong>debhelper</strong></span> package (compat&gt;=9), this path setting is automatically taken care by the <span class="strong"><strong>dh_auto_configure</strong></span> command.</p>
          <p>For other packages with non-supported build systems, you need to manually adjust the install path as follows.</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
If “<span class="strong"><strong>./configure</strong></span>” is used in the <span class="strong"><strong>override_dh_auto_configure</strong></span> target in <span class="strong"><strong>debian/rules</strong></span>, make sure to replace it with “<span class="strong"><strong>dh_auto_configure --</strong></span>” while re-targeting the install path from <span class="strong"><strong>/usr/lib/</strong></span> to <span class="strong"><strong>/usr/lib/$(DEB_HOST_MULTIARCH)/</strong></span>.
</li>
              <li class="listitem">
Replace all occurrences of <span class="strong"><strong>/usr/lib/</strong></span> with <span class="strong"><strong>/usr/lib/*/</strong></span> in <span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>foo</em></span><span class="strong"><strong>.install</strong></span> files.
</li>
            </ul>
          </div>
          <p>All files installed simultaneously as the multiarch package to the same file path should have exactly the same file content. You must be careful with differences generated by the data byte order and by the compression algorithm.</p>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <table border="0" summary="Note">
              <tr>
                <td rowspan="2" align="center" valign="top">
                  <img alt="[Note]" src="images/note.png"/>
                </td>
                <th align="left">Note</th>
              </tr>
              <tr>
                <td align="left" valign="top">
                  <p>The <span class="strong"><strong>--libexecdir</strong></span> option of the <span class="strong"><strong>./configure</strong></span> command specifies the default path to install executable programs run by other programs rather than by users. Its Autotools default is <span class="strong"><strong>/usr/libexec/</strong></span> but its Debian non-multi-arch default is <span class="strong"><strong>/usr/lib/</strong></span>.  If such executables are a part of a "Multi-arch: foreign" package, a path such as <span class="strong"><strong>/usr/lib/</strong></span> or <span class="strong"><strong>/usr/lib/</strong></span><span class="emphasis"><em>packagename</em></span> may be more desirable than <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/</strong></span>, which <span class="strong"><strong>dh_auto_configure</strong></span> uses.  The <a class="ulink" href="https://www.gnu.org/prep/standards/html_node/Directory-Variables.html">GNU Coding Standards: 7.2.5 Variables for Installation Directories</a> has a description for <span class="strong"><strong>libexecdir</strong></span> as "The definition of <span class="strong"><strong>libexecdir</strong></span> is the same for all packages, so you should install your data in a subdirectory thereof. Most packages install their data under <span class="strong"><strong>$(libexecdir)/package-name/</strong></span> …". (It is always a good idea to follow GNU unless it conflicts with the Debian policy.)</p>
                </td>
              </tr>
            </table>
          </div>
          <p>The shared library files in the default path <span class="strong"><strong>/usr/lib/</strong></span> and <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/</strong></span> are loaded automatically.</p>
          <p>For shared library files in another path, the GCC option <span class="strong"><strong>-l</strong></span> must be set by the <span class="strong"><strong>pkg-config</strong></span> command to make them load properly.</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="_the_multiarch_header_file_path"/>5.20.2. The multiarch header file path</h3>
              </div>
            </div>
          </div>
          <p>GCC includes both <span class="strong"><strong>/usr/include/</strong></span> and <span class="strong"><strong>/usr/include/&lt;triplet&gt;/</strong></span> by default on the multiarch Debian system.</p>
          <p>If the header file is not in those paths, the GCC option <span class="strong"><strong>-I</strong></span> must be set by the <span class="strong"><strong>pkg-config</strong></span> command to make "<span class="strong"><strong>#include &lt;</strong></span><span class="emphasis"><em>foo.h</em></span><span class="strong"><strong>&gt;</strong></span>" work properly.</p>
          <div class="table">
            <a id="idm4179"/>
            <p class="title">
              <strong>Table 5.2. The multiarch header file path options</strong>
            </p>
            <div class="table-contents">
              <table class="table" summary="The multiarch header file path options" border="1">
                <colgroup>
                  <col class="col_1"/>
                  <col class="col_2"/>
                  <col class="col_3"/>
                </colgroup>
                <thead>
                  <tr>
                    <th style="text-align: left" valign="top">Classic path   </th>
                    <th style="text-align: left" valign="top">i386 multiarch path            </th>
                    <th style="text-align: left" valign="top">amd64 multiarch path</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/i386-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/x86_64-linux-gnu/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/</strong>
                        </span>
                        <span class="emphasis">
                          <em>packagename</em>
                        </span>
                        <span class="strong">
                          <strong>/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/i386-linux-gnu/</strong>
                        </span>
                        <span class="emphasis">
                          <em>packagename</em>
                        </span>
                        <span class="strong">
                          <strong>/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/include/x86_64-linux-gnu/</strong>
                        </span>
                        <span class="emphasis">
                          <em>packagename</em>
                        </span>
                        <span class="strong">
                          <strong>/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p/>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/i386-linux-gnu/</strong>
                        </span>
                        <span class="emphasis">
                          <em>packagename</em>
                        </span>
                        <span class="strong">
                          <strong>/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/x86_64-linux-gnu/</strong>
                        </span>
                        <span class="emphasis">
                          <em>packagename</em>
                        </span>
                        <span class="strong">
                          <strong>/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <br class="table-break"/>
          <p>The use of the <span class="strong"><strong>/usr/lib/&lt;triplet&gt;/</strong></span><span class="emphasis"><em>packagename</em></span><span class="strong"><strong>/</strong></span> path for the library files allows the upstream maintainer to use the same install script for the multiatch system with <span class="strong"><strong>/usr/lib/&lt;triplet&gt;</strong></span> and the biarch system with <span class="strong"><strong>/usr/lib&lt;qual&gt;/</strong></span>. <a href="#ftn.idm4236" class="footnote" id="idm4236"><sup class="footnote">[18]</sup></a></p>
          <p>The use of the file path containing <span class="emphasis"><em>packagename</em></span> enables having more than 2 development libraries simultaneously installed on a system.</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="_the_multiarch_emphasis_role_strong_pc_emphasis_file_path"/>5.20.3. The multiarch <span class="strong"><strong>*.pc</strong></span> file path</h3>
              </div>
            </div>
          </div>
          <p>The <span class="strong"><strong>pkg-config</strong></span> program is used to retrieve information about installed libraries in the system.  It stores its configuration parameters in the <span class="strong"><strong>*.pc</strong></span> file and is used for setting the <span class="strong"><strong>-I</strong></span> and <span class="strong"><strong>-l</strong></span> options for GCC.</p>
          <div class="table">
            <a id="idm4250"/>
            <p class="title">
              <strong>Table 5.3. The <span class="strong">*.pc</span> file path options</strong>
            </p>
            <div class="table-contents">
              <table class="table" summary="The *.pc file path options" border="1">
                <colgroup>
                  <col class="col_1"/>
                  <col class="col_2"/>
                  <col class="col_3"/>
                </colgroup>
                <thead>
                  <tr>
                    <th style="text-align: left" valign="top">Classic path   </th>
                    <th style="text-align: left" valign="top">i386 multiarch path            </th>
                    <th style="text-align: left" valign="top">amd64 multiarch path</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/pkgconfig/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/i386-linux-gnu/pkgconfig/</strong>
                        </span>
                      </p>
                    </td>
                    <td style="text-align: left" valign="top">
                      <p>
                        <span class="strong">
                          <strong>/usr/lib/x86_64-linux-gnu/pkgconfig/</strong>
                        </span>
                      </p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <br class="table-break"/>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="harden"/>5.21. Compiler hardening</h2>
            </div>
          </div>
        </div>
        <p>The compiler hardening support spreading for Debian <span class="strong"><strong>jessie</strong></span> (8.0, TBA) demands that we pay extra attention to the packaging.</p>
        <p>You should read the following references in detail.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/Hardening">Hardening</a>
</li>
            <li class="listitem">
Debian wiki <a class="ulink" href="https://wiki.debian.org/HardeningWalkthrough">Hardening Walkthrough</a>
</li>
          </ul>
        </div>
        <p>The <span class="strong"><strong>debmake</strong></span> command adds template comments to the <span class="strong"><strong>debian/rules</strong></span> file as needed for <span class="strong"><strong>DEB_BUILD_MAINT_OPTIONS</strong></span>, <span class="strong"><strong>DEB_CFLAGS_MAINT_APPEND</strong></span>, and <span class="strong"><strong>DEB_LDFLAGS_MAINT_APPEND</strong></span> (see <a class="xref" href="ch04.en.html" title="Chapter 4. Simple Example">Chapter 4, <em>Simple Example</em></a> and <span class="strong"><strong>dpkg-buildflags</strong></span>(1)).</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="ci"/>5.22. Continuous integration</h2>
            </div>
          </div>
        </div>
        <p><a class="ulink" href="http://dep.debian.net/deps/dep8/">DEP-8</a> defines the <span class="strong"><strong>debian/tests/control</strong></span> file as the RFC822-style test metadata file for <a class="ulink" href="https://en.wikipedia.org/wiki/Continuous_integration">continuous integration</a> (CI) of the Debian package.</p>
        <p>It is used after building the binary packages from the source package containing this <span class="strong"><strong>debian/tests/control</strong></span> file.  When the <span class="strong"><strong>autopkgtest</strong></span> command is run, the generated binary packages are installed and tested in the virtual environment according to this file.</p>
        <p>See documents in the <span class="strong"><strong>/usr/share/doc/autopkgtest/</strong></span> directory and <a class="ulink" href="http://packaging.ubuntu.com/html/auto-pkg-test.html">3. autopkgtest: Automatic testing for packages</a> of the “Ubuntu Packaging Guide”.</p>
        <p>There are several other CI tools on Debian for you to explore.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
The <span class="strong"><strong>debci</strong></span> package: CI platform on top of the <span class="strong"><strong>autopkgtest</strong></span> package
</li>
            <li class="listitem">
The <span class="strong"><strong>jenkins</strong></span> package: generic CI platform
</li>
          </ul>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="bootstrap"/>5.23. Bootstrapping</h2>
            </div>
          </div>
        </div>
        <p>Debian cares about supporting new ports or flavours.  The new ports or flavours
require <a class="ulink" href="https://wiki.debian.org/DebianBootstrap">bootstrapping</a> operation for
the cross-build of the initial minimal native-building system.  In order to avoid
build-dependency loops during bootstrapping, the build-dependency needs to be
reduced using the <a class="ulink" href="https://wiki.debian.org/BuildProfileSpec">profile</a> builds
feature.</p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>If a core package <code class="literal">foo</code> build depends on a package <code class="literal">bar</code> with deep build
dependency chains but <code class="literal">bar</code> is only used in the <span class="strong"><strong>test</strong></span> target in <code class="literal">foo</code>, you can
safely mark the <code class="literal">bar</code> with <span class="strong"><strong>&lt;!nocheck&gt;</strong></span> in the <span class="strong"><strong>Build-depends</strong></span> of <code class="literal">foo</code> to
avoid build loops.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="bug"/>5.24. Bug reports</h2>
            </div>
          </div>
        </div>
        <p>The <span class="strong"><strong>reportbug</strong></span> command used for the bug report of <span class="emphasis"><em>binarypackage</em></span> can be customized by the files in <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/</strong></span>.</p>
        <p>The <span class="strong"><strong>dh_bugfiles</strong></span> command installs these files from the template files in the <span class="strong"><strong>debian/</strong></span> directory.</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-control</strong></span>  →  <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/control</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
This file contains some directions such as redirecting the bug report to another package.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-presubj</strong></span>  →  <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/presubj</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
This file is displayed to the user by the <span class="strong"><strong>reportbug</strong></span> command.
</li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p class="simpara">
<span class="strong"><strong>debian/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>.bug-script</strong></span>  → <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span> or <span class="strong"><strong>usr/share/bug/</strong></span><span class="emphasis"><em>binarypackage</em></span><span class="strong"><strong>/script</strong></span>
</p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
The <span class="strong"><strong>reportbug</strong></span> command runs this script to generate a template file for the bug report.
</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>See <span class="strong"><strong>dh_bugfiles</strong></span>(1) and <a class="ulink" href="file:///usr/share/doc/reportbug/README.developers.gz">reportbug’s Features for Developers</a></p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top">
                <img alt="[Tip]" src="images/tip.png"/>
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>If you always remind the bug reporter of something or ask them about their
situation, use these files to automate it.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="footnotes">
        <br/>
        <hr/>
        <div id="ftn.idm1578" class="footnote">
          <p><a href="#idm1578" class="simpara"><sup class="simpara">[10] </sup></a>For more than 90% of packages, the package name is equal or less than 24 characters; the upstream version is equal or less than 10 characters and the Debian revision is equal or less than 3 characters.</p>
        </div>
        <div id="ftn.idm1650" class="footnote">
          <p><a href="#idm1650" class="simpara"><sup class="simpara">[11] </sup></a>Use of the “<span class="strong"><strong>debmake -t …</strong></span>” command can help this workflow.  See <a class="xref" href="ch06.en.html#dt-option" title="6.2. Upstream snapshot (-d, -t)">Section 6.2, “Upstream snapshot (-d, -t)”</a>.</p>
        </div>
        <div id="ftn.idm1753" class="footnote">
          <p><a href="#idm1753" class="simpara"><sup class="simpara">[12] </sup></a>This simplicity is available since version 7 of the <span class="strong"><strong>debhelper</strong></span> package.  This guide assumes the use of <span class="strong"><strong>debhelper</strong></span> version 9 or newer.</p>
        </div>
        <div id="ftn.idm1758" class="footnote">
          <p><a href="#idm1758" class="simpara"><sup class="simpara">[13] </sup></a>The <span class="strong"><strong>debmake</strong></span> command generates a bit more complicated <span class="strong"><strong>debian/rules</strong></span> file.  But this is the core part.</p>
        </div>
        <div id="ftn.idm2474" class="footnote">
          <p><a href="#idm2474" class="simpara"><sup class="simpara">[14] </sup></a>If you are using the <span class="strong"><strong>vim</strong></span> editor, make sure to save this with the “<span class="strong"><strong>:wq</strong></span>” command.</p>
        </div>
        <div id="ftn.idm2490" class="footnote">
          <p><a href="#idm2490" class="simpara"><sup class="simpara">[15] </sup></a>The <span class="strong"><strong>licensecheck</strong></span> command from the <span class="strong"><strong>devscripts</strong></span> package was referenced to make this internal checker.  Now the <span class="strong"><strong>licensecheck</strong></span> command is provided in an independent <span class="strong"><strong>licensecheck</strong></span> package with a lot of improvements.</p>
        </div>
        <div id="ftn.idm3826" class="footnote">
          <p><a href="#idm3826" class="simpara"><sup class="simpara">[16] </sup></a>This document was written before the introduction of the <span class="strong"><strong>symbols</strong></span> file.</p>
        </div>
        <div id="ftn.idm3835" class="footnote">
          <p><a href="#idm3835" class="simpara"><sup class="simpara">[17] </sup></a>The strong preference is to use the SONAME versioned <span class="strong"><strong>-dev</strong></span> package names over the single <span class="strong"><strong>-dev</strong></span> package name in <a class="ulink" href="https://www.netfort.gr.jp/~dancer/column/libpkg-guide/libpkg-guide.html#devpkg">Chapter 6. Development (-DEV) packages</a>, which does not seem to be shared by the former ftp-master (Steve Langasek). This document was written before the introduction of the <span class="strong"><strong>multiarch</strong></span> system and the <span class="strong"><strong>symbols</strong></span> file.</p>
        </div>
        <div id="ftn.idm4236" class="footnote">
          <p><a href="#idm4236" class="simpara"><sup class="simpara">[18] </sup></a>This path is compliant with the FHS.  <a class="ulink" href="https://www.debian.org/doc/packaging-manuals/fhs/fhs-2.3.html#USRLIBLIBRARIESFORPROGRAMMINGANDPA">Filesystem Hierarchy Standard: /usr/lib : Libraries for programming and packages</a> states "Applications may use a single subdirectory under <span class="strong"><strong>/usr/lib</strong></span>. If an application uses a subdirectory, all architecture-dependent data exclusively used by the application must be placed within that subdirectory."</p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td align="left"><a accesskey="p" href="ch04.en.html"><img src="images/prev.png" alt="Prev"/></a> </td>
          <td align="center"> </td>
          <td align="right"> <a accesskey="n" href="ch06.en.html"><img src="images/next.png" alt="Next"/></a></td>
        </tr>
        <tr>
          <td align="left" valign="top">Chapter 4. Simple Example </td>
          <td align="center">
            <a accesskey="h" href="index.en.html">
              <img src="images/home.png" alt="Home"/>
            </a>
          </td>
          <td align="right" valign="top"> Chapter 6. debmake options</td>
        </tr>
      </table>
    </div>
  </body>
</html>
