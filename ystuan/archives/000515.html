<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>帝國反抗君之古戰場。PowerOp請您速至 blog.yam.com/ystuan 支援前線！: [繁體中譯]OpenNMS Installation Guide</title>

<link rel="stylesheet" href="http://blog.linux.org.tw/~ystuan/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.linux.org.tw/~ystuan/index.rdf" />

<link rel="start" href="http://blog.linux.org.tw/~ystuan/" title="Home" />
<link rel="prev" href="http://blog.linux.org.tw/~ystuan/archives/000512.html" title="[繁體中譯]OpenNMS Quick Start Guide" />

<link rel="next" href="http://blog.linux.org.tw/~ystuan/archives/000577.html" title="[Linux Kernel Development]Presentation for Chapter 4: System Calls" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.linux.org.tw';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>





</head>

<body>

<div id="banner">
<h1><a href="http://blog.linux.org.tw/~ystuan/" accesskey="1">帝國反抗君之古戰場。PowerOp請您速至 blog.yam.com/ystuan 支援前線！</a></h1>
<span class="description"></span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://blog.linux.org.tw/~ystuan/archives/000512.html">&laquo; [繁體中譯]OpenNMS Quick Start Guide</a> |

<a href="http://blog.linux.org.tw/~ystuan/">Main</a>
| <a href="http://blog.linux.org.tw/~ystuan/archives/000577.html">[Linux Kernel Development]Presentation for Chapter 4: System Calls &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">December 28, 2003</h2>

<div class="blogbody">

<h3 class="title">[繁體中譯]OpenNMS Installation Guide</h3>

<b>[2005/12/19]請注意，這篇網誌已經過時了，請到<a href="http://sourceforge.net/docman/?group_id=4141">OpenNMS Project Documentation</a>，Language選Trad. Chinese，就會看到我提交給官方的繁體中文安裝手冊，或者直接點選<a href="http://sourceforge.net/docman/display_doc.php?docid=29926&group_id=4141">這裡</a>。對這個主題有興趣，歡迎到我的<a href="http://blog.yam.com/ystuan/">新基地</a>逛逛</b>
<p>
原始網址<a href="http://www.opennms.org/users/docs/docs/html/install.html">http://www.opennms.org/users/docs/docs/html/install.html</a>
<br>譯者: Austin Tuan (ystuan 老鼠 hotmail 點 com) 歡迎來信,請於主旨欄加上[Linux]字樣,萬一被hotmail當作spam,我好撿回來 :)
<html><!--This file was generated automatically by man2html.xsl.-->
<body VLINK="#006a6a" LINK="#000000" bgcolor="#ffffff">
	

<p>
<table cellpadding="3" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#000099"><b><font FACE="Arial" SIZE="+4" color="#ffffff">OpenNMS 安裝指南</font></b></td>
</tr>
<tr>
<td bgcolor="#ffffff">
<p>OpenNMS.org<br>
						2001 年出版<br>版本: 1.0.0<br>

			版權 (c) 
		1999, 
		2000, 
		2001, 
		Oculan Corp.
	<br>
<a href="http://www.opennms.org/">www.opennms.org</a>
<br>
</p>
</td>
</tr>
</table>
</p>


	
<p>
<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>

<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2"> 序言</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">誌謝和版權</font></b></td>
</tr>
</table>
</p>
	
	
<p>
<b><font size="+1"><b>版權</b></font></b>
</p>
<p>
			 以下版權與OpenNMS 源碼或文獻是相關的:
		</p>

	
<ul>
		
<li> 
<p>Copyright (c) 1999-2001 Oculan Corp. All rights reserved.</p> 
</li>
		
<li> 
<p>Copyright (c) 1996-2001 PostgresSQL, Inc.</p> 
</li>
		
<li> 
<p>Copyright (c) 1994 Regents of California, Inc.</p> 
</li>

		
<li> 
<p>Copyright (c) 1994-2001 Sun Microsystems, Inc</p> 
</li>
		
<li> 
<p>Copyright (c) 1994-2001 IBM Corporation</p> 
</li>
		
<li> 
<p>Copyright (c) 2001 Microsoft Corporation</p> 
</li>
		
<li> 

<p>Copyright (c) 2001 Netscape</p> 
</li>
		
<li> 
<p>Copyright (c) 2001 Red Hat, Inc.</p> 
</li>
		
<li> 
<p>Copyright (c) 1999-2001 ExoLab Group</p> 
</li>
		
<li> 
<p>Copyright (c) 1999-2001 Apache Software Foundation</p> 

</li>
		
<li> 
<p>Copyright (c) 1998-2001 The Mozilla Organization</p> 
</li>
	
</ul>
	
<p>
<b><font size="+1"><b>有用的資訊鏈結</b></font></b>
</p>
<p>
			 以下URLs 與OpenNMS 源碼或文獻是相關的:
		</p>

	
<ul>
		
<li> 
<p>
<a href="http://www.w3.org/TR/xsl/">XSLFO Spec, Oct 2000</a>
</p> 
</li>
		
<li> 
<p>
<a href="http://www.ibiblio.org/xml/books/bible/updates/15.html">XSLFO 聖經</a>
</p> 
</li>
		

<li> 
<p>
<a href="http://www.xslinfo.com/">XSL 資訊站台</a>
</p> 
</li>
		
<li> 
<p>
<a href="http://www.xml.org/">XML 組織</a>
</p> 
</li>
		
<li> 
<p>
<a href="http://www.docbook.org/">Docbook 組織</a>

</p> 
</li>
		
<li> 
<p>
<a href="http://www.oreilly.com/catalog/docbook/chapter/book/docbook.html">O'Reilly 的DocBook大全</a>

</p> 

</li>
		
<li> 
<p>
<a href="http://www.opennms.org/">OpenNMS.org</a> - OpenNMS 網站</p> 
</li>

		
<li> 
<p>
<a href="http://xml.apache.org/">apache.org</a> - Xerces, XML4J 等的官方網站</p> 
</li>
		
<li> 
<p>
<a href="http://www.sun.com/">Sun</a> - JAVA 的官方網站</p> 
</li>
		

<li> 
<p>
<a href="http://www.w3.org/">W3C 組織</a> - XSLFO 和 XML 的官方網站</p> 
</li>
		
<li> 
<p>
<a href="http://www.postgresql.org/">PostgreSQL</a>  - PostgreSQL 的官方網站</p> 
</li>
	
</ul>




<p>
<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2">1 第一章</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">最低需求</font></b></td>
</tr>
</table>
</p>

	
<dl>
<dd>
<a name="chap1sect1"></a>
	
<p>
<b><font face="Arial">1.1  最低需求</font></b>
</p>
		
<p>
			在安裝之前, 請花一點時間熟悉下列需求。接下來的章節將會深入討論這些相依性套件的設定。		</p>
		
<table cellspacing="1" cellpadding="2">
			

<p>
<b><font face="Arial">  
				OpenNMS 基本要求
			</font></b>
</p>
			
					
<tr>
						
<th bgcolor="#e0e0e0" align="left"><font color="#000000" face="Arial" size="-1">資源</font></th>
						<th bgcolor="#e0e0e0" align="left"><font color="#000000" face="Arial" size="-1">最低需求</font></th>
						<th bgcolor="#e0e0e0" align="left"><font color="#000000" face="Arial" size="-1">可利用的資源</font></th>
					

</tr>
				
					
<tr>
						
<td bgcolor="#ffffff">OpenNMS 安裝套件</td>
						<td bgcolor="#ffffff">版本0.9.0 或更高</td>
						<td bgcolor="#ffffff"><a href="http://www.opennms.org/">www.OpenNMS.org</a></td>
					
</tr>
					
<tr>
						

<td bgcolor="#ffffff">Linux</td>
						<td bgcolor="#ffffff">Redhat 6.2以上, Mandrake 7.2以上, 其他版本可能也可運行</td>
						<td bgcolor="#ffffff"><a href="http://www.linux.org/">www.linux.org</a></td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">PostgreSQL</td>
						<td bgcolor="#ffffff">版本7.1或更高</td>

						<td bgcolor="#ffffff"><a href="http://www.postgresql.org/">www.postgresql.org</a></td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">TomCat</td>
						<td bgcolor="#ffffff">版本4.0或更高</td>
						<td bgcolor="#ffffff"><a href="http://jakarta.apache.org/">jakarta.apache.org</a></td>
					

</tr>
					
<tr>
						
<td bgcolor="#ffffff">RRDTool</td>
						<td bgcolor="#ffffff">版本1.0.28或更高</td>
						<td bgcolor="#ffffff"><a href="http://rrdtool.eu.org/">rrdtool.eu.org</a></td>
					
</tr>
					
<tr>
						

<td bgcolor="#ffffff">Perl 模組</td>
						<td bgcolor="#ffffff">DBI, DBD::Pg</td>
						<td bgcolor="#ffffff"><a href="http://www.cpan.org/">www.cpan.org</a></td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">JAVA Virtual Machine (JVM)</td>
						<td bgcolor="#ffffff">版本1.4 或更高</td>

						<td bgcolor="#ffffff"><a href="http://java.sun.com/j2se/1.4/">java.sun.com</a></td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">磁碟空間</td>
						<td bgcolor="#ffffff">/opt下15MB, /var/log下最多100MB(若開啟預設偵錯模式則可能超過), /var/opennms下每個SNMP設施8MB</td>
					
</tr>
					
<tr>

						
<td bgcolor="#ffffff">記憶體</td>
						<td bgcolor="#ffffff">192 MB (建議至少256MB)</td>
					
</tr>
				
		
</table>
	
</dd>
</dl>



	

<p>
<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2">2 第二章</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">套件相依性設定</font></b></td>
</tr>
</table>
</p>
	
	
<p>
		如果您計劃使用網路安裝程式(web installer)安裝OpenNMS及其相依性套件的RPM檔案, 您可以跳到第三章。如果有任何相依性套件已經被您安裝運行, 請您務必閱讀這個章節。多數較新的系統內核均符合要求, 而其他一切在您系統上運行OpenNMS所需的套件, 安裝程式應該都能順利將它們升級。
	</p>

	
<dl>
<dd>
<a name="chap2sect1"></a>
		
<p>
<b><font face="Arial">2.1  Linux核心2.2或更早的版本</font></b>
</p>
		
<p>
			由於OpenNMS使用大量的JAVA執行緒, 您可能需要重新編譯Linux核心來因應。在源碼目錄下, 將標頭檔
			include/linux/tasks.h內的 NR_Tasks 設為4000。多數商業發行套件所附的核心不需要修改, 就能因應。底下是在重新編譯核心時, 標頭檔task.h應做的修改。
			<pre>
	#define NR_TASKS        4000
			</pre>

			您可在<a href="http://www.linuxdoc.org/HOWTO/Kernel-HOWTO.html">Kernel-HOWTO</a>找到關於編譯新核心的更多資訊。
		
</p>
	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap2sect2"></a>
		
<p>
<b><font face="Arial">2.2  PostgreSQL 設定</font></b>

</p>
		
<p>
			為了讓OpenNMS能夠連結到資料庫, PostgreSQL運行時必須將TCP/IP listener啟動(因為Java並不支援UNIX domain sockets)。
			以PostgreSQL 7.1(此文件寫作時的版本)來說, 改一個簡單的設定檔就可達成此目的, 另外我們還建議修改一些有關效能的選項。
		</p>
		
<p>
			首先, 啟動PostgreSQL, 確定資料庫已經初始化了:
			<pre>
  /etc/init.d/postgresql start
			</pre>
			然後, 編輯/var/lib/pgsql/data/postgresql.conf, 增加以下數行:
			<pre>

  tcpip_socket = true
  max_connections = 256
  shared_buffers = 1024
			</pre>
			注意到 <i>max_connections</i> 和 <i>shared_buffers</i>
			是推薦而非必須的。由於OpenNMS會大量運用執行緒(heavily threaded), 非常容易超出PostgreSQL預設的32個連入連線。
			如果這個問題發生, OpenNMS的許多部分可能無法正常運行。		</p>
		
<p>
			做了這些變動以後, 下次您啟動PostgreSQL時, 新設定就會生效。
		</p>

		
<p>
			請注意如果您是從源碼編譯OpenNMS 以及/或者 PostgreSQL , 除了執行一般的"make install"之外, 您還應該執行"<i>make install-all-headers</i>" 否則您無法編譯OpenNMS的postgresql extensions。
</p>
	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap2sect3"></a>
		
<p>
<b><font face="Arial">2.3  TomCat</font></b>

</p>
		
<p>
			OpenNMS的指令稿install.pl假設tomcat是安裝在/var/tomcat4。如果這不是您的Tomcat 4 所在目錄, 您需要編輯<i>$OPENNMS_HOME/bin/install.pl</i>指令稿, 靠近開頭的<i>$serverxml</i>那一行。
		</p>
	
</dd>
</dl>
	
<dl>
<dd>

<a name="chap2sect4"></a>
		
<p>
<b><font face="Arial">2.4  RRDTool</font></b>
</p>
		
<p>
			如果您計劃從源碼編譯OpenNMS, 請確認安裝RRDTool時包括它的共享函式庫(shared libraries)。有關的資訊在rrdtool源碼目錄下的README。基本上包括以下步驟
			<pre>
	sh configure --enable-shared
	make
	make install
			</pre>
		
</p>
	

</dd>
</dl>
	
<dl>
<dd>
<a name="chap2sect5"></a>
		
<p>
<b><font face="Arial">2.5  CPAN</font></b>
</p>
		
<p>
			為了從源碼編譯, 還需要安裝CPAN函式庫DBI和DBD:Pg。以下指令應該可以安裝這些函式庫
			<pre>
	perl -MCPAN -e shell
	install DBI
	install DBD::Pg
			</pre>

		
</p>
	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap2sect6"></a>
		
<p>
<b><font face="Arial">2.6  JAVA</font></b>
</p>
		
<p>
			由於tomcat在解析JSP網頁時, 需要使用JDK來動態地將Java源碼編譯成bytecode;
因此就算只是要運行OpenNMS, 仍然需要JDK套件。為了讓OpenNMS能正常運行, 環境變數JAVA_HOME應該設定為/usr/java/j2sdk1.4.0或您機器上JDK的安裝目錄。
		</p>

	
</dd>
</dl>




<p>
<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2">3 第三章</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">安裝</font></b></td>
</tr>

</table>
</p>
	
	
<dl>
<dd>
<a name="chap3sect1"></a>
		
<p>
<b><font face="Arial">3.1  目錄結構</font></b>
</p>
		
<p>
			 安裝時, OpenNMS 預設為以下目錄:
		</p>
		

<table cellspacing="1" cellpadding="2">
			
<p>
<b><font face="Arial">  
				 安裝目錄 (請注意這些目錄位置是在編譯時就設定好了的, 如果您自行從源碼編譯, 您可自行指定目錄位置。)
			</font></b>
</p>
			
					
<tr>
						
<th bgcolor="#e0e0e0" align="left"><font color="#000000" face="Arial" size="-1">檔案</font></th>
						<th bgcolor="#e0e0e0" align="left"><font color="#000000" face="Arial" size="-1">目錄</font></th>
					
</tr>

				
					
<tr>
						
<td bgcolor="#ffffff">OpenNMS 可執行檔</td>
						<td bgcolor="#ffffff">/opt/OpenNMS/bin</td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">OpenNMS 設定檔</td>
						<td bgcolor="#ffffff">/opt/OpenNMS/etc/</td>

					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">SQL 函式庫</td>
						<td bgcolor="#ffffff">/opt/OpenNMS/lib</td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">開機指令稿</td>

						<td bgcolor="#ffffff">/etc/init.d/opennms</td>
					
</tr>
					
<tr>
						
<td bgcolor="#ffffff">資料庫</td>
						<td bgcolor="#ffffff">/var/lib/pgsql (SNMP效能資料則放在/var/opennms)</td>
					
</tr>
				
		
</table>

	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap3sect2"></a>
		
<p>
<b><font face="Arial">3.2  從install.opennms.org透過網路安裝OpenNMS</font></b>
</p>
		
<p>
			在一個被支援的RPM平台上安裝或升級OpenNMS, 請以root的身分執行:
			<pre>

	lynx -source http://install.opennms.org | sh
			</pre>
			這個指令會安裝最新的版本。如果您想要指定安裝stable或unstable版本, 請在URL後面加上
			<i>/stable</i> 或 <i>/unstable</i>
			。
		</p>
	
</dd>
</dl>
	

<dl>
<dd>
<a name="chap3sect3"></a>
		
<p>
<b><font face="Arial">3.3  從RPM安裝OpenNMS</font></b>
</p>
		
<p>
			底下是由RPM安裝OpenNMS可執行檔的步驟。
		</p>
		
<ol>
			
<li>

				
<p>
					以"root"身分登入。
				</p>
			
</li>
			
<li>
				
<p>
					從安裝光碟或網際網路取得安裝所需的RPM檔案。網際網路可由<a href="http://www.opennms.org/">www.OpenNMS.org</a>  下載最新的RPM檔案。
				</p>

			
</li>
			
<li>
				
<p>
					用底下的指令安裝
					<pre>
	rpm -Uvh *.rpm
					</pre>
				
</p>
			
</li>
		

</ol>
	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap3sect4"></a>
		
<p>
<b><font face="Arial">3.4 從源碼安裝OpenNMS </font></b>
</p>
		
<p>
			在Linux系統安裝OpenNMS可以透過RPM或tar.gz。關於以RPM安裝的資訊請另外參閱快速起步指南。
		</p>

		
<p>底下是從源碼tar bundle編譯的步驟</p>
		
<ol>
			
<li>
				
<p>
					以"root"身分登入。
				</p>
			
</li>
			
<li>
				

<p>
					解開源碼的壓縮檔
				</p>
			
</li>
			
<li>
				
<p>
					確定以下環境變數的值被設定為正確的路徑
					<pre>
	export OPENNMS_HOME=/opt/OpenNMS
	export JAVA_HOME=/opt/IBMJava2-13
	export TOMCAT_HOME=/var/tomcat4
					</pre>
				

</p>
			
</li>
			
<li>
				
<p>
					您還需要新增~/.opennms-global.properties檔案, 讓OpenNMS知道函式庫和includes的位置。檔案內容應該看起來像底下所述。(請注意如果PostgreSQL和RRDTool被安裝在標準路徑, 像/usr 或/usr/local, 這些在編譯時將自動地設定。)
					<pre>
	compile.include=-I/usr/local/pgsql/include -I/usr/include -I. -I/usr/local/rrdtool-1.0.33/include
	compile.lib=-L/usr/local/pgsql/lib -L/usr/local/rrdtool-1.0.33/lib
					</pre>
				
</p>
			
</li>

			
<li>
				
<p>
					如果您想要安裝在OpenNMS源碼樹下, dist/ 目錄之外的某處, 請從build.properties複製所有要改變的屬性到您的~/.opennms-global.properties檔案中來加以編輯。然後從源碼目錄, 執行以下命令:
					<pre>
	./build.sh install
					</pre>
				
</p>
			
</li>
			
<li>
				

<p>
					您還需要複製或symlink數個檔案到tomcat目錄下, 讓Web UI的某些部份能夠順利運行。
					<pre>
   ln -s $OPENNMS_HOME/lib/castor-*.jar \
         $OPENNMS_HOME/lib/jdbc2_0-stdext.jar \
         $OPENNMS_HOME/lib/log4j.jar \
         $OPENNMS_HOME/lib/opennms_*.jar \
         $TOMCAT_HOME/server/lib/
   ln -s /opt/jbossmq/client/jboss-j2ee.jar \
         /opt/jbossmq/client/jboss-client.jar \
         $TOMCAT_HOME/webapps/opennms/WEB-INF/lib/
					</pre>
					(假設您把OpenNMS webapp安裝在
					$TOMCAT_HOME/webapps/opennms/ directory).
				</p>
			
</li>
			
<li>
				
<p>
					執行安裝指令稿讓OpenNMS新增資料庫					<pre>

	$OPENNMS_HOME/bin/install.pl $OPENNMS_HOME/etc/create.sql
					</pre>
				
</p>
			
</li>
		
</ol>
	
</dd>
</dl>



	
<p>

<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>
<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2">4 第四章</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">設定OpenNMS</font></b></td>
</tr>
</table>
</p>
	
	
<p>
		這一章描述一些設定文件, 以及它們與OpenNMS之系統功能、運行效能、介面外觀的關係。某些任務也許需要修改幾個文件來達到想要的效果。我們建議, 除了指定監測ip位址之外, 如果您還想要做任何設定, 您應該仔細閱讀這一章。這個章節所提到的設定文件除非另外註明, 應該都在$OPENNMS_HOME/etc下。本文提供了一些例子, 還有更多可在前述的設定文件內找到。	</p>
	

<dl>
<dd>
<a name="chap4sect1"></a>
		
<p>
<b><font face="Arial">4.1 設定OpenNMS</font></b>
</p>
		
<p>
			在這一節我們定義接受輪詢的網路位址和被監控的網路服務。		</p>
		
<dl>
<dd>
<a name="chap4sect1sub1"></a>

			
<p>
<b><font face="Arial">4.1.1 增加網路位址</font></b>
</p>
			
<p>
				首要之務是指定要發掘(discover)和輪詢(poll)的網路位址範圍。做法是在discovery-configuration.xml和poller-configuration.xml檔案中新增網路位址範圍。底下是這些檔案的一小段。我們用192.168.0.0/24網段為例。
				<pre>
	在discovery-configuration.xml中:
	&lt;include-range retries="2" timeout="3000"&gt;
	&lt;begin&gt;192.168.0.1&lt;/begin&gt;

	&lt;end&gt;192.168.0.254&lt;/end&gt;
	&lt;/include-range&gt;
	---
	在poller-configuration.xml中:
	&lt;include-range begin="192.168.0.1" end="192.168.0.254"/&gt;
				</pre>
				除了使用&lt;include-range&gt;之外, 還可以用其他方式增加網路位址, 例如用&lt;include-url&gt來指定一個純文字檔(一行一個網路位址, 不可有註解或空白行)。或者用&lt;specific&gt指定排除某些網路位址。請看底下範例。				<pre>

	在discovery-configuration.xml中:
	&lt;include-url&gt;file:/opt/OpenNMS/etc/include&lt;/include-url&gt;
	---
	在poller-configuration.xml中:
	&lt;specific&gt;0.0.0.0&lt;/specific&gt;
	&lt;include-url&gt;file:/opt/OpenNMS/etc/include&lt;/include-url&gt;

				</pre>
				在網路設備開始或停止被監控時, OpenNMS會寫入例子中URL所指的檔案(/opt/OpenNMS/etc/include)。
			</p>
			
<p>
				注意:在輸入資料庫時, 您可以指定哪些設備要被預設成"managed"。如果您這麼做, 請確定在capsd-configuration.xml中, 您將受控節點(managed nodes)的網路管理政策設為"managed"。預設對所有non-local, 有效的網路位址均為"managed"。
							</p>
		
</dd>
</dl>
		
<dl>
<dd>
<a name="chap4sect1sub2"></a>

			
<p>
<b><font face="Arial">4.1.2 指定服務</font></b>
</p>
			
<p>
				一旦決定了希望監測的網路位址, 接著您可能會關心您想要監測的服務類型。服務必須設定在poller-configuration.xml 和capsd-configuration.xml 。有許多服務已經預設好了。			</p>
			
<p>
				在packages中設定參數時, 您可以覆蓋(override)一些預設值。底下的例子我們設定飛碟偵測協定(UFO Detection Protocol)於TCP port 4, 並且自行指定逾時、重試、輪詢間隔等等時間參數。				<pre>
	capsd-configuration.xml:
	&lt;protocol-plugin protocol="UFODP"
		class-name="org.opennms.netmgt.capsd.TcpPlugin" scan="on" user-defined="false"&gt;

		&lt;property key="banner" value="*"/&gt;
		&lt;property key="port" value="4"/&gt;
		&lt;property key="timeout" value="3000"/&gt;
		&lt;property key="retry" value="3"/&gt;
	&lt;/protocol-plugin&gt;
	---
	poller-configuration.xml:
	&lt;service name="UFODP" interval="300000" user-defined="false" status="on"&gt;

		&lt;parameter key="banner" value="*"/&gt;
		&lt;parameter key="port" value="4"/&gt;
		&lt;parameter key="timeout" value="3000"/&gt;
	&lt;/service&gt;
				</pre>
			
</p>
		

</dd>
</dl>
	
</dd>
</dl>
	
<dl>
<dd>
<a name="chap4sect2"></a>
		
<p>
<b><font face="Arial">4.2 設定概觀(view)</font></b>
</p>
		
<p>
			您可以修改views.xml和viewsdisplay.xml來設定概觀(view)。在views.xml內您可以定義特定的服務該屬於哪個類別, 並且定義網頁上顯示的(服務)中斷資訊之臨界值。下面的例子中我們為飛碟探測器創造了一個類別, 也為我們的網際網路連線設了一個。			<pre>

		&lt;category&gt;
			&lt;label&gt;&lt;![CDATA[SETI Servers]]&gt;&lt;/label&gt;
			&lt;normal&gt;99&lt;/normal&gt;
			&lt;warning&gt;97&lt;/warning&gt;

			&lt;service&gt;UFO Detectors&lt;/service&gt;
			&lt;rule&gt;&lt;![CDATA[isUFODP]]&gt;&lt;/rule&gt;
		&lt;/category&gt;
		&lt;category&gt;
			&lt;label&gt;&lt;![CDATA[Internet Connectivity]]&gt;&lt;/label&gt;

			&lt;normal&gt;99&lt;/normal&gt;
			&lt;warning&gt;97&lt;/warning&gt;
			&lt;service&gt;ICMP&lt;/service&gt;
			&lt;rule&gt;&lt;![CDATA[ipaddr IPLIKE 12.0.0.1]]&gt;&lt;/rule&gt;

		&lt;/category&gt;
			</pre>
			至於在viewsdisplay.xml中, 您能更動網頁主控台概觀(main web console view)之呈現方式。在大多情況下, 您不需要改變預設的概觀。
			<pre>
	&lt;view&gt;
		&lt;view-name&gt;WebConsoleView&lt;/view-name&gt;
		&lt;section&gt;

			&lt;section-name&gt;&lt;![CDATA[Category]]&gt;&lt;/section-name&gt;
			&lt;category&gt;&lt;![CDATA[SETI Servers]]&gt;&lt;/category&gt;
			&lt;category&gt;&lt;![CDATA[Internet Connectivity]]&gt;&lt;/category&gt;
		&lt;/section&gt;

	&lt;/view&gt;
			</pre>
		
</p>
	
</dd>
</dl>




<p>
<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tr>

<td bgcolor="#000099" align="left"><b><font face="Arial" color="#ffffff" size="+2">5 第五章</font></b></td>
</tr>
<tr>
<td align="left"><b><font face="Arial" size="+1">監看網路</font></b></td>
</tr>
</table>
</p>
	
	
<dl>
<dd>
<a name="chap5sect1"></a>
		
<p>
<b><font face="Arial">5.1 啟動 OpenNMS</font></b>

</p>
		
<p>
			 確定您記得啟動需要的相依套件
			<pre>
	/etc/init.d/service postgresql start 
			</pre>
		
</p>
		
<p>
			 那些相依套件啟動後, 您可以啟動OpenNMS
			<pre>
	/etc/init.d/service opennms start
		或
	/opt/OpenNMS/bin/opennms.sh start
			</pre>

		
</p>
		
<p>
			 您也要確定tomcat伺服器正常運作
			<pre>
	/etc/init.d/service tomcat4 start
			</pre>
		
</p>
		
<p>
			 您可以用下列指令檢查OpenNMS的狀態
			<pre>

	# /opt/OpenNMS/bin/opennms.sh status
	OpenNMS.Poller                          : running
	OpenNMS.Eventd                          : running
	OpenNMS.OutageManager                   : running
	OpenNMS.Discovery                       : running
	OpenNMS.Actiond                         : running
	OpenNMS.Capsd                           : running
	OpenNMS.Dhcpd                           : running
	OpenNMS.Notifd                          : running
	OpenNMS.RTCViewCategoryManager          : running
	OpenNMS.Trapd                           : running
			</pre>
			 如果有任何問題或服務沒有正確地啟動, 您可以檢查紀錄檔來獲得更多資訊。若使用RPM安裝, 記錄檔在/var/log/opennms/
		</p>
		
<p>
			 注意: 如果您需要停止目前的OpenNMS 程序, 您可使用以下命令的其中一個。
			<pre>
	/opt/OpenNMS/bin/opennms.sh stop
	/opt/OpenNMS/bin/opennms.sh kill
			</pre>
		
</p>
	

</dd>
</dl>
	
<dl>
<dd>
<a name="chap5sect2"></a>
		
<p>
<b><font face="Arial">5.2 監看網路</font></b>
</p>
		
<p>
			 當一切開始運作, 您可在您的瀏覽器輸入以下網址。			<pre>
	http://127.0.0.1:8080/opennms/
			</pre>

		
</p>
		
<p>login: admin/admin</p>
		
<p>
			 在登入以後您將被帶到OpenNMS監看您的網路的主畫面。多數瀏覽器均可正常執行, 但是只有下列是正式地受到支援...Netscape 6+, Mozilla 0.8+, and IE 5.5+
		</p>
	
</dd>
</dl>



</body>

</html>

<a name="more"></a>


<span class="posted">Posted by ystuan at December 28, 2003 10:58 PM

<br /></span>

<div class="comments-body">
<div class="comments-head"><a name="pings"></a>Pings</div>

</div>



</div>


<div class="comments-head"><a name="comments"></a>Comments</div>





</div>
</div>
</body>
<!-- Site Meter XHTML Strict 1.0 -->
<script type="text/javascript">var site="s22PowerOp"</script>
<script type="text/javascript" src="http://s22.sitemeter.com/js/counter.js?site=s22PowerOp">
</script>
<noscript><div>
<a href="http://s22.sitemeter.com/stats.asp?site=s22PowerOp">
<img src="http://s22.sitemeter.com/meter.asp?site=s22PowerOp" alt="Site Meter" /></a>
</div></noscript>
<!-- Copyright (c)2005 Site Meter -->

</html>
