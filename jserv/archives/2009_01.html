<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Jserv's blog: January 2009 彙整</title>

<link rel="stylesheet" href="http://blog.linux.org.tw/~jserv/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.linux.org.tw/~jserv/index.rdf" />
<link rel="start" href="http://blog.linux.org.tw/~jserv/" title="Home" />
<link rel="prev" href="http://blog.linux.org.tw/~jserv/archives/2008_12.html" title="December 2008" />

<link rel="next" href="http://blog.linux.org.tw/~jserv/archives/2009_02.html" title="February 2009" />


<script language="javascript" type="text/javascript">
function OpenComments (c) {
    window.open(c,
                    'comments',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}
</script>

</head>

<body>	

<div id="banner">
<h1><a href="http://blog.linux.org.tw/~jserv/" accesskey="1">Jserv's blog</a></h1>
<span class="description"></span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://blog.linux.org.tw/~jserv/archives/2008_12.html">« December 2008</a> |

<a href="http://blog.linux.org.tw/~jserv/">回到主頁面</a>
| <a href="http://blog.linux.org.tw/~jserv/archives/2009_02.html">February 2009 »</a>

</div>

</div>

<div class="blog">


<h2 class="date">January 14, 2009</h2>


<div class="blogbody">
<a name="002085"></a>
<h3 class="title">Qt 4.5 將允許增列 LGPL 2.1 條款發行</h3>

<center><img src="http://www.qtsoftware.com/logo.png" width="174" height="71"></center><br />
過去，Trolltech 的 Qt 一直是 dual-licensing 與 GPL 商業模式獲利的典範，而自從去年被 Nokia 收購後，進行許多調整，比方說 [<a href="http://blog.linux.org.tw/~jserv/archives/002067.html">Qtopia 再度更名為 "Qt Extended"</a>]，而其商業模式也轉變中。過去以 GPL/QPL 發佈的 Qt，若僅取用函式庫的部份，因為 GPL 模式使然，建構於上的應用程式，往往「隱含」為 GNU GPL 授權，除非獲得官方許可或是軟體採用明確的隔離設計。但現在，這些限制即將解除，Nokia 即日宣佈，預定於 2009 年三月發佈的 Qt 4.5 版開始，將以 GNU LGPL 2.1 授權發佈其 Qt，詳情可參閱聲明稿 [<a href="http://www.qtsoftware.com/about/news/lgpl-license-option-added-to-qt">LGPL License Option Added to Qt </a>]，重點是這段：<ul class="code" style="margin: 6px;">
The move to LGPL licensing will provide open source and commercial developers with more permissive licensing than GPL and so increase flexibility for developers. In addition, Qt source code repositories will be made publicly available and will encourage contributions from desktop and embedded developer communities. With these changes, developers will be able to actively drive the evolution of the Qt framework.
</ul>
向 LGPL 的轉移的舉動，將對開放原始碼軟體與衍生的商業應用，更加友善且具備彈性，鼓勵更多來自桌面和嵌入式開發人員社區的貢獻。相關的討論可見 KDE.NEWS [<a href="http://dot.kde.org/1231920504/">Qt Everywhere: 4.5 To Be Relicensed As LGPL</a>]。<br />
<br />
同時，Qt Software 的副總裁 Sebastian Nyström 在 blog [<a href="http://labs.trolltech.com/blogs/2009/01/14/nokia-to-license-qt-under-lgpl/">Nokia to license Qt under LGPL</a>] 提及 Nokia 後續的開放動作，引述如下：<ul>
  <li>Employing more Qt developers</li>
  <li>Opening our source code repository</li>
  <li>Reducing the overhead needed to make a submission, including no longer requiring copyright assignments.</li>
  <li>Launching a new web infrastructure to support contributions later this year.</li>
</ul>
看來的確一系列是令人振奮的訊息，至於為何採用 LGPL 2.1 版呢？他表示：<ul class="code" style="margin: 6px;">
As a first step we have selected LGPL version 2.1 as this is the version of the LGPL that best fits our purposes and we are most comfortable with at this point in time. We will continue to evaluate the adoption, use and legal interpretation of LGPL version 3 by the community and may use this version of the LGPL for future releases.
</ul>
開放 Qt repository (部份像是 QtWebKit 與 Qt Labs 的專案，已開放存取其 git / svn repository) 並採取更廣泛社群開發的模式，可說是 Nokia 在 Mobile/Embedded Linux 平台建立標準化所深耕的宣示，樂見其成。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/002085.html">09:00 PM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=2085" onclick="OpenComments(this.href); return false">迴響 (2)</a>
	
	
</div>

</div>



<h2 class="date">January 13, 2009</h2>


<div class="blogbody">
<a name="002084"></a>
<h3 class="title">libsslwrap : 通透地對網路傳輸加上 SSL 保護</h3>

最近研究網路傳輸的機制時，想到 Kenichi Kourai 教授在 2001 年設計過一個相當精巧的函式庫 [<a href="http://www.ksl.ci.kyutech.ac.jp/~kourai/research/libsslwrap/libsslwrap.html">libsslwrap</a>]，可通透地 (transparently) 對 TCP/IP 網路傳輸過程中，加上 SSL 安全連線的保護，更重要的是，不需要對原本的網路應用程式作原始程式碼修改、重新編譯等處理。libsslwrap 運用 UNIX/ELF 執行檔的動態連結機制，透過設定 LD_PRELOAD 環境變數，預先載入 libsslwrap 提供的函式庫，將原本的 connect, accept, write, read, send, recv 等系統呼叫，予以攔截轉包到支援 SSL 的實做，如此一來，即可達到通透處理的目標。<br />
<br />
實務上，仍有一些限制，詳情可參閱原始程式套件中的 "README" 檔案，不過就一般的操作，應已足夠。本文將以 telnet 連線為例，說明 libsslwrap 的使用。首先，當然是編譯 libsslwrap，不過，要注意的是，原本的程式無法在 gcc-4.3 下編譯，所以筆者準備一個修正 [<a href="http://jserv.sayya.org/misc/libsslwrap-gcc43-build.patch">libsslwrap-gcc43-build.patch</a>]，編譯的環境應該要有 OpenSSL 的開發套件，比方說 Debian/Ubuntu 的 libssl-dev 套件。為了方便後續的說明，給定筆者偏好的 PREFIX：<pre class="code" style="margin: 6px;">
make PREFIX=/tmp/libsslwrap
make install
</pre>
建構過程，程式會提醒您建立 SSL certification 資訊，依序填入即可。<br />
<br />
既然要探討 telnet 連線，我們就該準備必要的套件，像是 telnet 與 telnetd，很容易地安裝：<pre class="code" style="margin: 6px;">
# apt-get install telnet telnetd
</pre>
透過 Wireshark 可視覺化地觀察網路封包的傳輸狀況，因為筆者的實做環境都在本地端 (localhost)，所以僅觀察 lo interface，如下圖所示：<br />
<center><img src="http://jserv.sayya.org/misc/sslwrap-1.jpg" width="640" height="392" /></center><br />
在 "lo" 那一列按下 "Start" 按鈕，即可監控本地端的網路封包。telnetd (telnet daemon) 可透過 inetd 執行，假設系統啟動時已有 telnetd 服務，那麼我們直接透過 telnet 連線：<pre class="code" style="margin: 6px;">
# telnet localhost
</pre>
參考的終端機執行畫面如下：<pre class="code" style="margin: 6px;">
telnet localhost
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
Ubuntu jaunty (development branch)
</pre>
後面就是要求登入的訊息，這裡忽略。上面的訊息中，"Ubuntu jaunty" 也就是筆者使用的環境 Ubuntu 9.04 的開發版本，代號為 "jaunty"。因為是明碼傳輸，所以我們可在 Wireshark 觀察往返的網路封包內容，如下圖所示：<br />
<center><img src="http://jserv.sayya.org/misc/sslwrap-2.jpg" width="640" height="492" /></center><br />
上圖的下方視窗中，可見到 "Ubuntu jaunty" 的字樣出現於 Telnet Data，當然啦，繼續等待的話，還能見到登入的帳號與密碼內文，對於其他的網路傳輸協定，如 FTP，也有類似的情況，網路封包的內容一目了然。若系統無法更動為 SSH 或 SFTP (FTP over SSH) 的話，libsslwrap 就能派上用場。<br />
咱們回頭看 libsslwrap。編譯 libsslwrap 後，應該可在 src/ 目錄見到 libsslwrap.so 這個動態函式庫被建立，並且在 make install 後，/tmp/libsslwrap/bin/ 目錄下多了一個名為 sslwrap 的 script，其內容相當單純，就是在執行程式前，透過 LD_PRELOAD 環境變數的設定，預先載入 libsslwrap.so。為了作比較，筆者在稍候即將啟動的 telnetd，要求透過不同的 port (預設 port number 為 22)，比方說 port 10023，這可透過 "-debug" 參數達成，也就是說，我們可以這樣啟動 telnet daemon：<br />
<pre class="code" style="margin: 6px;">
# /tmp/libsslwrap/bin/sslwrap /usr/sbin/in.telnetd -debug 10023
</pre>
當此行指令被執行後，終端機會輸出一個簡短的訊息："preload"，表示 libsslwrap.so 已成功將原本的 connect, accept, write, read, send, recv 等系統呼叫，予以攔截轉包到支援 SSL 的實做，一旦筆者嘗試連線，即可見其端倪。當然，既然 server 端透過 sslwrap 去執行，client 端也要，所以連線指令如下：<pre class="code" style="margin: 6px;">
# /tmp/libsslwrap/bin/sslwrap telnet localhost 10023
</pre>
表示欲透過 telnet 連線到 localhost 的 port 10023，此時，Wireshark 的封包就大異於之前純粹的 telnet 連線狀況，參考的輸出如下圖：<br />
<center><img src="http://jserv.sayya.org/misc/sslwrap-3.jpg" width="640" height="495" /></center><br />
這過程包含了 SSL 的 cert 與通訊，以及 (轉包的) telnet 資料傳輸等動作，而封包內容也不再是人眼可識別的明碼了。這表示，libsslwrap 通透地對網路傳輸加上 SSL 保護，不失為一個解決方案。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/002084.html">02:28 PM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=2084" onclick="OpenComments(this.href); return false">迴響 (3)</a>
	
	
</div>

</div>



<h2 class="date">January 10, 2009</h2>


<div class="blogbody">
<a name="002083"></a>
<h3 class="title">OSDC.TW 2009 徵稿</h3>

一年一度的 [<a href="http://osdc.tw/">OSDC.tw</a>] (Open Source Developers' Conference Taiwan) 研討會即將於四月份舉辦，最近密集徵稿中，詳情可參考 [<a href="http://blog.hcchien.org/OSDCTW/2008/12/osdctw_2009.html">官方網站的訊息</a>]。日期訂於四月 18 與 19 兩日，舉辦的地點依然在台北，屆時也會有多元的議程。<br />
<br />
稍早 hcchien 兄特別提醒這件事，這幾天終於有時間處理 (之前疑似被外星人綁架，所以...)，思考了投稿的議題，暫時規劃在系統層面與編譯技術。我們可見 compiler 技術的影響無所不在，無論是程式語言範疇、Web 應用程式，甚至是 OpenGL/3D，都潛藏著與 compiler 密不可分的關聯。乍看很難想像其關聯性，但回頭看看 JSP/Servlet 的運作，或者 OpenGL ARB 的 GLSL，或者當紅炸子雞 Google Android 平台，不難理解何以前述關鍵項目依賴著編譯技術，實在是解決工程問題所需的背景。<br />
<br />
隨著開放源碼的蓬勃發展，Compiler Toolkit 也獲得空前的成功，並且當今的運算型態已變得多元，無論是虛擬化技術、VM、JIT (Just-In-Time) compiler，或者 Binary translator 等等，都是吾人耳熟能詳且為建構當今資訊建設的基礎技術。也因此，希望藉由這次的機會，分享小弟過去幾年的開發經驗，希望能和與會的朋友們一同成長。OSDC.tw 徵稿的截止日為 2009/1/31，請不要忘記了 :-)<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/002083.html">02:05 AM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=2083" onclick="OpenComments(this.href); return false">迴響 (0)</a>
	
	
</div>

</div>



<h2 class="date">January 09, 2009</h2>


<div class="blogbody">
<a name="002082"></a>
<h3 class="title">CuRT - 精簡易懂的 RTOS - 釋出</h3>

貫徹「每年練習寫一個作業系統」的小目標，小弟今年準備小小的即時作業系統，作為 2009 年的見面禮，取名為 CuRT，全名是 "Compat Unicellular Real-Time operating system"，目標定於簡潔易懂，算是在 COSCUP 2007 發表的 [<a href="http://blog.linux.org.tw/~jserv/archives/001936.html">Jamei RTOS</a>] 的精簡版本，以 Revised BSD license 釋出，原始程式碼在此：[<a href="http://jserv.sayya.org/kernel/curt-src-v1.tar.bz2">curt-src-v1.tar.bz2</a>]。<br />
<br />
感謝 [<a href="http://walkingice.twbbs.org/blog/">WalkingIce</a>] 為 CuRT 貢獻了美麗大方的 logo：<br />
<center><img src="http://jserv.sayya.org/kernel/curt.png" width="167" height="109" /></center><br />
依據他的說法是：「因為短短的程式碼給了我很『輕』的感覺，所以在背景加上了一根羽毛」。以下是 CuRT 的特徵：<ul>
  <li>Preemptive Multi-threading</li>
  <li>Priority-base Round-Robin Scheduling</li>
  <li>Simple Threading</li>
  <li>Semaphore Support</li>
  <li>IPC: mailbox, message queue</li>
</ul>
支援 ARM 的硬體平台，編譯之後，作業系統加上範例程式碼僅有十幾 kb 的空間。同時，希望藉由這個具體而微的 RTOS，能否協助有心探索系統程式設計者理解 ARM
整個架構進而可掌握其精神，也是 CuRT 的設計背景。<br />
<br />
今年的規劃來看，會舉辦至少一場針對 ARM microarchitecture 為主題的的免費教育訓練，探討如何從零到有設計完整的作業系統、如何進行必要的系統初始化、如何動手理解 ARM 的種種關鍵設計，而 CuRT 就是其中的教材。請多指教，謝謝！<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/002082.html">03:41 PM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=2082" onclick="OpenComments(this.href); return false">迴響 (19)</a>
	
	
</div>

</div>


</div>
</div>

<!-- Site Meter -->
<script type="text/javascript" src="http://s23.sitemeter.com/js/counter.js?site=s23jserv">
</script>
<noscript>
<a href="http://s23.sitemeter.com/stats.asp?site=s23jserv" target="_top">
<img src="http://s23.sitemeter.com/meter.asp?site=s23jserv" alt="Site Meter" border="0"/></a>
</noscript>

</body>
</html>
