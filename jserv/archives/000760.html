<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script type="text/javascript" src="http://blog.linux.org.tw/~jserv/mt-site.js"></script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Jserv's blog: 新年新希望</title>

<link rel="stylesheet" href="http://blog.linux.org.tw/~jserv/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.linux.org.tw/~jserv/index.rdf" />

<link rel="start" href="http://blog.linux.org.tw/~jserv/" title="Home" />
<link rel="prev" href="http://blog.linux.org.tw/~jserv/archives/000630.html" title="2004 年摩托學園/Debian User 第一次聚會" />

<link rel="next" href="http://blog.linux.org.tw/~jserv/archives/000764.html" title="親愛的，我把 KDE 塞進 DirectFB 裡頭了" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'blog.linux.org.tw';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>





</head>

<body>

<div id="banner">
<h1><a href="http://blog.linux.org.tw/~jserv/" accesskey="1">Jserv's blog</a></h1>
<span class="description"></span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://blog.linux.org.tw/~jserv/archives/000630.html">« 2004 年摩托學園/Debian User 第一次聚會</a> |

<a href="http://blog.linux.org.tw/~jserv/">回到主頁面</a>
| <a href="http://blog.linux.org.tw/~jserv/archives/000764.html">親愛的，我把 KDE 塞進 DirectFB 裡頭了 »</a>

</div>

</div>


<div class="blog">

<h2 class="date">January 14, 2005</h2>

<div class="blogbody">

<h3 class="title">新年新希望</h3>

距離上一篇 blog，已經距離好一段時日了，有很多值得紀錄的項目，不過某些不愉快的經驗就跟著 2004 年的結束，一起消失，把握當下，作前瞻的思維吧。<br />
<br />
發現使用者的 feedback 越來越多，新酷音也正式成立<a href="http://chewing.csie.net/">專案網頁</a>，活躍在 MacOS X 社群的 gugod 與 zonble 也協助開發，真是令人興奮的發展動態，不過正如 kanru 所說，現在有太多 TODO，而我卻沒有時間好好處理，接下來會有一段時間的空檔，kanru 與 BBNS 也快放寒假了，應該可以好好討論下一版 libchewing 的設計細節。<br />
<br />
因為工作需要，研究了 Embedded Linux 的 Graphics，挖掘到許多有趣的設計架構，也試著改善 VIA Unichrome 整合繪圖晶片的 FBDev driver 設計，並且也玩起許久未接觸的<a href="http://www.directfb.org/">DirectFB</a>。VIA 曾一度釋出許多 open source driver，但是從 2004 年中起，就趨向封閉，只提供 binary driver，還好有<a href="http://unichrome.sourceforge.net/">The Unichrome Project</a>提供許多寶貴的資料與實作項目，根據前輩提供的資訊，我也發現 VIA 官方 open source 的一些弊端，目前已經修正些許 bug，當然最終會依據 GPL 釋出。在此同時，順手整理分析 2.4 Kernel FBDev 與 fbcon 實作的心得，寫一份比較正式的文件好了。<br />
<br />
Graphics in Embedded System 實在是很有趣的主題，但是繁體中文的資料實在是有點稀少，應<a href="http://tnlug.linux.org.tw/">TnLUG</a>的 Lman 之邀，預定今年四月份會作一場拋磚引玉的經驗談，至於細節還未敲定，有興趣的朋友可以參考<a href="http://phorum.study-area.org/viewtopic.php?t=28421">討論項目</a>。說到這，我最近在進行一項實驗，主要是發現過去 Embedded Linux 開發的過程需要太多人力的介入，而 uClibc 的<a href="http://www.uclibc.org/dists/">uwoody</a>給我頗多啟示，這是 Erik Andersen (uClibc、Busybox，以及許多 toolchain 的維護人，同時也是 Debian Developer) 針對 x86 架構下將 Debian packages 以 uClibc 重新編譯的 self-contained  Debian-based distribution。<br />
<br />
我比較想做出目標 (主要是配合 [Graphics in Embedded System] 這個主題) 是<a href="http://www.geexbox.org/">GeeXBox</a>，這個僅 5Mb 的 LiveCD 相當有意思，裡頭包含 NFS client、Wireless-tools、linux-tv，以及 MPlayer 套件，也有一套<a href="http://www.geexbox.org/en/dev.html">開發工具集</a>，這個機制是取自<a href="http://www.linuxfromscratch.org/">Linux From Scratch</a>，並搭配 uClibc，整體的 code size 控制得相當好，也可以透過 configuration 來作不同程度的 customization，但是這類 "From Scratch" 的設計上來說，「優點就是缺點」，是不是可能預先編譯好特定的組態，以 udeb 包裝起來呢？uwoody 是個很好的出發點，其內附的 rootfs (Root File System) 甚至包含了 toolchain，可以透過 chroot 直接在上面開發，到了測試階段後，在慢慢精簡，並對 ext2 fs 作 resize 即可，相當方便。<br />
<br />
驗證這個想法的同時，避免這個實驗過於枯燥，所以我訂了以下目標：<ul>
<li>以 DirectFB 作為 Graphics Toolkit，並設計一個堪用的 Media Center Frontend</li>
<li>建構 uClibc 為基礎的 distribution，並與 uwoody 相容</li>
<li>針對特定硬體作最佳化</li>
<li>提供自動建構系統的設計，並著手開發便利的 Configuration tool</li></ul>
簡單來說，就是基於「小而美」理念的訴求，所以我稱為本實驗為 "KittenBox"。就第一點來說，我試著修改 DirectFB 與 XINE，設計一個稱為 MediaScape 的前端程式，簡稱為 mscape，目前的進度可以參考以下快照：<br />
<img src="http://jserv.sayya.org/kittenbox/screenshots/1.jpg" /><br />
<br />
<img src="http://jserv.sayya.org/kittenbox/screenshots/2.jpg" /><br />
已經可以透過鍵盤操作全部的媒體導覽、播放，以及電視影像的處理，未來會加入 lirc 的整合，這樣就可以透過遙控器來操作這個簡單的 Media Center，當然，最終也會依據 GPL/LGPL 的授權釋出。<br />
<br />
VIA 之前提供了一款 mini-ITX 的版子，稍微拼湊後就有 KittenBox 的雛形了，以下是該機器的系統資訊：<ul><pre class="code" style="margin: 6px;">
$ cat /proc/cpuinfo
processor       : 0
vendor_id       : CentaurHauls
cpu family      : 6
model           : 7
model name      : VIA Samuel 2
stepping        : 3
cpu MHz         : 601.369
cache size      : 64 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu de tsc msr cx8 mtrr pge mmx 3dnow
bogomips        : 1199.30
</pre></ul>
以及<ul><pre class="code" style="margin: 6px;">
$ lspci
0000:00:00.0 Host bridge: VIA Technologies, Inc. VT8623 [Apollo CLE266]
0000:00:01.0 PCI bridge: VIA Technologies, Inc. VT8633 [Apollo Pro266 AGP]
0000:00:0f.0 Ethernet controller: VIA Technologies, Inc. VT6105 [Rhine-III] (rev 8b)
0000:00:10.0 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 80)
0000:00:10.1 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 80)
0000:00:10.2 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 80)
0000:00:10.3 USB Controller: VIA Technologies, Inc. USB 2.0 (rev 82)
0000:00:11.0 ISA bridge: VIA Technologies, Inc. VT8235 ISA Bridge
0000:00:11.1 IDE interface: VIA Technologies, Inc. VT82C586A/B/VT82C686/A/B/VT823x/A/C PIPC Bus Master IDE (rev 06)
0000:00:11.5 Multimedia audio controller: VIA Technologies, Inc. VT8233/A/8235/8237 AC97 Audio Controller (rev 50)
0000:00:12.0 Ethernet controller: VIA Technologies, Inc. VT6102 [Rhine-II] (rev 74)
0000:01:00.0 VGA compatible controller: VIA Technologies, Inc. VT8623 [Apollo CLE266] integrated CastleRock graphics (rev 03)
</pre></ul>
所以之前作的 FBDev 與 DirectFB 的涉獵就派上用場了，稍微 tune 後，整體效能還算可以接受，儘管硬體加速的部分還有改進的空間，接下來的重點則是 memory footprint 與有限度的 Realtime 能力。<br />
<br />
喔，對了，之前以 <a href="http://www.gentoo.org.tw/">GOT</a> (Gentoo@Taiwan) 的為名，設計一個 Window Manager，就稱為 GotWM，順便當作實作<a href="http://standards.freedesktop.org/wm-spec/latest/">EWMH</a> (Extended Window Manager Hints) 規格的一個小練習，運作快照可以參考以下：<br />
<img src="http://jserv.sayya.org/wm/gotwm.png" /><br />
<br />
呼呼，一口氣寫了若干有趣的新計畫，希望在這新的一年可以有更好的突破 :-)<br />

<a name="more"></a>


<span class="posted">由 jserv 發表於 January 14, 2005 02:34 AM

<br /></span>

</div>


<div class="comments-head"><a name="comments"></a>迴響</div>





<!-- Site Meter -->
<script type="text/javascript" src="http://s23.sitemeter.com/js/counter.js?site=s23jserv">
</script>
<noscript>
<a href="http://s23.sitemeter.com/stats.asp?site=s23jserv" target="_top">
<img src="http://s23.sitemeter.com/meter.asp?site=s23jserv" alt="Site Meter" border="0"/></a>
</noscript>
</div>
</div>
</body>
</html>
