<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Jserv's blog: February 2007 彙整</title>

<link rel="stylesheet" href="http://blog.linux.org.tw/~jserv/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.linux.org.tw/~jserv/index.rdf" />
<link rel="start" href="http://blog.linux.org.tw/~jserv/" title="Home" />
<link rel="prev" href="http://blog.linux.org.tw/~jserv/archives/2007_01.html" title="January 2007" />

<link rel="next" href="http://blog.linux.org.tw/~jserv/archives/2007_03.html" title="March 2007" />


<script language="javascript" type="text/javascript">
function OpenComments (c) {
    window.open(c,
                    'comments',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}
</script>

</head>

<body>	

<div id="banner">
<h1><a href="http://blog.linux.org.tw/~jserv/" accesskey="1">Jserv's blog</a></h1>
<span class="description"></span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://blog.linux.org.tw/~jserv/archives/2007_01.html">« January 2007</a> |

<a href="http://blog.linux.org.tw/~jserv/">回到主頁面</a>
| <a href="http://blog.linux.org.tw/~jserv/archives/2007_03.html">March 2007 »</a>

</div>

</div>

<div class="blog">


<h2 class="date">February 26, 2007</h2>


<div class="blogbody">
<a name="001880"></a>
<h3 class="title">Google 圖書搜尋</h3>

在 [<a href="http://fcamel.twbbs.org/">fcamel</a>] 的個人板瞥見 Google 的 (新？) 服務：[<a href="http://books.google.com/">圖書搜尋</a>] (Book Search)，號稱要將世界的圖書掃描為數位典藏，現在已經有相當數量了。原本看到一貫簡潔的介面，只是搜尋 "capital"，看看能否找到馬克思的《資本論》，重溫中學時代的記憶，沒想到不僅找到，而且介面真的很棒，有種拾卷拜讀的舒適感。<br />
<br />
突然想到，不知道有生之年，能否將《資本論》德文原著唸完呢？現在還差好大一截。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001880.html">01:51 AM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1880" onclick="OpenComments(this.href); return false">迴響 (1)</a>
	
	
</div>

</div>



<h2 class="date">February 25, 2007</h2>


<div class="blogbody">
<a name="001879"></a>
<h3 class="title">堅持與信念</h3>

整理書櫃時，瞥見國中時代寫下的勉勵文字，翻拍如下：<br />
<center><img src="http://people.debian.org.tw/~jserv/encourage.jpg" /></center><br />
字跡有些潦草，而且筆記紙也有些泛黃，那些文字是：<ul class="code" style="margin: 6px;">
對於那些自信其能力，而不自介意於暫時成敗者，沒有所謂的失敗！<br />
對於懷著百折不撓，堅定信念者，沒有所謂的失敗！<br />
對於別人放手，仍堅持者，沒有所謂的失敗！<br />
對於別人後退，然往前衝者，沒有所謂的失敗！<br />
對於每次傾跌，立刻站起；每次墜地，立刻像皮球一樣跳得更高者，沒有所謂的失敗！<br />
<br />
鮮嫩豔麗的花朵，有凋落時；皎潔盈滿的明月，有殘缺時；溫暖和煦的太陽，有西下時。但，不要怕花朵不再豔麗；不要怕明月不再盈滿；不要怕太陽不再和煦 －－ 只要勤施雨露，明春，花朵會更豔麗；只要循軌運行，次日，明月會更盈滿；只要耐心等待，次季，太陽會更和煦；只要堅忍，有毅力、不計成敗，未來，成功會更圓滿。
</ul>
雖然很八股，不過現在的我就是需要這般信念與堅持，我想這是冥冥中給予的鼓勵吧，加油！<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001879.html">05:40 PM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1879" onclick="OpenComments(this.href); return false">迴響 (3)</a>
	
	
</div>

</div>





<div class="blogbody">
<a name="001878"></a>
<h3 class="title">一眼望穿的寂靜</h3>

* 警告：以下內容係真人真事，但行為偏激不可取 *<br />
<br />
無意間聽到一首 GiGi 的新作〈過於透明的寂靜〉，收錄於新專輯《給自己的情歌》，這幾周反覆聽著，雖然稱不上動人雋永，但卻持續鼓動內心的呼喊。歌詞如下：<br />
<pre class="code" style="margin: 6px;">
牆上的鐘
早就忘了移動
彷彿對著你的離去
無止盡的形容
慌張的風
將回憶上的絲絨
冒失的揭起

這一屋透明的寂靜
卻有你鮮豔的聲音
而你曾經愛我的表情
像眼淚風乾後傷心的痕跡

那本日記
沒有新的日期
空了一季原本應該
很甜蜜的語氣
我怎麼抹去
如果你只是透明地
停留在這裡

在風離開前從飄動的窗簾
還能聽見你的諾言
會愛我到永遠
無所謂難過只是
突然的懷念
我們快樂的從前
門外的藍天一樣的海岸線
景色沒變除了不見
我習慣的那張臉
而你說的永遠就讓我
當成永遠的紀念

這一屋透明的寂靜
卻有你鮮豔的聲音
這過於透明的寂靜
你過於鮮豔的聲音
而你曾經愛我的表情
像眼淚風乾後傷心的痕跡
痕跡
</pre>
兩年多就這樣逝去，見證那四年的故事。我用酒精與瘋狂的工作麻痺自己，試著讓自己遺忘。自 2005 年開始，分析自己的最低生活需求，持續將多餘的紅利捐出，發自內心作好事，也提供免費技術諮詢，雖然時間有限，幫一個算一個，另外就是力行環保運動... 這些都是避免自己在那些「痕跡」上打轉，或許「像眼淚風乾後傷心的痕跡」是無法拭去的，但總是有轉移焦點的方式。然而，因為持續工作造成的胸口疼痛成為常態；騎單車美名是響應環保，其實最大的效用是提醒自己該腳踏實地、慢慢耕耘。那段時光，既是痛苦，也是快樂，疲勞奔命很苦，但見到自己的「重生」，稍感欣慰。<br />
<br />
某一週，我的淑女車鍊帶嚴重碎裂，接著伺服器也意外無法開機，這讓我警醒：機械不免會彈性疲乏，更何況人呢？過去那樣作，真是我所要的嗎？不，只是讓我更空虛，無論是生理抑或是心理層面。慢慢回想起小貓在分手後，告訴的那句話：<br />
<ul class="code" style="margin: 6px;">
「在我心裡面，永遠都把你當成我最珍惜的人。不只是親人、不只是朋友、不只是曾經。那些一起度過的時光、一起嚐過的甜蜜，永遠都是無法取代的 ... 所以我不希望你太快忘記，那些為彼此努力的不平凡時光，因為我也不會忘記；但是你一定要追求自己的幸福，知道嗎？就算因為想念而悲傷的同時，也還是可以快樂的；就算為另一個人難過的同時，也還是可以給別人幸福的；所以不要一個人追悼悲傷，知道嗎？」
</ul>
厭倦作自虐的行為，也開始討厭起他人的恭維，無論是否出自真心，因為我只是為了不寂寞而工作。有時候想，我已經對這個社會做了一點事情，也強迫降低物慾，但我總是覺得虧欠社會、更覺自我的渺小？為何他人給予我的鼓勵，我竟然會認定是一種同情？為何我總是可以逼迫自己擺出招牌笑容呢？似乎，我陷入一個人追悼悲傷的深淵，那麼，既然要突破，我該如何追求自己的幸福？<br />
<br />
一年前開始，這個瀰漫生硬電腦科技的 blog，浮現了幾篇短文：<ul>
<li>[<a href="http://blog.linux.org.tw/~jserv/archives/001496.html">告別，不是遺忘</a>]</li>
<li>[<a href="http://blog.linux.org.tw/~jserv/archives/001507.html">我所見的愛情</a>]</li>
<li>[<a href="http://blog.linux.org.tw/~jserv/archives/001758.html">生活就像洋蔥</a>]</li>
<li>[<a href="http://blog.linux.org.tw/~jserv/archives/001770.html">輕舞</a>]</li>
</ul>
或許轉化內心的彭拜為文字時，有著無比的劇烈的情感變動，但這類的文章在落筆時，除了孤寂的文字，還剩下什麼呢？曾逼迫自己做出殘忍的遺忘，自以為懂得小貓說的話：<br />
<ul class="code" style="margin: 6px;">
我相信，雖然我們兩個都還不完全甘願從這段感情脫身，但不論是開始或結束，都讓我們能夠用全新的角度看世界，看到全然不同的東西；你不覺得這多少帶給我們一些美好的風景嗎？
</ul>
相當幸運，陸續認識幾位條件不錯、心地善良的女生，她們都對我相當好，不過面對幸福的追求，我都失敗了。原因很簡單，沾染著自卑與自憐心態的我，總認為要讓對方幸福，就是不傷害對方，特別是條件越好的女生，越有這種感覺。到最後，竟然覺得對話有如面試，只能說出一堆中性、引經據典，但缺乏感情的用詞，沒多久，我又將對方推開，或許，我的確沒資格企想什麼？每次跟新認識的女生約會前，我都用這句話說服自己，或許這有些助益，但往往在稍有親暱舉動時，那種難過且懊悔的感受就會襲上心頭，沒辦法，很自然就會想起昔日的風景，那一瞬間，我看不到新的、美好的風景... 對那些女生來說，相當不公平，而且病態，於是我又推卻了，一切是這樣的冷血，這是每個月捐出款項關懷社會、以行動響應環保、貢獻時間精力於自由軟體、大量閱讀人文與科技書籍者會做的事情嗎？很不幸，是的，我是何等虛偽？<br />
<br />
因為工作需求，設計的軟體程式總離不開 "sensitivity" 這詞，多少挑燈夜戰就耗在微調的處理，但我卻相當討厭這個詞，因為就好像看到自己一般，懦弱的一面，又想起 Purple 說的話：<ul class="code" style="margin: 6px;">
知道自己一直活在別人的記憶裡，壓力大概很大吧。<br />
命運已經分隔我們一如河的兩岸了...
</ul>
將心比心，不想讓昔日的戀人為我擔憂，所以我做了之前的嘗試，但結局竟淪落為高中生物實驗一般，好似解剖課結束、樓梯間附近散落的解剖殘渣，那樣令人怵目驚心。我的身上有個優勢，就是早在國小二年級，自尊心就被踐踏殆盡，我幾乎想不起來當時的教育內容，但我永遠記得垃圾場，那座我為了逃避師長同學的嘲笑、無助跳入的垃圾場，是的，我在那邊成長了，沒有自尊、缺乏人格的教育，是好是壞，我沒資格評論，總之，我徹底忽視旁人的看法。許多孤寂的夜晚，當我不閱讀也不研究哲學或電腦技術時，常擔憂自己已是 Mary Wollstonecraft Shelley 筆下的 Frankenstein，目中無人的奔走於街頭，人們唯恐避之不及，或許人們對我的評價還不差，但我隨時可能傷害到別人，可悲的是，病態的我卻渾然不知。<br />
<br />
於是我逃避，孤獨成為我的密友，且讓我獨自靜靜吧，江郎才盡的我，已經力不從心，無論是電腦程式、文學、藝術，或者是哲學辯證，這樣的我，還有什麼價值呢？無助地低首，擔憂被異化與消滅，只想到 Juan Jos och Mill ochs 的著作《這就是孤獨》，也只能攤在牆角，嘴旁低吟著西班牙文 "La soledad era esto"，好個孤獨啊。我學習書中主人翁，四十三歲的艾蓮娜，的舉動，開始寫日記，用文字尋找自己存在的意義，何妨也藉由別人的眼光來觀察自己的生活？過去我沒想過，但這或許是種轉機，正因自我探索有盲點在，旁觀者也許看得更清楚。當我如艾蓮娜學會面對孤獨時，也就是重獲新生之日就不遠了。或許來日，存在主義之父 Jean-Paul Sartre 脫口而出的一句話，將會是我短暫生命的最佳寫照：<ul class="code" style="margin: 6px;">
「我的一生不過是一場遊戲，有時過分講究，有時品味低劣，但的確是一場遊戲。」
</ul>
不過這要在我徹底學會與孤獨相處、知曉孤獨後，才得以灑脫地說出吧。在這之前，我仍以自己的節奏度過生命每分每刻，以自己微弱的聲音向世界呼喊，希望妳不再為我難過，Paulo Coelho 在《我坐在琵卓河畔，哭泣》一書提到：<ul class="code" style="margin: 6px;">
如果我們並未重生<br />
如果我們不能學會以兒時的純真與熱情看待生命<br />
那麼..活者並沒有什麼意義.....
</ul>
如今，我深刻體驗這點，杜斯妥也夫斯基也說：「獲得生命的訣竅不僅僅是活著，而在於，為了什麼而活」。我覺得好累，必須承認，這樣的生活實在不是我這等意志不堅定的懦夫可承受的。口口聲聲說要休假，任職的單位也給予極高的自由度，但我總是不安分，又回去工作，只為了追求些微的成就感，唯一的差異是，休假期間的收入對我來說是多餘的，所以我還給這個社會，就當作一種罪贖吧，雖然我根本不知，Frankenstein 如我，是否受到理睬。錢財是如此，那我對於愛情也是如此悲觀，每每歸還至起點。或許那些都是我有權利獲得的，但何以至此？記得有個女生曾問我關於「喜歡」與「愛」的問題，客觀來說，這種涉及主觀認知與文義落差的命題本身沒有太大意義，但我卻發現一個嚴重的新問題，是的，也就是 QBQ (The Question Behind The Question)，除了知識領域外，我根本很難「喜歡」或「愛」任何一人事物，何等可悲？<br />
<br />
過度壓抑自我的結果，對於「至愛」的感覺只能從荷馬史詩《Odyssey》片段中一窺端倪：
<pre class="code" style="margin: 6px;">
奧德修斯的心底激起更強烈的悲泣慾望，
抱著心愛的妻子，嗚咽抽泣著；她的心純潔良善。
落海的水手看見了陸地，
堅固的海船被海神的暴怒擊碎在汪洋，
狂風怒吼，海浪洶湧襲擊，
只有寥寥數人逃出幽暗的海域，
游向海岸，滿身鹹腥味，厚厚的汗漬，
在歷劫重生後，興奮地迎向灘岸。
在珀涅羅珀眼前，她的丈夫歸來正是這般狀況，
看著她的摯愛，雪白的雙臂攏抱著他的脖子，緊緊不放。
</pre>
此際，順著抖動的臉龐留下者，並非兩道淚痕，而潸然留下者，是未痊癒的情緒，好幾年前，不也有個女孩值得我這麼作嗎？如今徒留在口中化開的溫熱、鹹苦的滋味，急促的呼吸讓我逐漸無法得知其分野：被撕裂的記憶與真實的合理性交織，哭泣中混雜著悲傷與喜悅，記憶被激活，映射於泛紅的眼框中。讓我又想起小貓曾說：<ul class="code" style="margin: 6px;">
最擔心你的地方，就是你不重視自己的快樂和感受，需要身邊有親愛的人來點醒那些幸福感；太過重視結果，總是令人灰暗而遍體鱗傷。其實你是個很不平凡的人，可是有時候不平凡的堅持並不需要苦苦撐到最後... 只需要成為年少輕狂的趣事就好了不是嗎？人的力量很渺小，而改變世界是需要運氣的，退一步讓自己輕鬆點，就是讓運氣有機會左右你的未來，不也是一種有趣的賭搏？
</ul>
不再願意洞見心靈深處的跫音，一味賠上身邊的資產，進行愚昧不可為的計畫，往往只換得灰暗而遍體鱗傷的下場。過去那個小孩，跳入垃圾場後，默默忍受發臭的垃圾，那種溫熱黏人的感覺，至今仍可感受，為什麼我的人生、我的價值觀正因此改觀？無論如何，我告訴自己，絕對不能被人看不起，也不能被同情，只為了證明自己而活，後來我做了很多瘋狂的舉動，雖然大半是出自內心對成功的渴望，但多少也是為了旁人，假想哪些譏諷我這個低能兒的旁人，或許，時至今日已經很少人投以輕視眼光，那可能是他們厭倦了。與小貓交往的那段日子，部份消弭了那種自卑感，甚至以為找尋到一種穩定的方向，身處時代巨變的狂瀾，我願意與浩劫對峙，保護著愛人，但...<br />
<br />
頓時處於真空狀態的我，除了原有的自卑，另外就是自憐，也不知為何會如脫韁野馬般失去控制。從中學開始，就自我洗腦的我，除了洗去那段在垃圾場成長的記憶外，還偽造了快樂的童年，可笑的是，那些零散的真實記憶，一直到了前幾個月才慢慢拼湊起來。孤獨的時候，習慣性又自我洗腦，假裝有種幸福感，讓我得在面龐顯露快樂與感受，事實上，又是如何？作為百代之過客，此刻的心情莫如 Audrey Niffenegger 在《時空旅人之妻》裡描述的貼切：<br />
<pre class="code" style="margin: 6px;">
你將再一次愛上這陌生人，他曾經是你自己
將你的心交還給它本身，給這一生都愛著你的
陌生人，
為了另一個
你將他忽視，而他知你於心
</pre>
下筆至此，已經凌晨三點，外頭很寂靜，但內心卻起伏不定，亟欲掙脫七情六慾的枷鎖，卻只是更陷入泥淖罷了。曾經試過讓自己休息幾天、幾周，沒想到還是一樣疲倦，而且腦際仍圍繞在工作，我根本不需要那些額外的收入，其實現在的雇主對我已經很不錯了，但為何總有無止盡的外務呢？而且都是需要投入大量時間的工作項目。社會的弱勢團體總會給我很微妙的感覺，我很想幫助他們，但我卻無法正視，他們的際遇會讓我聯想起負面的成長歷程，潛意識甚至會有種「劃清界線」的念頭，以前我沒辦法很清楚表達這種感覺，但最近大量閱讀有關中國共產黨冤假錯案與文化大革命時期的批鬥史實資料，更讓我無地自容，是的，他們的確是我的同胞，但我甚至不敢握住他們的雙手... 也因此，往往我只能扔下鈔票，覺得很愧疚，難道面對弱勢的人們，我只能拿鈔票出來，卻沒有溫情，後者才是他們最需要的，換個角度來說，也是我希冀的。<br />
<br />
Purple 覺得這種現象是因為「Jserv 沒有真心想要帶給別人什麼的」，她說：<ul class="code" style="margin: 6px;">
但不是你的錯，因為別人也沒帶給你什麼~ 但別人不是「不給你」什麼，而是沒什麼好給你的。
</ul>
或許是，但我的確不理解人，甚至沒有真心過，這是多麼可笑之事，都快滿二十六歲，但總是陷入這種無知愚昧的迴圈？！是否我所作的一切，最後將徒然爾爾？欣賞柯裕棻的一句話，希望我能從中獲得啟發：<pre class="code" style="margin: 6px;">
「世界總是如此，事物的表象之下蘊藏了無限的細節，如果不仔細思索，
  那無限的意義就輕易錯過了，塵封著，表象只是起起伏伏的片刻而已。
  但是如果仔細看它，想它，那麼這所有的細節就如同神秘難解的夢境，
  在莫名其妙的時刻浮現，攫取我們的感覺。
  這時我們會驚訝，枝微末節的每一天，原來都像海洋那樣蘊藏深沉，
  那樣複雜。」
</pre>
無論是在工作，還是是生活 (其實我很難定義此詞彙) 上，我遇到很大的瓶頸，儘管我知道巴爾扎克的名言：「人類的全部才能無非是時間和耐心的混合物」，但我仍相當不安，時間與耐性對我來說，逐漸淡去消逝，又何德何能有什麼突破呢？就算有，會讓我快樂些嗎？上頭還有好大一塊烏雲。來日，這將歸化寂靜，一眼望穿，那是因為某個為情、為工作所苦者，早已作古，但那沒關係，宇宙繼起的生命會有更廣的格局。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001878.html">03:22 AM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1878" onclick="OpenComments(this.href); return false">迴響 (8)</a>
	
	
</div>

</div>



<h2 class="date">February 20, 2007</h2>


<div class="blogbody">
<a name="001877"></a>
<h3 class="title">OSDC.tw 2007 - RT nanokernel for Embedded Linux</h3>

雖然是舊聞，不過這裡還是提一下。去年在 [<a href="http://blog.linux.org.tw/~jserv/archives/001854.html">OSDC.tw 2007 Calls for Papers</a>] 提到 [<a href="http://osdc.tw/">OSDC - Open Source Developer Conference</a>] 2007 年的議程，日前已經公佈了，詳細請見 [<a href="http://osdc.tw/2007/02/post_7.html">議程公佈</a>]。因為今年許多講者已經在多個方向切入 Web 2.0，所以小弟就改以 Virtualization + Realtime + Embedded Linux 為主題，探討從系統整合與消費性電子產品需求出發的新設計，我的提案名稱為："RT Nanokernel for Embedded Linux"，以下為提案內容：<ul class="code" style="margin: 6px;">
在台灣，開發一個新的作業系統並非不切實際的工作，相反地，在銜接 Free / Open Source software 運動巨變的同時，其中很重要的理念就是最佳化、通用性，與客製化。Nanokernel / Hybrid-kernel 的提出，就是針對應用需求，如行動裝置的進階能源管理機制等需大量軟硬體協同開發的技術項目，提供一種新途徑。<br />
<br />
眾多 Realtime Linux 系統的提出，證明可在符合特定需求的 Hard Realtime OS 上面運作修改過的 Linux Kernel，以兼具即時任務需求與既有 Linux 應用程式相容性。在資訊產業有句金言：「沒有完美的技術，只有合用的技術」，本議題以日漸成熟的 nanokernel / para-virtualization 等技術為基礎，提出輕量級且易於擴充的新設計，讓 Embedded Linux 發揮更大的威力。
</ul>
雖然這可能是很「硬」的主題，不過這是從消費性電子產品做出發，所以一方面是平衡議程與保持多元化，另一方面則是分享過去一年在這個領域的小小突破，這是 Realtime Linux 走出自動控制領域，而悄悄地整合進手機、PDA，甚至是數位電視系統，之前的 blog [<a href="http://blog.linux.org.tw/~jserv/archives/001344.html">幕後的英雄：談 Embedded Systems 設計</a>] 曾引用《The Invisible Computer》一書的說法，強調真正的電腦是極其複雜的，然而卻是無形的，也就是說嵌入式電腦無處不在，我想，未來我們將看到 Embedded/Realtime Linux 無所不在。<br />
<br />
議程第一日在 Apr 14 (六)，許多公司行號當天會挪用春節補班使用，所以請記得請假，當然啦，小弟的議程實在太冷門了，所以您也可以忽略小弟的議程、下午再來 :-)<br />
<br />
期待您的蒞臨指教，也希望這個新的 RT nanokernel for Embedded Linux 目前雖處於 prototype 階段，但仍可創造一些價值，最終的成果會以 GNU GPLv2 / LGPLv2 / BSD License 釋出，而任何合作的機會都是可能的，可與本實驗室聯繫，聯絡人：Jim Huang &lt;jserv.tw @ gmail.com&gt;。<br />
<br />
PS: 歡迎討論技術細節，但請勿在 OSDC.tw 議程中詢問關於產品規格或者定位方面的細節，謝謝！<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001877.html">10:01 AM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1877" onclick="OpenComments(this.href); return false">迴響 (0)</a>
	
	
</div>

</div>



<h2 class="date">February 12, 2007</h2>


<div class="blogbody">
<a name="001876"></a>
<h3 class="title">sizeof 在語言層面的陷阱</h3>

小弟與許多開發者一樣，在低階程式設計時使用 C 語言、開發應用程式時使用 C++ 或 C#，而這三種語言在某些關鍵字與運算子有雷同，但這也是造成潛在錯誤的原因。sizeof 就是 C / C++ / C# 等三種程式語言所共有的 operator (注意：不是 function)，顧名思義就是用以取得數值型別的位元組大小，大量用在 macro 定義中，比方說計算陣列 A 的元素個數，就可以這麼寫：<br />
<pre class="code" style="margin: 6px;">
#define getNumberInArray(a) \
	(sizeof(a) / sizeof(a[0]))
</pre>
這是相當常見的 C/C++ 技巧，但越是簡單的東西，越容易令人忽略細節，我們就來看看在不同語言層面中，sizeof 會有什麼差異。在 ANSI C 規格中，sizeof(char) 被嚴格定義為 1 個 size_t，所以考慮以下程式碼：<br />
<pre class="code" style="margin: 6px;"><span class="keyword">#include</span> &lt;stdio.h&gt;
<span class="keyword">int</span> main()                                                                                          
{
    printf(<span class="literal">"%d, %d\n"</span>, <span class="keyword">sizeof</span>(<span class="literal">'J'</span>), <span class="keyword">sizeof</span>(<span class="keyword">char</span>));
    <span class="keyword">return</span> 0;
}</pre>
輸出會是什麼呢？編譯並執行看看：<br />
<pre class="code" style="margin: 6px;">
$ gcc -o sizeof sizeof.c
$ ./sizeof 
4, 1
</pre>
第二項的輸出 "1" 乃是依據 ANSI C 規格，不過第一項就比較有意思，當我們用 C++ compiler 重新編譯並執行時：<br />
<pre class="code" style="margin: 6px;">
$ g++ -o sizeof sizeof.c
$ ./sizeof
1, 1
</pre>
所以同樣是 sizeof('J')，在 C 與 C++ 語言就有不同的表徵，C++ 設計的本意是與 ANSI C 相容，但實際上存在些微的差異，這裡就是一個好例子。我們可從以上輸出得知，C++ 中 sizeof('J') 等同於 sizeof(char)，所以我們看到輸出 "1"，但是對於 C 語言來說，有著 "default to int" 的語意，所以等同於計算 sizeof(int)，又在 32-bit 硬體架構來說，大致會輸出 "4"，而 C# 與 C++ 對此有類似的表現，不過還是得考慮 sizeof('x') 或 sizeof(L'x') 的不同行為 (多國語文的 multi-character)。<br />
<br />
再來作一個實驗：<br />
<pre class="code" style="margin: 6px;"><span class="keyword">#include</span> &lt;stdio.h&gt;
<span class="keyword">struct</span> Empty { } empty;
<span class="keyword">int</span> main()
{
        printf(<span class="literal">"sizeof(empty) = %d\n"</span>, <span class="keyword">sizeof</span>(empty));                                              
        <span class="keyword">return</span> 0;
}</pre>
先用 C compiler 編譯並執行：<br />
<pre class="code" style="margin: 6px;">
$ gcc -o sizeof sizeof2.c
$ ./sizeof 
sizeof(empty) = 0
</pre>
計算一個沒有內容的 struct，其 sizeof 為 "0"，似乎很合理，那麼 C++ 呢？<br />
<pre class="code" style="margin: 6px;">
$ g++ -o sizeof sizeof2.c
$ ./sizeof 
sizeof(empty) = 1
</pre>
奇怪，GNU G++ 竟然輸出 "1"，這是為什麼呢？依據 Standard C++ language definition 的說法：<ul class="code" style="margin: 6px;">
A class with an empty sequence of members and base class objects is an empty class. 
Complete objects and member subobjects of an empty class type shall have nonzero size.
</ul>
這也是說，沒有任何一個 complete object 可有 zero size，任何空的 structure 空間至少為 "1"，除非是 base class (pure virtual)，因為那不是 complete object。這個定義是有實際需求的，考慮以下程式碼：<pre class="code" style="margin: 6px;">
struct Bar { };
struct Foo {
    struct Bar a[2];
    struct Bar b;
};
Foo f;
</pre>
我們可以發現，在 f 這個 object 的 member：a 與 b，如果 sizeof(Bar) = 0，那麼 f.a[] 與 f.b 是否就有相同的 address 呢？為了避免歧異性，C++ 標準審議委員決定禁止 zero-sized addressable objects 的存在，所以基於 C++ 技術上考量，freestanding objects 必須有 non-zero size (非零大小)，這是 C 與 C++ 語言層面的差異之一。<br />
<br />
當然 sizeof 既然是個 operator，可作的變化可多了，比方說觀察 object value assign 的變化，不過這裡就不列舉了，因為 sizeof 大多出現於與低階 I/O 或記憶體操作有關之處，不然就是在 header file 中的 macro，這都是隨著專案需求，很可能一下子用 C compiler，而轉眼改用 C++ compiler 編譯的程式碼，但倘若我們忽視語言層面的差異，將會造成許多難以偵測的錯誤，筆者恰好在日前的專案遇過，於是稍加紀錄，慎之。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001876.html">04:02 PM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1876" onclick="OpenComments(this.href); return false">迴響 (7)</a>
	
	
</div>

</div>



<h2 class="date">February 10, 2007</h2>


<div class="blogbody">
<a name="001875"></a>
<h3 class="title">GPE Phone Edition</h3>

幾個月前，[<a href="http://www.openmoko.com/">openmoko</a>] 對世人投下一顆震撼彈，是的，Linux phone 不再只有 Linux Kernel 才能取得 source code，內部的軟體元件也終將可成為自由軟體，包含 AT command 介面甚至是 baseband，而之前的 blog [<a href="http://blog.linux.org.tw/~jserv/archives/001864.html">偉哉！Qtopia 4.2</a>] 也提到 Trolltech 的 Qtopia Phone 4.2 將大部分的軟體以 GPL 授權釋出，不過那還是缺乏自由軟體實做的 GSM stack。[<a href="http://gpephone.linuxtogo.org/">GPE Phone Edition</a>] 是本週發佈的新計畫，如其簡介 "GTK based solutions for mobile phones" 所暗示，以既有 [<a href="http://gpe.handhelds.org/">GPE: The GPE Palmtop Environment</a>] 的基礎，再行擴充與 GSM/GPRS 相關的元件，雖然完成度還有待加強，但可以說是目前完整 GSM phone 的自由軟體專案。<br />
<br />
從 [<a href="http://gpephone.linuxtogo.org/">GPE Phone Edition</a>] 的 [<a href="http://projects.linuxtogo.org/projects/gpephone">專案網頁</a>] 可看到許多開發者是來自中國大陸，他們是法國電信中國公司的開發人員，根據 [<a href="http://cavendishqi.blogspot.com/">Cavendish Qi</a>] 的說法，開發者之一的余義軍 (yijun yu)，曾是 Trolltech 北京辦事處的第一名技術人員，離開 Trolltech 後服務於法國電信，看來 [<a href="http://gpephone.linuxtogo.org/">GPE Phone Edition</a>] 是相當值得期待的計畫，目前相關的 source code 也已經上線，可透過 SVN 取得最新發展的程式碼，另外也可透過 VMware 來模擬系統，運作畫面如下：<br />
<center><img src="http://people.debian.org.tw/~jserv/GPEPhone.png" /></center><br />
現在 [<a href="http://www.openembedded.org/">OpenEmbedded</a>] 也正式支援 [<a href="http://gpephone.linuxtogo.org/">GPE Phone Edition</a>]，可參考 packages/gpephone 目錄，並且檔案 "gpe-session-scripts-phone/phonesession" 暗示了系統的設計也採用 X Window System 與 [<a href="http://projects.o-hand.com/matchbox/">Matchbox window manager</a>]，最近的 OLPC、Nokia 770，以及 OpenMoko 都採用類似的設計，關於 GSM/GPRS 的部份可參考 CMS92/gsmMux 與 phoneserver 的實做。<br />
<br />
個人認為，這些自由軟體的實做對於台灣產業的影響是相當正面的，快速且高品質的硬體生產能力一向是台灣廠商立足於全球市場的關鍵因素，但繁瑣的授權金與軟體授權卻常常左右成本，進而導致無法將定價降到更吸引客戶的可能性，隨便一個簡單的 VoIP phone，生產設計廠商就反覆被專利費用 (如 G.729 codec) 與軟體費用 (runtime royalty) 等因素被「剝皮」，未出貨時即要支付開發費用 (Non-Recurring Engineering fee)，而順利出貨更得要支付鉅額費用，這直接反映於產品標價，事實上，光是硬體是相當廉價的，我們可否透過自由軟體，創造廠商與消費者顧客雙贏的局面？值得思考。<br />



<div class="posted">
	由 jserv 發表於 <a href="http://blog.linux.org.tw/~jserv/archives/001875.html">04:30 AM</a>
		| <a href="http://mt.debian.org.tw/mt-yijian.cgi?entry_id=1875" onclick="OpenComments(this.href); return false">迴響 (1)</a>
	
	
</div>

</div>


</div>
</div>

<!-- Site Meter -->
<script type="text/javascript" src="http://s23.sitemeter.com/js/counter.js?site=s23jserv">
</script>
<noscript>
<a href="http://s23.sitemeter.com/stats.asp?site=s23jserv" target="_top">
<img src="http://s23.sitemeter.com/meter.asp?site=s23jserv" alt="Site Meter" border="0"/></a>
</noscript>

</body>
</html>
